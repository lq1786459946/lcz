<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å‰ç«¯å¤§å±è‡ªé€‚åº”æ–¹æ¡ˆ</title>
      <link href="//post/%E5%89%8D%E7%AB%AF%E5%A4%A7%E5%B1%8F%E8%87%AA%E9%80%82%E5%BA%94%E6%96%B9%E6%A1%88.html"/>
      <url>//post/%E5%89%8D%E7%AB%AF%E5%A4%A7%E5%B1%8F%E8%87%AA%E9%80%82%E5%BA%94%E6%96%B9%E6%A1%88.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ˜“ç”¨ğŸš€"><a href="#æ˜“ç”¨ğŸš€" class="headerlink" title="æ˜“ç”¨ğŸš€"></a>æ˜“ç”¨ğŸš€</h2><p>è°ƒç”¨ä»…éœ€ä¸€è¡Œä»£ç ï¼Œå³å¯é€‚é…è®¾ç½®åˆ†è¾¨ç‡ä»¥ä¸‹çš„æ‰€æœ‰å±å¹•ï¼Œæ— éœ€ä»»ä½•å…¶ä»–è¾…åŠ©</p><h2 id="æ€§èƒ½âš¡"><a href="#æ€§èƒ½âš¡" class="headerlink" title="æ€§èƒ½âš¡"></a>æ€§èƒ½âš¡</h2><p>åªå½±å“ä¸€ä¸ªå…ƒç´ æ ·å¼ï¼Œè®¡ç®—é‡æå°</p><h2 id="çµæ´»ğŸ’¥"><a href="#çµæ´»ğŸ’¥" class="headerlink" title="çµæ´»ğŸ’¥"></a>çµæ´»ğŸ’¥</h2><p>å¯ä»¥ç»™é¡¹ç›®å…¨å±€è‡ªé€‚åº”ï¼Œä¹Ÿå¯ä»¥å•ç‹¬é¡µé¢åšè‡ªé€‚åº”</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>å³åœ¨ scale ç­‰æ¯”ç¼©æ”¾çš„åŸºç¡€ä¸Šï¼Œè·å–å±å¹•çš„å®½åº¦é™¤ä»¥è®¾è®¡ç¨¿çš„å®½åº¦ï¼Œè·å–åˆ°å®½åº¦æ¯”ä¾‹å€¼ï¼›è·å–å±å¹•çš„é«˜åº¦é™¤ä»¥è®¾è®¡ç¨¿çš„é«˜åº¦ï¼Œè·å–åˆ°é«˜åº¦æ¯”ä¾‹å€¼ï¼›ä½¿ç”¨ transform: scale(x, x) åŠ¨æ€ç›‘å¬æ¥å®ç°é¡µé¢çš„ç¼©æ”¾æ¯”ä¾‹ï¼Œä»è€Œè¿˜åŸ UI å›¾æ•ˆæœã€‚è¿™å¯ä»¥æ”¯æŒè®¾è®¡ç¨¿ä»¥ä¸‹çš„å„ç§åˆ†è¾¨ç‡ã€‚</p><h2 id="ä½¿ç”¨ä»£ç "><a href="#ä½¿ç”¨ä»£ç " class="headerlink" title="ä½¿ç”¨ä»£ç "></a>ä½¿ç”¨ä»£ç </h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">* æ ¹æ®è§†å£å°ºå¯¸è°ƒæ•´ç»™å®šå…ƒç´ çš„ç¼©æ”¾æ¯”ä¾‹ã€‚</span><br><span class="line"> * @param &#123;<span class="title class_">HTMLElement</span>&#125; e - è¦è°ƒæ•´çš„å…ƒç´ ã€‚</span><br><span class="line"> * @param &#123;number&#125; planWidth - å…ƒç´ çš„è®¡åˆ’å®½åº¦,é»˜è®¤1980pxã€‚</span><br><span class="line"> * @param &#123;number&#125; planHeight - å…ƒç´ çš„è®¡åˆ’é«˜åº¦,é»˜è®¤1080pxã€‚</span><br><span class="line"> */</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">selfAdaption</span>(<span class="params">e, planWidth = <span class="number">1980</span>, planHeight = <span class="number">1080</span></span>) &#123;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * è·å–å®¢æˆ·ç«¯è§†å£çš„å½“å‰å°ºå¯¸ï¼Œå¹¶æ ¹æ®æœ€å°è®¡åˆ’å°ºå¯¸è¿›è¡Œè°ƒæ•´ã€‚</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@returns</span> &#123;<span class="type">&#123;width: number, height: number</span>&#125;&#125; å®¢æˆ·ç«¯è§†å£çš„è°ƒæ•´åå®½åº¦å’Œé«˜åº¦ã€‚</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(planWidth, planHeight);</span><br><span class="line">      <span class="keyword">const</span> <span class="title function_">getClientDimensions</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="comment">// è·å–å®¢æˆ·ç«¯è§†å£çš„å½“å‰å®½åº¦å’Œé«˜åº¦</span></span><br><span class="line">        <span class="keyword">let</span> width = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span> || <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientWidth</span>;</span><br><span class="line">        <span class="keyword">let</span> height = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientHeight</span> || <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span>;</span><br><span class="line">        <span class="comment">// å¦‚æœè®¡åˆ’é«˜åº¦å°äº1080ï¼Œåˆ™è¿›è¡Œé«˜åº¦è°ƒæ•´</span></span><br><span class="line">        <span class="keyword">if</span> (planHeight &lt; <span class="number">1080</span>) &#123;</span><br><span class="line">          height -= (<span class="number">1080</span> - planHeight);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœè®¡åˆ’å®½åº¦å°äº1920ï¼Œåˆ™è¿›è¡Œå®½åº¦è°ƒæ•´</span></span><br><span class="line">        <span class="keyword">if</span> (planWidth &lt; <span class="number">1920</span>) &#123;</span><br><span class="line">          width -= (<span class="number">1920</span> - planWidth);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123; width, height &#125;;</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * æ ¹æ®å½“å‰è§†å£å°ºå¯¸æ›´æ–°å…ƒç´ çš„ç¼©æ”¾æ¯”ä¾‹ã€‚</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="keyword">const</span> <span class="title function_">updateScale</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="comment">// è·å–è°ƒæ•´åçš„å®¢æˆ·ç«¯å°ºå¯¸</span></span><br><span class="line">        <span class="keyword">const</span> &#123; width, height &#125; = <span class="title function_">getClientDimensions</span>();</span><br><span class="line">        <span class="comment">// è®¡ç®—å®½åº¦å’Œé«˜åº¦çš„ç¼©æ”¾æ¯”ä¾‹</span></span><br><span class="line">        <span class="keyword">const</span> ratioWidth = width / planWidth;</span><br><span class="line">        <span class="keyword">const</span> ratioHeight = height / planHeight;</span><br><span class="line">        <span class="comment">// å¯¹å…ƒç´ åº”ç”¨ç¼©æ”¾å˜æ¢</span></span><br><span class="line">        e.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">`scale(<span class="subst">$&#123;ratioWidth&#125;</span>, <span class="subst">$&#123;ratioHeight&#125;</span>)`</span>;</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">// è®¾ç½®å…ƒç´ çš„åˆå§‹æ ·å¼</span></span><br><span class="line">      e.<span class="property">style</span>.<span class="property">cssText</span> += <span class="string">`</span></span><br><span class="line"><span class="string">    transform-origin: 0 0 0;</span></span><br><span class="line"><span class="string">    display: flex;</span></span><br><span class="line"><span class="string">    min-width: auto;</span></span><br><span class="line"><span class="string">    min-height: auto;</span></span><br><span class="line"><span class="string">    overflow: hidden;</span></span><br><span class="line"><span class="string">    width: <span class="subst">$&#123;planWidth&#125;</span>px;</span></span><br><span class="line"><span class="string">    height: <span class="subst">$&#123;planHeight&#125;</span>px;</span></span><br><span class="line"><span class="string">  `</span>;</span><br><span class="line">      <span class="comment">// åˆå§‹æ›´æ–°ç¼©æ”¾æ¯”ä¾‹</span></span><br><span class="line">      <span class="title function_">updateScale</span>();</span><br><span class="line">      <span class="comment">// æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼Œåœ¨çª—å£è°ƒæ•´å¤§å°æ—¶æ›´æ–°ç¼©æ”¾æ¯”ä¾‹</span></span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, updateScale);</span><br><span class="line">    &#125;</span><br><span class="line">selfAdaptionï¼ˆeï¼‰ä¼ é€’çš„è¦è‡ªé€‚åº”æœ€å¤–å±‚dom</span><br></pre></td></tr></table></figure><blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ä½¿ç”¨transform: scaleè‡ªé€‚åº”åï¼Œåœ°å›¾ä¸Šç‚¹å‡»äº‹ä»¶å¤±æ•ˆï¼Œè§£å†³åŠæ³•ï¼š</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">resetMapSize</span>(<span class="params"></span>) &#123;Â </span><br><span class="line">Â       <span class="keyword">let</span> mapContent = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;map&quot;</span>);Â </span><br><span class="line">Â       mapContent.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">`scale(<span class="subst">$&#123;<span class="number">1</span> / ratioWidth&#125;</span>,<span class="subst">$&#123;<span class="number">1</span> / ratioHeight&#125;</span>)`</span>Â </span><br><span class="line">Â     &#125;Â </span><br><span class="line">Â <span class="comment">// ç”¨å®Œåè®°å¾—é”€æ¯ç›‘å¬äº‹ä»¶ æ¯”å¦‚ vue ä¸­Â </span></span><br><span class="line">Â destroyed () &#123;Â </span><br><span class="line">Â     <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;resize&#x27;</span>,<span class="variable language_">this</span>.<span class="property">resetMapSize</span>)Â </span><br><span class="line">Â   &#125;Â </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> JS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue3.5 æºç è§£æï¼Œ useTemplateRef å®ç°åŸç†</title>
      <link href="//post/Vue3.5%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%EF%BC%8C%20useTemplateRef%20%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86.html"/>
      <url>//post/Vue3.5%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%EF%BC%8C%20useTemplateRef%20%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86.html</url>
      
        <content type="html"><![CDATA[<h2 id="useTemplateRef-çš„ä½œç”¨"><a href="#useTemplateRef-çš„ä½œç”¨" class="headerlink" title="useTemplateRef çš„ä½œç”¨"></a>useTemplateRef çš„ä½œç”¨</h2><p>useTemplateRef æ˜¯ç”¨æ¥ä¸“é—¨è·å– dom æˆ–è€… ç»„ä»¶ç¤ºä¾‹ çš„ã€‚</p><p>åœ¨ä¹‹å‰ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è·å– dom ï¼Œé‚£ä¹ˆéœ€è¦è¿™ä¹ˆåšï¼š</p><ol><li><p>å…ˆä¸º dom æŒ‡å®š ref å±æ€§ï¼Œå¹¶ä¸”ç»™å®šä¸€ä¸ª value å€¼</p></li><li><p>åœ¨ js ä¸­ï¼Œå£°æ˜ value å€¼çš„å˜é‡ï¼Œå¹¶ä¸”ç»™å®šåˆå§‹å€¼ä¸º ç©ºçš„ ref</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="comment">// é¦–å…ˆï¼Œæ‚¨å®šä¹‰äº†ä¸€ä¸ªå€¼ä¸ºundefinedæˆ–ç©ºçš„ref</span></span><br><span class="line"><span class="comment">// å¹¶ä»¥æ‚¨æƒ³è¦çš„æ–¹å¼å‘½åç”Ÿæˆçš„å¯ç”¨å†…å®¹</span></span><br><span class="line"><span class="keyword">const</span> divEl = <span class="title function_">ref</span>();</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- ç„¶åä½¿ç”¨ä¸â€œrefâ€å±æ€§çš„å€¼ç›¸åŒçš„åç§°,åœ¨æ¨¡æ¿ä¸­çš„æŸä¸ªåœ°æ–¹ --&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&quot;divEl&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œè¿™ç§æ–¹æ¡ˆå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯ï¼šref é€šå¸¸ç”¨æ¥å£°æ˜å“åº”å¼æ•°æ®ã€‚å½“ ref ä¸å…‰ä½œä¸ºå“åº”å¼å£°æ˜ï¼Œè¿˜è¢«ä½œä¸º dom å®ä¾‹çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±éš¾å…æœ‰ç‚¹è®©äººç–‘æƒ‘äº†ã€‚</p><p>æ‰€ä»¥åœ¨ï¼ˆ3.5 ä¹‹åï¼‰ Vue æ¨å‡ºäº†ä¸€ä¸ªæ–°çš„ API å«åš useTemplateRef æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&quot;el&quot;</span>&gt;</span>ç¨‹åºå‘˜Sunday<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; onMounted, useTemplateRef &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> elRef = <span class="title function_">useTemplateRef</span>(<span class="string">&#x27;el&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> <span class="variable language_">console</span>.<span class="title function_">log</span>(elRef.<span class="property">value</span>) <span class="comment">// dom ç¤ºä¾‹</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></li></ol><h2 id="useTemplateRef-çš„å®ç°åŸç†"><a href="#useTemplateRef-çš„å®ç°åŸç†" class="headerlink" title="useTemplateRef çš„å®ç°åŸç†"></a>useTemplateRef çš„å®ç°åŸç†</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useTemplateRef</span>(<span class="params">key: Keys</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> i = <span class="title function_">getCurrentInstance</span>();</span><br><span class="line">  <span class="keyword">const</span> r = <span class="title function_">shallowRef</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">if</span> (i) &#123;</span><br><span class="line">    <span class="keyword">const</span> refs = i.<span class="property">refs</span> === <span class="variable constant_">EMPTY_OBJ</span> ? (i.<span class="property">refs</span> = &#123;&#125;) : i.<span class="property">refs</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(refs, key, &#123;</span><br><span class="line">      <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">get</span>: <span class="function">() =&gt;</span> r.<span class="property">value</span>,</span><br><span class="line">      <span class="attr">set</span>: <span class="function">(<span class="params">val</span>) =&gt;</span> (r.<span class="property">value</span> = val),</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="ç¬¬ä¸€ä¸ª-iï¼šé€šè¿‡-getCurrentInstance-è·å–ï¼Œå¾—åˆ°çš„æ˜¯-ä¸Šä¸‹æ–‡å®ä¾‹ã€‚"><a href="#ç¬¬ä¸€ä¸ª-iï¼šé€šè¿‡-getCurrentInstance-è·å–ï¼Œå¾—åˆ°çš„æ˜¯-ä¸Šä¸‹æ–‡å®ä¾‹ã€‚" class="headerlink" title="ç¬¬ä¸€ä¸ª iï¼šé€šè¿‡ getCurrentInstance() è·å–ï¼Œå¾—åˆ°çš„æ˜¯ ä¸Šä¸‹æ–‡å®ä¾‹ã€‚"></a>ç¬¬ä¸€ä¸ª iï¼šé€šè¿‡ getCurrentInstance() è·å–ï¼Œå¾—åˆ°çš„æ˜¯ ä¸Šä¸‹æ–‡å®ä¾‹ã€‚</h5><p>â€‹ æ¥ä¸‹æ¥ï¼Œé€šè¿‡ i.refs è·å–åˆ°æ‰€æœ‰çš„ ref æ•°æ®ï¼Œç„¶åä¸º refs æ·»åŠ  Object.defineProperty çš„ç›‘å¬ï¼Œç›‘å¬çš„å±æ€§åå°±æ˜¯å…¥å‚ keyã€‚å¦‚æœä»¥ useTemplateRef(â€˜elâ€™) ä¸ºä¾‹ï¼Œé‚£ä¹ˆå°±æ˜¯ â€œelâ€ã€‚</p><p>é€šè¿‡ç›‘å¬å¯¹åº” key çš„ get å’Œ set æ ‡è®°ï¼Œè¿™é‡Œ é‡ç‚¹å…³æ³¨ set æ ‡è®°ï¼Œåœ¨è¿™é‡Œä¸º r.value è¿›è¡Œäº†èµ‹å€¼ï¼Œå³ï¼šr.value &#x3D; valã€‚è¿™é‡Œçš„ val å°±æ˜¯ refs[key] çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„ ref ç»„ä»¶å®ä¾‹ã€‚</p><h5 id="ç¬¬äºŒä¸ª-rï¼šé€šè¿‡-shallowRef-null-è·å–ï¼Œä½œä¸ºè¿”å›å€¼"><a href="#ç¬¬äºŒä¸ª-rï¼šé€šè¿‡-shallowRef-null-è·å–ï¼Œä½œä¸ºè¿”å›å€¼" class="headerlink" title="ç¬¬äºŒä¸ª rï¼šé€šè¿‡ shallowRef(null) è·å–ï¼Œä½œä¸ºè¿”å›å€¼"></a>ç¬¬äºŒä¸ª rï¼šé€šè¿‡ shallowRef(null) è·å–ï¼Œä½œä¸ºè¿”å›å€¼</h5><p>r ä½œä¸º useTemplateRef çš„è¿”å›å€¼å³ æœ€ç»ˆè·å–çš„ç»„ä»¶ç¤ºä¾‹ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Vue3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>refå’ŒreactiveåŸç†</title>
      <link href="//post/ref%E5%92%8Creactive%E5%8E%9F%E7%90%86.html"/>
      <url>//post/ref%E5%92%8Creactive%E5%8E%9F%E7%90%86.html</url>
      
        <content type="html"><![CDATA[<h2 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h2><p>ref çš„å¤„ç†ä¸Šå°±æ˜¯å…ˆå°†åŸºæœ¬ç±»å‹è½¬æ¢æˆå¯¹è±¡ç±»å‹ï¼Œç„¶ååœ¨é‡Œé¢åŠ å…¥ä¸€ä¸ª this._v_isRef çš„å¸ƒå°”ç±»å‹çš„å€¼ï¼Œæ¥åˆ¤æ–­å®ƒæ˜¯ä¸æ˜¯è¢« ref å¤„ç†äº†ï¼Œç„¶åå°†ä¸Šé¢å†™çš„ track å’Œ trigger å‡½æ•°å†™å…¥ get å’Œ set å‡½æ•°é‡Œé¢ï¼Œå¦‚æœä½ è¦å¤„ç†çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆ vue3 å°±ä¼šæŠŠå®ƒæ”¹æˆ reactive çš„å¤„ç†æ–¹å¼ã€‚æ‰€ä»¥è¯´ï¼Œref å¯ä»¥å¤„ç†åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹ï¼Œè€Œ reactive å¤„ç†çš„æ˜¯å¼•ç”¨ç±»å‹ï¼ŒäºŒè€…çš„åŒºåˆ«ä¸æ˜¯å¾ˆå¤§ã€‚</p><h2 id="reactive"><a href="#reactive" class="headerlink" title="reactive"></a>reactive</h2><ul><li><p>é¦–å…ˆæˆ‘ä»¬å–ä¸€ä¸ªå¯¹è±¡{a: 1}</p></li><li><p>ç„¶åè°ƒç”¨å°è£…å¥½çš„ reactive å‡½æ•° const state &#x3D; reactive({a: 1})</p></li><li><p>è¿™ä¸ªæ—¶å€™å°±ä¼šè¿›å…¥ä»£ç ç‰‡æ®µ 1.1 é‡Œé¢çš„ reactive å‡½æ•°ï¼Œåœ¨è¿›å…¥ createReactiveObject å‡½æ•°</p></li><li><p>ç„¶åå°±ä¼šå¯¹æˆ‘ä»¬è¦ä»£ç†çš„å¯¹è±¡è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ˜¯å¯¹è±¡çš„è¯å°±ç»§ç»­ä¸‹å»</p></li><li><p>åœ¨åˆ¤æ–­æˆ‘ä»¬æ˜¯ä¸æ˜¯å·²ç»ä»£ç†è¿‡è¿™ä¸ªå¯¹è±¡ï¼ˆå°±æ˜¯æˆ‘ä»¬é¢„å…ˆç©ºå‡ºä¸€ä¸ªä½ç½®ï¼Œå°†å·²ç»ä»£ç†è¿‡çš„å¯¹è±¡å…¨éƒ¨å­˜å‚¨ä¸‹æ¥ï¼‰ï¼Œä»£ç†è¿‡å°±è¿”å›ä»£ç†åçš„å€¼ï¼Œæ²¡æœ‰çš„è¯å°±åˆ›å»ºä¸€ä¸ªæ–°çš„ä»£ç†</p></li><li><p>å†ç„¶åç»‘å®šä¸Š proxy å‡½æ•°é‡Œé¢çš„ get å’Œ set å›è°ƒå‡½æ•°ï¼ˆå¯ä»¥çœ‹åˆ°ä»£ç  1.2ï¼‰</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Vue3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue3 Api</title>
      <link href="//post/vue3%20Api.html"/>
      <url>//post/vue3%20Api.html</url>
      
        <content type="html"><![CDATA[<p><strong>defineProps()å’Œ defineEmits()</strong></p><p>v-model:childValueModel ä¿®æ”¹äº†å€¼ æœ¬æ¥åº”è¯¥æ˜¯ modeValue</p><p>defineEmites() ä½¿ç”¨è¦æ·»åŠ  update:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;defineModelChild v-model;childValueModel=<span class="string">&quot;childValue&quot;</span>&gt;&lt;/defineModelChild&gt;</span><br></pre></td></tr></table></figure><p>â€‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; childValueModel &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myEmits(&#x27;update:childValueModel&#x27;, childValueModel + 1)&quot;</span>&gt;</span>æ•°æ® + 1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> myProps = <span class="title function_">defineProps</span>([<span class="string">&#x27;childValueModel&#x27;</span>]);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> myEmits= <span class="title function_">defineEmits</span>([<span class="string">&#x27;update:childValueModel&#x27;</span>]);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>çˆ¶ç»„ä»¶</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HelloWorld</span> <span class="keyword">from</span> <span class="string">&#x27;./components/defineProps-----defineEmits .vue&#x27;</span></span><br><span class="line"><span class="comment">//çˆ¶ç»„ä»¶</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">count</span>(<span class="params">value</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">HelloWorld</span> <span class="attr">a</span>=<span class="string">&quot;qwdqwd&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    @<span class="attr">count</span>=<span class="string">&#x27;count&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>å­ç»„ä»¶</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"><span class="comment">//å­ç»„ä»¶</span></span><br><span class="line"><span class="keyword">let</span> count = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">let</span> emit = <span class="title function_">defineEmits</span>([<span class="string">&quot;count&quot;</span>])</span><br><span class="line"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>((&#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="title class_">String</span></span><br><span class="line">&#125;))</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">  count.<span class="property">value</span>++</span><br><span class="line">  <span class="title function_">emit</span>(<span class="string">&quot;count&quot;</span>, count.<span class="property">value</span>)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;increment&quot;</span>&gt;</span>&#123;&#123; count &#125;&#125; &#123;&#123;props.a&#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>defineModel() 3.4+ç‰ˆæœ¬</strong></p><p>defineModel å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œæ˜¯å¯¹ v-model å†åŒ…è£…çš„è¯­æ³•ç³–</p><p>defineModel å¸®ä½ è·å–åˆ°äº† prop ä¸­çš„ modelValue ï¼Œä¸”å½“ å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨å¸®ä½ è°ƒç”¨ update:modelValue</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myProps = <span class="title function_">defineProps</span>([<span class="string">&quot;modelValue&quot;</span>]);</span><br><span class="line"><span class="keyword">const</span> myEmits = <span class="title function_">defineEmits</span>([<span class="string">&quot;update:modelValue&quot;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯´ç™½äº†ï¼Œè¿™é‡Œçš„ modelValue ç­‰ä»·äº props.modelValue + emit(&#x27;update:modelValue&#x27;)</span></span><br><span class="line"><span class="comment">// defineModel å¸®ä½  å°è£…äº† modelValue å’Œ update:modelValue</span></span><br><span class="line"><span class="keyword">const</span> modelValue = <span class="title function_">defineModel</span>();</span><br></pre></td></tr></table></figure><p><strong>çˆ¶ç»„ä»¶</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">defineModelChild</span> <span class="attr">v-model</span>=<span class="string">&quot;childValue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">defineModelChild</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> defineModelChild <span class="keyword">from</span> <span class="string">&#x27;./components/defineModelChild.vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> childValue = <span class="title function_">ref</span>(<span class="number">0</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>v-model å­ç»„ä»¶</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; modelValue &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myEmits(&#x27;update:modelValue&#x27;, modelValue + 1)&quot;</span>&gt;</span>æ•°æ® + 1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">defineProps</span>([<span class="string">&#x27;modelValue&#x27;</span>]);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> myEmits = <span class="title function_">defineEmits</span>([<span class="string">&#x27;update:modelValue&#x27;</span>]);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>defineModel() å­ç»„ä»¶</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; modelValue &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;modelValue++&quot;</span>&gt;</span>æ•°æ® + 1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> modelValue = <span class="title function_">defineModel</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>defineExpose å­ä¼ çˆ¶</strong></p><p>ï¼ˆç”¨åœ¨å­ç»„ä»¶ï¼Œæš´éœ²æƒ³ä¼ é€’çš„å€¼æˆ–æ–¹æ³•ï¼Œçˆ¶ç»„ä»¶é€šè¿‡ ref å±æ€§è·å–å­ç»„ä»¶æš´éœ²çš„ï¼‰</p><p>ä½¿ç”¨ script setup çš„ç»„ä»¶æ˜¯é»˜è®¤å…³é—­çš„â€”â€”å³é€šè¿‡æ¨¡æ¿å¼•ç”¨æˆ–è€… $parent é“¾è·å–åˆ°çš„ç»„ä»¶çš„å…¬å¼€å®ä¾‹ï¼Œä¸ä¼šæš´éœ²ä»»ä½•åœ¨ script setup ä¸­å£°æ˜çš„ç»‘å®šã€‚</p><p>é‚£ä¹ˆï¼Œé€šè¿‡ defineExpose ç¼–è¯‘å™¨å®æ¥æ˜¾å¼æŒ‡å®šåœ¨</p><p>ç„¶åï¼Œçˆ¶ç»„ä»¶é€šè¿‡ ref å±æ€§è®¿é—®å­ç»„ä»¶</p><p><strong>çˆ¶ç»„ä»¶ï¼š</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Index</span> ref=<span class="string">&quot;childeRef&quot;</span>&gt;&lt;/<span class="title class_">Index</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">import</span> <span class="title class_">Index</span> <span class="keyword">from</span> <span class="string">&quot;./index.vue&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> childeRef = <span class="title function_">ref</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">console</span>.<span class="title function_">log</span>(childeRef.<span class="property">value</span>.<span class="property">msg</span>) <span class="comment">// Hello World</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">let</span> <span class="attr">flag</span>:boolean = <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">let</span> <span class="attr">value</span>:number= <span class="number">5</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      childeRef.<span class="property">value</span>.<span class="title function_">childFn</span>(flag,value) <span class="comment">// è°ƒç”¨å­ç»„ä»¶å‡½æ•°, è¾“å‡º 6</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>å­ç»„ä»¶ï¼š</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">    <span class="keyword">import</span> &#123;ref&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">childFn</span>(<span class="params">typeï¼šboolean, dataï¼šnumber</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æˆ‘æ˜¯å­ç»„ä»¶&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(data)&#123;</span><br><span class="line">           <span class="keyword">let</span> value = data + <span class="number">1</span>;</span><br><span class="line">           <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> msg = <span class="string">&#x27;Hello World&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">defineExpose</span>(&#123; <span class="comment">//æš´éœ²æƒ³è¦ä¼ é€’çš„å€¼æˆ–æ–¹æ³•</span></span><br><span class="line">        msg,</span><br><span class="line">        childFn,</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><strong>defineOptions 3.3+</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; defineOptions &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="title function_">defineOptions</span>(&#123;</span><br><span class="line"><span class="attr">name</span>: <span class="string">&#x27;Foo&#x27;</span>,</span><br><span class="line"><span class="comment">//ç»„ä»¶é‡å‘½å</span></span><br><span class="line"> <span class="attr">inheritAttrs</span>: <span class="literal">false</span>,</span><br><span class="line"><span class="comment">//...æ›´å¤šè‡ªå®šä¹‰å±æ€§</span></span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><strong>computed è®¡ç®—å±æ€§</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup &gt;</span><br><span class="line"><span class="keyword">import</span> &#123; computed, reactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> author = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">books</span>: [</span><br><span class="line">    <span class="string">&#x27;Vue 2 - Advanced Guide&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Vue 3 - Basic Guide&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Vue 4 - The Mystery&#x27;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> publishedBooksMessage = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> author.<span class="property">books</span>.<span class="property">length</span> &gt; <span class="number">0</span> ? <span class="string">&#x27; Yes&#x27;</span> : <span class="string">&quot;No&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;&#123; publishedBooksMessage &#125;&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>  <span class="attr">scoped</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>computed ä¼ å‚</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup &gt;</span><br><span class="line"><span class="keyword">import</span> &#123; computed, reactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> author = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;John Doe&#x27;</span>,</span><br><span class="line">  <span class="attr">books</span>: [</span><br><span class="line">    <span class="string">&#x27;Vue 2 - Advanced Guide&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Vue 3 - Basic Guide&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Vue 4 - The Mystery&#x27;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> publishedBooksMessage = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(value)</span><br><span class="line">    <span class="keyword">return</span> author.<span class="property">books</span>.<span class="property">length</span> &gt; <span class="number">0</span> ? <span class="string">&#x27; Yes&#x27;</span> : <span class="string">&quot;No&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Has published books:<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;&#123; publishedBooksMessage(12) &#125;&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>  <span class="attr">scoped</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>watch ç›‘å¬</strong></p><p><strong>é»˜è®¤å¼€å¯æ·±åº¦ç›‘å¬</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup &gt;</span><br><span class="line"><span class="keyword">import</span> &#123; ref, watch &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">btnClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  count.<span class="property">value</span>++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// âœ… æ–¹æ³•ä¸€ï¼Œä¼ é€’å“åº”å¯¹è±¡</span></span><br><span class="line"><span class="title function_">watch</span>(count, <span class="function">(<span class="params">newValue, oldValue</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(newValue, oldValue)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// âŒ æ–¹æ³•äºŒï¼šä¼ é€’å“åº”å¯¹è±¡ä¸‹çš„å±æ€§</span></span><br><span class="line"><span class="title function_">watch</span>(user.<span class="property">name</span>, <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(value) <span class="comment">// ç›‘å¬å¤±è´¥ï¼Œæ²¡è¾“å‡º</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// âœ… æ–¹æ³•ä¸‰ï¼šä¼ é€’å‡½æ•°ï¼Œå‡½æ•°è¿”å›å“åº”å¯¹è±¡å±æ€§</span></span><br><span class="line"><span class="title function_">watch</span>(<span class="function">() =&gt;</span> user.<span class="property">name</span>, <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">// ç›‘å¬æˆåŠŸï¼Œè¾“å‡º jake</span></span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;btnClick&quot;</span>&gt;</span>ç‚¹å‡»<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;&#123; count &#125;&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>  <span class="attr">scoped</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>watchEffect çš„ä½¿ç”¨</strong></p><p>watchEffect ä¹Ÿæ˜¯ä¸€ä¸ªå¸§å¬å™¨ï¼Œæ˜¯ä¸€ä¸ªå‰¯ä½œç”¨å‡½æ•°ã€‚ å®ƒä¼šç›‘å¬å¼•ç”¨æ•°æ®ç±»å‹çš„æ‰€æœ‰å±æ€§ï¼Œä¸éœ€è¦å…·ä½“åˆ°æŸä¸ªå±æ€§ï¼Œä¸€æ—¦è¿è¡Œå°±ä¼šç«‹å³ç›‘å¬ï¼Œç»„ä»¶å¸è½½çš„æ—¶å€™ä¼šåœæ­¢ç›‘å¬ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup &gt;</span><br><span class="line"><span class="keyword">import</span> &#123; reactive, ref, watch, watchEffect &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> count = <span class="title function_">reactive</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;112&#x27;</span>, <span class="attr">data</span>: [<span class="string">&quot;ä½ å¥½&quot;</span>] &#125;)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">btnClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  count.<span class="property">data</span>[<span class="number">0</span>] = <span class="string">&#x27;è¢«æ”¹äº†&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(count.<span class="property">data</span>[<span class="number">0</span>]);</span><br><span class="line">&#125;)</span><br><span class="line"> <span class="title function_">watch</span>([count,obj],<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç›‘å¬çš„å¤šä¸ªæ•°æ®æ”¹å˜äº†&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;btnClick&quot;</span>&gt;</span>ç‚¹å‡»<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;&#123;count.data[0]&#125;&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>  <span class="attr">scoped</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>stopWatchEffect åœæ­¢ç›‘å¬</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> stop = <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;name:&quot;</span>, obj.<span class="property">name</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">stopWatchEffect</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;åœæ­¢ç›‘å¬&quot;</span>);</span><br><span class="line">  <span class="title function_">stop</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>onInvalidate å‡½æ•° è§£å†³æ‰§è¡Œé¡ºåºä¹±çš„é—®é¢˜</p>]]></content>
      
      
      
        <tags>
            
            <tag> Vue3 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
