---
title: 前端大屏自适应方案
date: 2024-09-12 10:58:20
tags: JS
categories: JS
---

## 易用 🚀

调用仅需一行代码，即可适配设置分辨率以下的所有屏幕，无需任何其他辅助

## 性能 ⚡

只影响一个元素样式，计算量极小

## 灵活 💥

可以给项目全局自适应，也可以单独页面做自适应

## 原理

即在 scale 等比缩放的基础上，获取屏幕的宽度除以设计稿的宽度，获取到宽度比例值；获取屏幕的高度除以设计稿的高度，获取到高度比例值；使用 transform: scale(x, x) 动态监听来实现页面的缩放比例，从而还原 UI 图效果。这可以支持设计稿以下的各种分辨率。

## 使用代码

```js
* 根据视口尺寸调整给定元素的缩放比例。
 * @param {HTMLElement} e - 要调整的元素。
 * @param {number} planWidth - 元素的计划宽度,默认1980px。
 * @param {number} planHeight - 元素的计划高度,默认1080px。
 */
    function selfAdaption(e, planWidth = 1980, planHeight = 1080) {
      /**
       * 获取客户端视口的当前尺寸，并根据最小计划尺寸进行调整。
       * @returns {{width: number, height: number}} 客户端视口的调整后宽度和高度。
       */
      console.log(planWidth, planHeight);
      const getClientDimensions = () => {
        // 获取客户端视口的当前宽度和高度
        let width = document.body.clientWidth || document.documentElement.clientWidth;
        let height = document.body.clientHeight || document.documentElement.clientHeight;
        // 如果计划高度小于1080，则进行高度调整
        if (planHeight < 1080) {
          height -= (1080 - planHeight);
        }
        // 如果计划宽度小于1920，则进行宽度调整
        if (planWidth < 1920) {
          width -= (1920 - planWidth);
        }
        return { width, height };
      };
      /**
       * 根据当前视口尺寸更新元素的缩放比例。
       */
      const updateScale = () => {
        // 获取调整后的客户端尺寸
        const { width, height } = getClientDimensions();
        // 计算宽度和高度的缩放比例
        const ratioWidth = width / planWidth;
        const ratioHeight = height / planHeight;
        // 对元素应用缩放变换
        e.style.transform = `scale(${ratioWidth}, ${ratioHeight})`;
      };
      // 设置元素的初始样式
      e.style.cssText += `
    transform-origin: 0 0 0;
    display: flex;
    min-width: auto;
    min-height: auto;
    overflow: hidden;
    width: ${planWidth}px;
    height: ${planHeight}px;
  `;
      // 初始更新缩放比例
      updateScale();
      // 添加事件监听器，在窗口调整大小时更新缩放比例
      window.addEventListener('resize', updateScale);
    }
selfAdaption（e）传递的要自适应最外层dom
```

> 使用 transform: scale 自适应后，地图上点击事件失效，解决办法：

```js
resetMapSize() { 
       let mapContent = document.getElementById("map"); 
       mapContent.style.transform = `scale(${1 / ratioWidth},${1 / ratioHeight})` 
     } 
 // 用完后记得销毁监听事件 比如 vue 中 
 destroyed () { 
     window.removeEventListener('resize',this.resetMapSize) 
   } 


```
