{"title":"Vue3.5 æºç è§£æï¼Œ useTemplateRef å®ç°åŸç†","uid":"32c8c23c6d89385feba3d0e7e602221c","slug":"Vue3.5 æºç è§£æï¼Œ useTemplateRef å®ç°åŸç†","date":"2024-09-06T06:07:04.000Z","updated":"2024-09-20T07:23:59.401Z","comments":true,"path":"api/articles/Vue3.5 æºç è§£æï¼Œ useTemplateRef å®ç°åŸç†.json","keywords":null,"cover":null,"content":"<h2 id=\"useTemplateRef-çš„ä½œç”¨\"><a href=\"#useTemplateRef-çš„ä½œç”¨\" class=\"headerlink\" title=\"useTemplateRef çš„ä½œç”¨\"></a>useTemplateRef çš„ä½œç”¨</h2><p>useTemplateRef æ˜¯ç”¨æ¥ä¸“é—¨è·å– dom æˆ–è€… ç»„ä»¶ç¤ºä¾‹ çš„ã€‚</p>\n<p>åœ¨ä¹‹å‰ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è·å– dom ï¼Œé‚£ä¹ˆéœ€è¦è¿™ä¹ˆåšï¼š</p>\n<ol>\n<li><p>å…ˆä¸º dom æŒ‡å®š ref å±æ€§ï¼Œå¹¶ä¸”ç»™å®šä¸€ä¸ª value å€¼</p>\n</li>\n<li><p>åœ¨ js ä¸­ï¼Œå£°æ˜ value å€¼çš„å˜é‡ï¼Œå¹¶ä¸”ç»™å®šåˆå§‹å€¼ä¸º ç©ºçš„ ref</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script setup&gt;</span><br><span class=\"line\"><span class=\"comment\">// é¦–å…ˆï¼Œæ‚¨å®šä¹‰äº†ä¸€ä¸ªå€¼ä¸ºundefinedæˆ–ç©ºçš„ref</span></span><br><span class=\"line\"><span class=\"comment\">// å¹¶ä»¥æ‚¨æƒ³è¦çš„æ–¹å¼å‘½åç”Ÿæˆçš„å¯ç”¨å†…å®¹</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> divEl = <span class=\"title function_\">ref</span>();</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">template</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"comment\">&lt;!-- ç„¶åä½¿ç”¨ä¸â€œrefâ€å±æ€§çš„å€¼ç›¸åŒçš„åç§°,åœ¨æ¨¡æ¿ä¸­çš„æŸä¸ªåœ°æ–¹ --&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;divEl&quot;</span> &gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;/<span class=\"name\">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n\n<p>ä½†æ˜¯ï¼Œè¿™ç§æ–¹æ¡ˆå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯ï¼šref é€šå¸¸ç”¨æ¥å£°æ˜å“åº”å¼æ•°æ®ã€‚å½“ ref ä¸å…‰ä½œä¸ºå“åº”å¼å£°æ˜ï¼Œè¿˜è¢«ä½œä¸º dom å®ä¾‹çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±éš¾å…æœ‰ç‚¹è®©äººç–‘æƒ‘äº†ã€‚</p>\n<p>æ‰€ä»¥åœ¨ï¼ˆ3.5 ä¹‹åï¼‰ Vue æ¨å‡ºäº†ä¸€ä¸ªæ–°çš„ API å«åš useTemplateRef æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\"> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;el&quot;</span>&gt;</span>ç¨‹åºå‘˜Sunday<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"> <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">setup</span>&gt;</span><span class=\"language-javascript\"></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\"><span class=\"keyword\">import</span> &#123; onMounted, useTemplateRef &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\"></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\"><span class=\"keyword\">const</span> elRef = <span class=\"title function_\">useTemplateRef</span>(<span class=\"string\">&#x27;el&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\"></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\"><span class=\"title function_\">onMounted</span>(<span class=\"function\">() =&gt;</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\"> <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(elRef.<span class=\"property\">value</span>) <span class=\"comment\">// dom ç¤ºä¾‹</span></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">&#125;)</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></li>\n</ol>\n<h2 id=\"useTemplateRef-çš„å®ç°åŸç†\"><a href=\"#useTemplateRef-çš„å®ç°åŸç†\" class=\"headerlink\" title=\"useTemplateRef çš„å®ç°åŸç†\"></a>useTemplateRef çš„å®ç°åŸç†</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">useTemplateRef</span>(<span class=\"params\">key: Keys</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> i = <span class=\"title function_\">getCurrentInstance</span>();</span><br><span class=\"line\">  <span class=\"keyword\">const</span> r = <span class=\"title function_\">shallowRef</span>(<span class=\"literal\">null</span>);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (i) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> refs = i.<span class=\"property\">refs</span> === <span class=\"variable constant_\">EMPTY_OBJ</span> ? (i.<span class=\"property\">refs</span> = &#123;&#125;) : i.<span class=\"property\">refs</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title class_\">Object</span>.<span class=\"title function_\">defineProperty</span>(refs, key, &#123;</span><br><span class=\"line\">      <span class=\"attr\">enumerable</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">      <span class=\"attr\">get</span>: <span class=\"function\">() =&gt;</span> r.<span class=\"property\">value</span>,</span><br><span class=\"line\">      <span class=\"attr\">set</span>: <span class=\"function\">(<span class=\"params\">val</span>) =&gt;</span> (r.<span class=\"property\">value</span> = val),</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"ç¬¬ä¸€ä¸ª-iï¼šé€šè¿‡-getCurrentInstance-è·å–ï¼Œå¾—åˆ°çš„æ˜¯-ä¸Šä¸‹æ–‡å®ä¾‹ã€‚\"><a href=\"#ç¬¬ä¸€ä¸ª-iï¼šé€šè¿‡-getCurrentInstance-è·å–ï¼Œå¾—åˆ°çš„æ˜¯-ä¸Šä¸‹æ–‡å®ä¾‹ã€‚\" class=\"headerlink\" title=\"ç¬¬ä¸€ä¸ª iï¼šé€šè¿‡ getCurrentInstance() è·å–ï¼Œå¾—åˆ°çš„æ˜¯ ä¸Šä¸‹æ–‡å®ä¾‹ã€‚\"></a>ç¬¬ä¸€ä¸ª iï¼šé€šè¿‡ getCurrentInstance() è·å–ï¼Œå¾—åˆ°çš„æ˜¯ ä¸Šä¸‹æ–‡å®ä¾‹ã€‚</h5><p>â€‹ æ¥ä¸‹æ¥ï¼Œé€šè¿‡ i.refs è·å–åˆ°æ‰€æœ‰çš„ ref æ•°æ®ï¼Œç„¶åä¸º refs æ·»åŠ  Object.defineProperty çš„ç›‘å¬ï¼Œç›‘å¬çš„å±æ€§åå°±æ˜¯å…¥å‚ keyã€‚å¦‚æœä»¥ useTemplateRef(â€˜elâ€™) ä¸ºä¾‹ï¼Œé‚£ä¹ˆå°±æ˜¯ â€œelâ€ã€‚</p>\n<p>é€šè¿‡ç›‘å¬å¯¹åº” key çš„ get å’Œ set æ ‡è®°ï¼Œè¿™é‡Œ é‡ç‚¹å…³æ³¨ set æ ‡è®°ï¼Œåœ¨è¿™é‡Œä¸º r.value è¿›è¡Œäº†èµ‹å€¼ï¼Œå³ï¼šr.value &#x3D; valã€‚è¿™é‡Œçš„ val å°±æ˜¯ refs[key] çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„ ref ç»„ä»¶å®ä¾‹ã€‚</p>\n<h5 id=\"ç¬¬äºŒä¸ª-rï¼šé€šè¿‡-shallowRef-null-è·å–ï¼Œä½œä¸ºè¿”å›å€¼\"><a href=\"#ç¬¬äºŒä¸ª-rï¼šé€šè¿‡-shallowRef-null-è·å–ï¼Œä½œä¸ºè¿”å›å€¼\" class=\"headerlink\" title=\"ç¬¬äºŒä¸ª rï¼šé€šè¿‡ shallowRef(null) è·å–ï¼Œä½œä¸ºè¿”å›å€¼\"></a>ç¬¬äºŒä¸ª rï¼šé€šè¿‡ shallowRef(null) è·å–ï¼Œä½œä¸ºè¿”å›å€¼</h5><p>r ä½œä¸º useTemplateRef çš„è¿”å›å€¼å³ æœ€ç»ˆè·å–çš„ç»„ä»¶ç¤ºä¾‹ã€‚</p>\n","text":"useTemplateRef çš„ä½œç”¨useTemplateRef æ˜¯ç”¨æ¥ä¸“é—¨è·å– dom æˆ–è€… ç»„ä»¶ç¤ºä¾‹ çš„ã€‚ åœ¨ä¹‹å‰ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è·å– dom ï¼Œé‚£ä¹ˆéœ€è¦è¿™ä¹ˆ...","permalink":"/post/Vue3.5 æºç è§£æï¼Œ useTemplateRef å®ç°åŸç†","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"Vue3","slug":"Vue3","count":7,"path":"api/categories/Vue3.json"}],"tags":[{"name":"Vue3","slug":"Vue3","count":7,"path":"api/tags/Vue3.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#useTemplateRef-%E7%9A%84%E4%BD%9C%E7%94%A8\"><span class=\"toc-text\">useTemplateRef çš„ä½œç”¨</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#useTemplateRef-%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86\"><span class=\"toc-text\">useTemplateRef çš„å®ç°åŸç†</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%80%E4%B8%AA-i%EF%BC%9A%E9%80%9A%E8%BF%87-getCurrentInstance-%E8%8E%B7%E5%8F%96%EF%BC%8C%E5%BE%97%E5%88%B0%E7%9A%84%E6%98%AF-%E4%B8%8A%E4%B8%8B%E6%96%87%E5%AE%9E%E4%BE%8B%E3%80%82\"><span class=\"toc-text\">ç¬¬ä¸€ä¸ª iï¼šé€šè¿‡ getCurrentInstance() è·å–ï¼Œå¾—åˆ°çš„æ˜¯ ä¸Šä¸‹æ–‡å®ä¾‹ã€‚</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%BA%8C%E4%B8%AA-r%EF%BC%9A%E9%80%9A%E8%BF%87-shallowRef-null-%E8%8E%B7%E5%8F%96%EF%BC%8C%E4%BD%9C%E4%B8%BA%E8%BF%94%E5%9B%9E%E5%80%BC\"><span class=\"toc-text\">ç¬¬äºŒä¸ª rï¼šé€šè¿‡ shallowRef(null) è·å–ï¼Œä½œä¸ºè¿”å›å€¼</span></a></li></ol></li></ol></li></ol></li></ol>","author":{"name":"æƒæ ˆ","slug":"blog-author","avatar":"https://p6-passport.byteacctimg.com/img/user-avatar/40c734cabc45915e93f17b88134aa761~140x140.awebp","link":"/","description":"æˆå°±ä¼Ÿå¤§çš„å”¯ä¸€é€”å¾„å°±æ˜¯çƒ­çˆ±ä½ æ‰€åšçš„äº‹æƒ…","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"å‰ç«¯å¤§å±è‡ªé€‚åº”æ–¹æ¡ˆ","uid":"d5edacab67506b18e45fcb0990be9618","slug":"å‰ç«¯å¤§å±è‡ªé€‚åº”æ–¹æ¡ˆ","date":"2024-09-12T02:58:20.000Z","updated":"2024-09-20T07:24:47.431Z","comments":true,"path":"api/articles/å‰ç«¯å¤§å±è‡ªé€‚åº”æ–¹æ¡ˆ.json","keywords":null,"cover":null,"text":"æ˜“ç”¨ ğŸš€è°ƒç”¨ä»…éœ€ä¸€è¡Œä»£ç ï¼Œå³å¯é€‚é…è®¾ç½®åˆ†è¾¨ç‡ä»¥ä¸‹çš„æ‰€æœ‰å±å¹•ï¼Œæ— éœ€ä»»ä½•å…¶ä»–è¾…åŠ© æ€§èƒ½ âš¡åªå½±å“ä¸€ä¸ªå…ƒç´ æ ·å¼ï¼Œè®¡ç®—é‡æå° çµæ´» ğŸ’¥å¯ä»¥ç»™é¡¹ç›®å…¨å±€è‡ªé€‚åº”ï¼Œä¹Ÿå¯ä»¥å•ç‹¬é¡µ...","permalink":"/post/å‰ç«¯å¤§å±è‡ªé€‚åº”æ–¹æ¡ˆ","photos":[],"count_time":{"symbolsCount":"2.5k","symbolsTime":"2 mins."},"categories":[{"name":"JS","slug":"JS","count":5,"path":"api/categories/JS.json"}],"tags":[{"name":"JS","slug":"JS","count":5,"path":"api/tags/JS.json"}],"author":{"name":"æƒæ ˆ","slug":"blog-author","avatar":"https://p6-passport.byteacctimg.com/img/user-avatar/40c734cabc45915e93f17b88134aa761~140x140.awebp","link":"/","description":"æˆå°±ä¼Ÿå¤§çš„å”¯ä¸€é€”å¾„å°±æ˜¯çƒ­çˆ±ä½ æ‰€åšçš„äº‹æƒ…","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"refå’ŒreactiveåŸç†","uid":"c34479c7fc43ef2eede71b250f18b4aa","slug":"refå’ŒreactiveåŸç†","date":"2024-08-27T08:30:20.000Z","updated":"2024-09-20T07:23:44.692Z","comments":true,"path":"api/articles/refå’ŒreactiveåŸç†.json","keywords":null,"cover":null,"text":"refref çš„å¤„ç†ä¸Šå°±æ˜¯å…ˆå°†åŸºæœ¬ç±»å‹è½¬æ¢æˆå¯¹è±¡ç±»å‹ï¼Œç„¶ååœ¨é‡Œé¢åŠ å…¥ä¸€ä¸ª this._v_isRef çš„å¸ƒå°”ç±»å‹çš„å€¼ï¼Œæ¥åˆ¤æ–­å®ƒæ˜¯ä¸æ˜¯è¢« ref å¤„ç†äº†ï¼Œç„¶åå°†ä¸Š...","permalink":"/post/refå’ŒreactiveåŸç†","photos":[],"count_time":{"symbolsCount":517,"symbolsTime":"1 mins."},"categories":[{"name":"Vue3","slug":"Vue3","count":7,"path":"api/categories/Vue3.json"}],"tags":[{"name":"Vue3","slug":"Vue3","count":7,"path":"api/tags/Vue3.json"}],"author":{"name":"æƒæ ˆ","slug":"blog-author","avatar":"https://p6-passport.byteacctimg.com/img/user-avatar/40c734cabc45915e93f17b88134aa761~140x140.awebp","link":"/","description":"æˆå°±ä¼Ÿå¤§çš„å”¯ä¸€é€”å¾„å°±æ˜¯çƒ­çˆ±ä½ æ‰€åšçš„äº‹æƒ…","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}