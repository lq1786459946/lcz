import{_ as ie,I as se,e as de,af as w,r as V,D as re,c as U,l as e,j as a,u as t,m as ue,F as D,a as x,b as z,d as T,s as r,z as R,q as c,t as d,G as me,L as ce,n as pe,M as fe,N as ve}from"./4Ktyr8G_.js";import{g as C,a as L}from"./C3lmZdGn.js";import{b as h}from"./DKz0NZsm.js";import{V as B}from"./BVo5q2wa.js";import{V as ge}from"./BhH3YVHS.js";import{V as N}from"./U2mkAfXu.js";import{V as O}from"./r4KKFxWL.js";import{V as I}from"./B8vluWYP.js";import{V as P}from"./er4xnGW9.js";import{V as Ve}from"./BuQiNUq5.js";import{V as be}from"./Cawm5IXN.js";import{V as he}from"./M4sPlSOX.js";import{V as ye,a as F}from"./Vc9XBB0d.js";import{V as j,a as m}from"./DlxhMtx2.js";import{V as p}from"./B01AR6UH.js";import{V as xe}from"./ZuLc9MOj.js";import"./By1GlJfL.js";import"./CryL740R.js";import"./BxUkLsYu.js";import"./DWGaNmQL.js";import"./BgxtWXOh.js";import"./BJWT1Lrs.js";import"./D-5uWIj4.js";import"./D9lrzzyk.js";import"./BrBayNQn.js";/* empty css        */const Ie=(v,_,y)=>C("/sciapi/api/invoice/page",{method:"post",params:{...y,current:v,size:_}}),Pe=()=>C("/sciapi/api/invoice/orderInfo/list",{method:"post"}),_e=v=>C("/sciapi/api/invoice/save",{method:"post",body:v}),E=v=>(fe("data-v-d9c351c2"),v=v(),ve(),v),ke={class:"d-flex gap-x-4"},Te={class:"d-flex flex-wrap justify-end gap-y-2 mt-2"},Re={key:1},Ne={class:"d-flex align-center justify-md-space-between"},Se={class:"d-flex align-center"},we={class:"font-weight-medium"},Ue=E(()=>r("span",{style:{color:"red",width:"0.9375rem",display:"inline-block"}},"* ",-1)),Ce={style:{"font-weight":"600"}},Ae={class:"d-flex align-center",style:{flex:"1"}},qe={style:{flex:"8"}},De={style:{flex:"16"}},ze={class:"font-weight-medium"},Le=E(()=>r("span",{style:{color:"red",width:"0.9375rem",display:"inline-block"}},"* ",-1)),Be={style:{"font-weight":"600"}},Oe={class:"d-flex align-center justify-md-space-between"},Fe={class:"d-flex align-center justify-md-space-between"},je={__name:"invoiceApplication",setup(v){const{$phonePrefix:_}=se(),{t:y}=de(),n=s=>y("invoiceApplication."+s),f=w(!1),S=w(!1),g=w(!1),u=V({total:0,currentPage:1,pageSize:10,options:[10,20,25,50,100]}),A=V([]),q=V([]),l=V({orderNo:"",amountTotal:"",titleType:null,invoiceType:null,content:"技术服务费",format:"PDF",title:"",taxId:"",address:"",phone:"",bankName:"",bankAccount:"",email:"",msgPhone:""}),$=V([{title:"订单号",key:"orderNo"},{title:"购买商品",key:"productName"},{title:"发票内容",key:"content"},{title:"发票抬头",key:"title"},{title:"发票金额",key:"amountTotal"},{title:"申请时间",key:"createTime"},{title:"发票状态",key:"status"},{title:"操作",key:"actions"}]),M=V([{title:"订单号",key:"orderNo"},{title:"付费金额",key:"amountTotal"},{title:"购买商品",key:"productName"},{title:"消费时间",key:"payTime"}]),H=V(!1),G=()=>{Pe().then(s=>{q.value=s.data,l.value.RegisteredPhonePrefix="+86",l.value.phonePrefix="+86",f.value=!f.value})},J=()=>{S.value=!0,pe(()=>{Ie(u.value.currentPage,u.value.pageSize,{}).then(s=>{A.value=s.data.records,u.value.total=s.data.total,S.value=!1})})},K=[s=>s?!0:n("HeaderTypeIsRequired")],Q=[s=>s?!0:n("InvoiceTypeIsRequired")],W=[s=>s?!0:n("InvoiceTitleIsRequired")],X=[s=>s?!0:n("TaxIDIsRequired")],Y=[s=>!!s||n("EmailIsRequired"),s=>/^[^\s@]+@[^\s@][^\s.@]*\.[^\s@]+$/.test(s)||n("PleaseEnterAValidEmailAddress")],Z=[s=>(h(),s?typeof l.value.phonePrefix=="string"?typeof h(l.value.phonePrefix,s)=="string"?y(h(l.value.phonePrefix,s)):!0:n("SelectCountryRegionCode"):n("PhoneIsRequired"))],ee=[s=>(h(),s?typeof l.value.RegisteredPhonePrefix=="string"?typeof h(l.value.RegisteredPhonePrefix,s)=="string"?y(h(l.value.RegisteredPhonePrefix,s)):!0:n("SelectCountryRegionCode"):!0)],te=()=>{g.value=!g.value},le=(s,{item:i})=>{g.value=!g.value,l.value.amountTotal=i.amountTotal,l.value.orderNo=i.orderNo},oe=async s=>{if((await s).valid){let b={phone:l.value.RegisteredPhonePrefix+" "+l.value.phone};l.value.msgPhone&&l.value.msgPhone!=""&&(b.msgPhone=l.value.phonePrefix+" "+l.value.msgPhone),_e({...l.value,...b}).then(o=>{o.code==200?(L("success",n("SubmissionSuccessful")),f.value=!f.value,l.value={}):L("success",n("SubmissionFailed"))})}},ae=s=>{let i=s.invoiceFiles;s.load||i&&i.length>=1&&(s.load=!0,$fetch(i[0].link).then(b=>{const o=URL.createObjectURL(b),k=document.createElement("a");k.href=o,k.download=i[0].originalName||"发票附件.pdf",k.click(),URL.revokeObjectURL(o),s.load=null}))},ne=()=>{f.value=!f.value};return(s,i)=>{const b=re("IconBtn");return x(),U(D,null,[e(B,null,{default:a(()=>[t(f)?T("",!0):(x(),z(N,{key:0,class:"d-flex flex-wrap gap-4"},{default:a(()=>[r("div",ke,[e(R,{color:"primary","prepend-icon":"ri-add-line",onClick:G},{default:a(()=>[c(d(n("RequestInvoice")),1)]),_:1})])]),_:1})),e(N,null,{default:a(()=>[t(f)?T("",!0):(x(),z(O,{key:0,"items-per-page":t(u).pageSize,"onUpdate:itemsPerPage":i[2]||(i[2]=o=>t(u).pageSize=o),page:t(u).currentPage,"onUpdate:page":i[3]||(i[3]=o=>t(u).currentPage=o),headers:t($),loading:t(S),items:t(A),"hide-default-footer":!1,"fixed-header":"","items-per-page-options":t(u).options,"items-length":t(u).total,"onUpdate:options":J},{"header.orderNo":a(()=>[c(d(n("OrderNumber")),1)]),"header.productName":a(()=>[c(d(n("PurchasedItems")),1)]),"header.content":a(()=>[c(d(n("InvoiceContent")),1)]),"header.title":a(()=>[c(d(n("InvoiceTitle")),1)]),"header.amountTotal":a(()=>[c(d(n("InvoiceAmount")),1)]),"header.createTime":a(()=>[c(d(n("ApplicationTime")),1)]),"header.status":a(()=>[c(d(n("InvoiceStatus")),1)]),"header.actions":a(()=>[c(d(n("Actions")),1)]),loading:a(()=>[e(be,{type:"table-row@10"})]),"item.amountTotal":a(({item:o})=>[c(d(o.amountCurrency==1?"CN¥":"US$")+" "+d(o.amountTotal),1)]),"item.status":a(({item:o})=>[r("div",null,d(o.status==1?n("InvoiceIssued"):n("ProcessingInvoice")),1)]),"item.actions":a(({item:o})=>[e(R,{variant:"text",loading:!!o.load,disabled:o.status!=1,onClick:k=>ae(o)},{default:a(()=>[c(d(n("DownloadInvoice")),1)]),_:2},1032,["loading","disabled","onClick"])]),bottom:a(()=>[e(I),e(N,{class:"pt-2"},{default:a(()=>[r("div",Te,[e(P,{modelValue:t(u).pageSize,"onUpdate:modelValue":i[0]||(i[0]=o=>t(u).pageSize=o),items:t(u).options,label:"",style:{"max-inline-size":"6rem","min-inline-size":"4rem","margin-right":"1rem"}},null,8,["modelValue","items"]),e(Ve,{modelValue:t(u).currentPage,"onUpdate:modelValue":i[1]||(i[1]=o=>t(u).currentPage=o),"total-visible":s.$vuetify.display.smAndDown?2:3,length:Math.ceil(t(u).total/t(u).pageSize)},null,8,["modelValue","total-visible","length"])])]),_:1})]),_:1},8,["items-per-page","page","headers","loading","items","items-per-page-options","items-length"])),t(f)?(x(),U("div",Re,[e(N,null,{default:a(()=>[e(he,{onSubmit:me(oe,["prevent"])},{default:a(()=>[r("div",Ne,[r("h2",null,d(n("OrderInformation")),1),e(b,{class:"align-self-end",onClick:ne},{default:a(()=>[e(ce,{size:20,icon:"ri-close-line"})]),_:1})]),e(I,{class:"mb-5 mt-3"}),e(ye,{class:"card-list mb-10"},{default:a(()=>[e(F,null,{default:a(()=>[r("div",Se,[r("span",we,[Ue,r("span",Ce,d(n("OrderNumber"))+" : ",1)]),r("div",Ae,[r("span",qe,d(t(l).orderNo||"-"),1),r("div",De,[e(R,{size:"small",onClick:te},{default:a(()=>[c(d(n("SelectOrder")),1)]),_:1})])])])]),_:1}),e(F,null,{default:a(()=>[r("span",ze,[Le,r("span",Be,d(n("OrderAmount"))+" : ",1)]),r("span",null,d(t(l).amountTotal||"-"),1)]),_:1})]),_:1}),e(j,null,{default:a(()=>[e(m,{md:"12",cols:"12"},{default:a(()=>[r("div",Oe,[r("h2",null,d(n("InvoiceInformation")),1)]),e(I,{class:"mt-3"})]),_:1}),e(m,{md:"6",cols:"12"},{default:a(()=>[e(P,{modelValue:t(l).titleType,"onUpdate:modelValue":i[4]||(i[4]=o=>t(l).titleType=o),label:n("HeaderType"),rules:K,counter:100,items:[{title:n("BusinessEntity"),value:"0"},{title:n("IndividualNonBusiness"),value:"1"}],clearable:"","clear-icon":"ri-close-line"},null,8,["modelValue","label","items"])]),_:1}),e(m,{md:"6",cols:"12"},{default:a(()=>[e(P,{modelValue:t(l).invoiceType,"onUpdate:modelValue":i[5]||(i[5]=o=>t(l).invoiceType=o),label:n("InvoiceType"),items:[{title:n("StandardInvoice"),value:"0"},{title:n("SpecializedInvoice"),value:"1"}],counter:100,rules:Q,clearable:"","clear-icon":"ri-close-line"},null,8,["modelValue","label","items"])]),_:1}),e(m,{md:"6",cols:"12"},{default:a(()=>[e(p,{modelValue:t(l).title,"onUpdate:modelValue":i[6]||(i[6]=o=>t(l).title=o),label:n("InvoiceTitle"),counter:20,rules:W,required:""},null,8,["modelValue","label"])]),_:1}),e(m,{md:"6",cols:"12"},{default:a(()=>[e(p,{modelValue:t(l).taxId,"onUpdate:modelValue":i[7]||(i[7]=o=>t(l).taxId=o),label:n("TaxID"),counter:20,rules:X,required:""},null,8,["modelValue","label"])]),_:1}),e(m,{md:"6",cols:"12"},{default:a(()=>[e(p,{modelValue:t(l).content,"onUpdate:modelValue":i[8]||(i[8]=o=>t(l).content=o),label:n("InvoiceContent"),disabled:"",counter:20,required:""},null,8,["modelValue","label"])]),_:1}),e(m,{md:"6",cols:"12"},{default:a(()=>[e(p,{modelValue:t(l).format,"onUpdate:modelValue":i[9]||(i[9]=o=>t(l).format=o),label:n("InvoiceFormat"),disabled:"",counter:20,required:""},null,8,["modelValue","label"])]),_:1}),t(l).titleType==0?(x(),U(D,{key:0},[e(m,{md:"12",cols:"12"},{default:a(()=>[e(xe,null,{default:a(()=>[c(d(n("MoreInfoOptional")),1)]),_:1})]),_:1}),e(m,{md:"6",cols:"12"},{default:a(()=>[e(p,{modelValue:t(l).address,"onUpdate:modelValue":i[10]||(i[10]=o=>t(l).address=o),label:n("RegisteredAddress"),counter:50},null,8,["modelValue","label"])]),_:1}),e(m,{md:"6",cols:"12"},{default:a(()=>[e(p,{modelValue:t(l).phone,"onUpdate:modelValue":i[12]||(i[12]=o=>t(l).phone=o),label:n("RegisteredPhone"),counter:20,rules:ee},{prepend:a(()=>[e(P,{modelValue:t(l).RegisteredPhonePrefix,"onUpdate:modelValue":i[11]||(i[11]=o=>t(l).RegisteredPhonePrefix=o),items:t(_)},null,8,["modelValue","items"])]),_:1},8,["modelValue","label"])]),_:1}),e(m,{md:"6",cols:"12"},{default:a(()=>[e(p,{modelValue:t(l).bankName,"onUpdate:modelValue":i[13]||(i[13]=o=>t(l).bankName=o),label:n("BankName"),counter:50},null,8,["modelValue","label"])]),_:1}),e(m,{md:"6",cols:"12"},{default:a(()=>[e(p,{modelValue:t(l).bankAccount,"onUpdate:modelValue":i[14]||(i[14]=o=>t(l).bankAccount=o),label:n("AccountNumber"),counter:20},null,8,["modelValue","label"])]),_:1})],64)):T("",!0),e(m,{md:"12",cols:"12"},{default:a(()=>[r("div",Fe,[r("h2",null,d(n("RecipientDetails")),1)]),e(I,{class:"mt-3"})]),_:1}),e(m,{md:"6",cols:"12"},{default:a(()=>[e(p,{modelValue:t(l).email,"onUpdate:modelValue":i[15]||(i[15]=o=>t(l).email=o),label:n("Email"),counter:50,rules:Y,required:""},null,8,["modelValue","label"])]),_:1}),e(m,{md:"6",cols:"12"},{default:a(()=>[e(p,{modelValue:t(l).msgPhone,"onUpdate:modelValue":i[17]||(i[17]=o=>t(l).msgPhone=o),label:n("SMSNotification"),counter:20,rules:Z,required:""},{prepend:a(()=>[e(P,{modelValue:t(l).phonePrefix,"onUpdate:modelValue":i[16]||(i[16]=o=>t(l).phonePrefix=o),items:t(_)},null,8,["modelValue","items"])]),_:1},8,["modelValue","label"])]),_:1})]),_:1}),e(I,{class:"mt-5 mb-4"}),e(j,{class:"d-flex justify-end"},{default:a(()=>[e(m,{md:"3",cols:"12"},{default:a(()=>[e(R,{class:"mt-2",disabled:!(t(l).amountTotal||t(l).orderNo),type:"submit",block:""},{default:a(()=>[c(d(n("Submit")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})])):T("",!0)]),_:1})]),_:1}),e(ge,{modelValue:t(g),"onUpdate:modelValue":i[18]||(i[18]=o=>ue(g)?g.value=o:null),"max-width":"600"},{default:a(()=>[e(B,{"prepend-icon":"mdi-account",title:n("SelectOrder")},{default:a(()=>[e(O,{density:"compact",height:"400",headers:t(M),loading:t(H),items:t(q),"hide-default-footer":"","onClick:row":le},null,8,["headers","loading","items"])]),_:1},8,["title"])]),_:1},8,["modelValue"])],64)}}},ft=ie(je,[["__scopeId","data-v-d9c351c2"]]);export{ft as default};
