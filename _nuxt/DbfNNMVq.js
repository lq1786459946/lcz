import{e as k,a9 as S,r as u,h as N,w as B,c as A,l as a,j as n,n as D,a as E,s as i,u as e,y as z,z as g,L as y,t as c,G as x,q as U}from"./4Ktyr8G_.js";import{g as $,a as T}from"./C3lmZdGn.js";import{c as C}from"./DKz0NZsm.js";import{a as q}from"./CAblgYOR.js";import{_ as G,g as L}from"./iRvYXIdc.js";import{V as O}from"./BVo5q2wa.js";import{V as H}from"./U2mkAfXu.js";import{V as J}from"./CryL740R.js";import{V as K}from"./M4sPlSOX.js";import{V as Q,a as d}from"./DlxhMtx2.js";import{V as f}from"./B01AR6UH.js";import"./By1GlJfL.js";import"./BbY-I90a.js";import"./-VStuZKb.js";import"./ZuLc9MOj.js";import"./DWGaNmQL.js";/* empty css        */const W=h=>$("/sciapi/api/member/updateMemberInfo",{method:"post",body:h}),X={class:"d-flex mb-10"},Y={class:"d-flex flex-column justify-center gap-4"},Z={class:"d-flex flex-wrap gap-4"},ee={class:"d-none d-sm-block"},le={class:"d-none d-sm-block"},ae={class:"text-body-1 mb-0"},_e={__name:"userInfo",setup(h){const{t:o}=k();S("userData"),u(!1);const b=u(),_=N(),{locale:M}=k({useScope:"global"});(()=>{D(()=>{L().then(s=>{V.value={...s.data},l.value={...s.data}})})})();let l=u({id:"",avatar:"",nick:"",region:null,identity:null,institution:null,major:null,professionalTitle:null});const p=u(""),v=()=>l.value.nick&&l.value.nick.length!=0?typeof C(l.value.nick)=="string"?(p.value=o(C(l.value.nick)),!1):(p.value=void 0,!0):(p.value=o("userInfo.NicknameRule"),!1);let V=u({});const w=()=>{l.value={...V.value}},I=u(),P=s=>{const{files:r}=s.target;!r||r.length===0||(r[0].size/1024/1024>2?T("warning",o("userInfo.FileTip"),"ri-error-warning-line"):q(s).then(t=>{l.value.avatar=t.data.link}),I.value.value="")},j=()=>{l.value.avatar=V.value.avatar},R=s=>{v(),v()&&W(l.value).then(r=>{T("primary",o("userInfo.OperationSuccessful")),V.value={...l.value};let{getMemberInfo:t}=b.value;t();let m={..._.getUserData};m.avatar=l.value.avatar,m.nick_name=l.value.nick,_.setUserInfo(m)},r=>{console.log(r,"error")})};let F=u();return B(M,()=>{v()}),(s,r)=>(E(),A("div",null,[a(G,{ref_key:"headerRef",ref:b,class:"mb-5"},null,512),a(O,{title:"用户信息"},{default:n(()=>[a(H,null,{default:n(()=>[i("div",X,[a(J,{rounded:"",size:"100",class:"me-6 mb-4",color:e(l)&&e(l).avatar?void 0:"primary",variant:e(l)&&e(l).avatar?void 0:"tonal"},{default:n(()=>[a(z,{src:e(l).avatar},null,8,["src"])]),_:1},8,["color","variant"]),i("form",Y,[i("div",Z,[a(g,{color:"primary",onClick:r[0]||(r[0]=t=>{var m;return(m=e(I))==null?void 0:m.click()})},{default:n(()=>[a(y,{icon:"ri-upload-cloud-line",class:"d-sm-none"}),i("span",ee,c(e(o)("userInfo.UpdatePhoto")),1)]),_:1}),i("input",{ref_key:"refInputEl",ref:I,type:"file",name:"file",accept:".png,.jpg",hidden:"",onInput:P},null,544),a(g,{type:"reset",color:"error",variant:"outlined",onClick:j},{default:n(()=>[i("span",le,c(e(o)("userInfo.Reset")),1),a(y,{icon:"ri-refresh-line",class:"d-sm-none"})]),_:1})]),i("p",ae,c(e(o)("userInfo.Tip")),1)])]),a(K,{onSubmit:x(R,["prevent"]),ref_key:"formRef",ref:F},{default:n(()=>[a(Q,null,{default:n(()=>[a(d,{cols:"12",md:"6"},{default:n(()=>[a(f,{counter:"",maxlength:"20",modelValue:e(l).nick,"onUpdate:modelValue":r[1]||(r[1]=t=>e(l).nick=t),"error-messages":e(p),onBlur:v,label:e(o)("userInfo.Nickname"),placeholder:e(o)("userInfo.NicknamePlaceholder")},null,8,["modelValue","error-messages","label","placeholder"])]),_:1}),a(d,{cols:"12",md:"6"},{default:n(()=>[a(f,{modelValue:e(l).region,"onUpdate:modelValue":r[2]||(r[2]=t=>e(l).region=t),counter:"",maxlength:"30",label:e(o)("userInfo.Country"),placeholder:e(o)("userInfo.CountryPlaceholder")},null,8,["modelValue","label","placeholder"])]),_:1}),a(d,{cols:"12",md:"6"},{default:n(()=>[a(f,{counter:"",maxlength:"30",modelValue:e(l).identity,"onUpdate:modelValue":r[3]||(r[3]=t=>e(l).identity=t),label:e(o)("userInfo.IdentityType"),placeholder:e(o)("userInfo.IdentityTypePlaceholder")},null,8,["modelValue","label","placeholder"])]),_:1}),a(d,{cols:"12",md:"6"},{default:n(()=>[a(f,{modelValue:e(l).institution,"onUpdate:modelValue":r[4]||(r[4]=t=>e(l).institution=t),counter:"",maxlength:"30",label:e(o)("userInfo.Unit"),placeholder:e(o)("userInfo.UnitPlaceholder")},null,8,["modelValue","label","placeholder"])]),_:1}),a(d,{cols:"12",md:"6"},{default:n(()=>[a(f,{modelValue:e(l).major,"onUpdate:modelValue":r[5]||(r[5]=t=>e(l).major=t),counter:"",maxlength:"30",label:e(o)("userInfo.Major"),placeholder:e(o)("userInfo.MajorPlaceholder")},null,8,["modelValue","label","placeholder"])]),_:1}),a(d,{cols:"12",md:"6"},{default:n(()=>[a(f,{counter:"",maxlength:"30",modelValue:e(l).professionalTitle,"onUpdate:modelValue":r[6]||(r[6]=t=>e(l).professionalTitle=t),label:e(o)("userInfo.ProfessionalTitle"),placeholder:e(o)("userInfo.ProfessionalPlaceholder")},null,8,["modelValue","label","placeholder"])]),_:1}),a(d,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:n(()=>[a(g,{type:"submit"},{default:n(()=>[U(c(e(o)("userInfo.Save")),1)]),_:1}),a(g,{color:"secondary",variant:"outlined",type:"reset",onClick:x(w,["prevent"])},{default:n(()=>[U(c(e(o)("userInfo.Reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]))}};export{_e as default};
