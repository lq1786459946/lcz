{"title":"Git提交规范 提交信息验证","uid":"0b4427dd59aaa64311629076103363d5","slug":"Git提交规范 提交信息验证","date":"2025-01-17T06:08:50.000Z","updated":"2025-01-17T06:12:15.798Z","comments":true,"path":"api/articles/Git提交规范 提交信息验证.json","keywords":null,"cover":[],"content":"<h2 id=\"背景介绍\"><a href=\"#背景介绍\" class=\"headerlink\" title=\"背景介绍\"></a>背景介绍</h2><p>项目中代码格式以及git message如果不加以约束，可能最终的格式会五花八门，这样很不利于项目维护，好的提交记录，会将每次提交内容的范围，内容，以及涉及到的 bug 都能清晰的展示出来，且格式一致，便于查找找提交记录，对查看代码提交记录或者审核的人更友好，能够更好地了解项目的生命周期以及中间出现的问题。</p>\n<h2 id=\"Commit-message-格式\"><a href=\"#Commit-message-格式\" class=\"headerlink\" title=\"Commit message 格式\"></a>Commit message 格式</h2><p>为了方便使用，我们避免了过于复杂的规定，格式较为简单且不限制中英文：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;type&gt;(&lt;scope&gt;)<span class=\"punctuation\">:</span> &lt;subject&gt;</span><br><span class=\"line\"><span class=\"comment\">// 注意冒号 : 后有空格</span></span><br><span class=\"line\"><span class=\"comment\">// 如 feat(miniprogram): 增加了小程序模板消息相关功能</span></span><br></pre></td></tr></table></figure>\n\n<p>scope选填表示commit的作用范围，如数据层、视图层，也可以是目录名称 subject必填用于对commit进行简短的描述 type必填表示提交类型，值有以下几种：</p>\n<ol>\n<li>feat - 新功能 feature</li>\n<li>fix - 修复 bug</li>\n<li>docs - 文档注释</li>\n<li>style - 代码格式(不影响代码运行的变动)</li>\n<li>refactor - 重构、优化(既不增加新功能，也不是修复bug)</li>\n<li>perf - 性能优化</li>\n<li>test - 增加测试</li>\n<li>chore - 构建过程或辅助工具的变动</li>\n<li>revert - 回退</li>\n<li>build - 打包</li>\n</ol>\n<h3 id=\"如何加入项目\"><a href=\"#如何加入项目\" class=\"headerlink\" title=\"如何加入项目\"></a>如何加入项目</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// commitlint</span></span><br><span class=\"line\"><span class=\"comment\">// 项目目录下安装</span></span><br><span class=\"line\">npm i commitlint --save-dev</span><br><span class=\"line\">npm i @commitlint/config-conventional --save-dev</span><br><span class=\"line\"><span class=\"comment\">// 在项目目录下，新建配置文件 commitlint.config.js， 内容如下</span></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">extends</span>: [<span class=\"string\">&#x27;@commitlint/config-conventional&#x27;</span>],</span><br><span class=\"line\">  <span class=\"attr\">rules</span>: &#123;</span><br><span class=\"line\">    <span class=\"comment\">// \btype 类型定义</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;type-enum&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;always&#x27;</span>, [</span><br><span class=\"line\">      <span class=\"string\">&quot;feat&quot;</span>, <span class=\"comment\">// 新功能 feature</span></span><br><span class=\"line\">      <span class=\"string\">&quot;fix&quot;</span>, <span class=\"comment\">// 修复 bug</span></span><br><span class=\"line\">      <span class=\"string\">&quot;docs&quot;</span>, <span class=\"comment\">// 文档注释</span></span><br><span class=\"line\">      <span class=\"string\">&quot;style&quot;</span>, <span class=\"comment\">// 代码格式(不影响代码运行的变动)</span></span><br><span class=\"line\">      <span class=\"string\">&quot;refactor&quot;</span>, <span class=\"comment\">// 重构(既不增加新功能，也不是修复bug)</span></span><br><span class=\"line\">      <span class=\"string\">&quot;perf&quot;</span>, <span class=\"comment\">// 性能优化</span></span><br><span class=\"line\">      <span class=\"string\">&quot;test&quot;</span>, <span class=\"comment\">// 增加测试</span></span><br><span class=\"line\">      <span class=\"string\">&quot;chore&quot;</span>, <span class=\"comment\">// 构建过程或辅助工具的变动</span></span><br><span class=\"line\">      <span class=\"string\">&quot;revert&quot;</span>, <span class=\"comment\">// 回退</span></span><br><span class=\"line\">      <span class=\"string\">&quot;build&quot;</span> <span class=\"comment\">// 打包</span></span><br><span class=\"line\">    ]],</span><br><span class=\"line\">    <span class=\"comment\">// subject 大小写不做校验</span></span><br><span class=\"line\">    <span class=\"comment\">// 自动部署的BUILD ROBOT的commit信息大写，以作区别</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;subject-case&#x27;</span>: [<span class=\"number\">0</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// husky</span></span><br><span class=\"line\"><span class=\"comment\">// 项目目录下安装</span></span><br><span class=\"line\">npm i husky --save-dev</span><br><span class=\"line\"><span class=\"comment\">// 在package.json文件中增加相关配置</span></span><br><span class=\"line\"><span class=\"string\">&quot;husky&quot;</span>: &#123;</span><br><span class=\"line\">  <span class=\"string\">&quot;hooks&quot;</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;commit-msg&quot;</span>: <span class=\"string\">&quot;commitlint -E HUSKY_GIT_PARAMS&quot;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// commitizen</span></span><br><span class=\"line\"><span class=\"comment\">// 全局安装</span></span><br><span class=\"line\">npm install commitizen -g</span><br><span class=\"line\"><span class=\"comment\">// 项目目录下安装</span></span><br><span class=\"line\">npm install commitizen --save-dev</span><br><span class=\"line\">commitizen init cz-customizable --save --save-exact</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 在package.json文件中增加相关配置</span></span><br><span class=\"line\"><span class=\"string\">&quot;config&quot;</span>: &#123;</span><br><span class=\"line\">  <span class=\"string\">&quot;commitizen&quot;</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;path&quot;</span>: <span class=\"string\">&quot;./node_modules/cz-customizable&quot;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 在项目目录下，新建配置文件 .cz-config.js</span></span><br><span class=\"line\"><span class=\"meta\">&#x27;use strict&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">types</span>: [</span><br><span class=\"line\">    &#123;<span class=\"attr\">value</span>: <span class=\"string\">&#x27;feat&#x27;</span>,     <span class=\"attr\">name</span>: <span class=\"string\">&#x27;feat:     新功能&#x27;</span>&#125;,</span><br><span class=\"line\">    &#123;<span class=\"attr\">value</span>: <span class=\"string\">&#x27;fix&#x27;</span>,      <span class=\"attr\">name</span>: <span class=\"string\">&#x27;fix:      修复&#x27;</span>&#125;,</span><br><span class=\"line\">    &#123;<span class=\"attr\">value</span>: <span class=\"string\">&#x27;docs&#x27;</span>,     <span class=\"attr\">name</span>: <span class=\"string\">&#x27;docs:     文档变更&#x27;</span>&#125;,</span><br><span class=\"line\">    &#123;<span class=\"attr\">value</span>: <span class=\"string\">&#x27;style&#x27;</span>,    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;style:    代码格式(不影响代码运行的变动)&#x27;</span>&#125;,</span><br><span class=\"line\">    &#123;<span class=\"attr\">value</span>: <span class=\"string\">&#x27;refactor&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;refactor: 重构(既不是增加feature，也不是修复bug)&#x27;</span>&#125;,</span><br><span class=\"line\">    &#123;<span class=\"attr\">value</span>: <span class=\"string\">&#x27;perf&#x27;</span>,     <span class=\"attr\">name</span>: <span class=\"string\">&#x27;perf:     性能优化&#x27;</span>&#125;,</span><br><span class=\"line\">    &#123;<span class=\"attr\">value</span>: <span class=\"string\">&#x27;test&#x27;</span>,     <span class=\"attr\">name</span>: <span class=\"string\">&#x27;test:     增加测试&#x27;</span>&#125;,</span><br><span class=\"line\">    &#123;<span class=\"attr\">value</span>: <span class=\"string\">&#x27;chore&#x27;</span>,    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;chore:    构建过程或辅助工具的变动&#x27;</span>&#125;,</span><br><span class=\"line\">    &#123;<span class=\"attr\">value</span>: <span class=\"string\">&#x27;revert&#x27;</span>,   <span class=\"attr\">name</span>: <span class=\"string\">&#x27;revert:   回退&#x27;</span>&#125;,</span><br><span class=\"line\">    &#123;<span class=\"attr\">value</span>: <span class=\"string\">&#x27;build&#x27;</span>,    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;build:    打包&#x27;</span>&#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"comment\">// override the messages, defaults are as follows</span></span><br><span class=\"line\">  <span class=\"attr\">messages</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">type</span>: <span class=\"string\">&#x27;请选择提交类型:&#x27;</span>,</span><br><span class=\"line\">    <span class=\"comment\">// scope: &#x27;请输入文件修改范围(可选):&#x27;,</span></span><br><span class=\"line\">    <span class=\"comment\">// used if allowCustomScopes is true</span></span><br><span class=\"line\">    <span class=\"attr\">customScope</span>: <span class=\"string\">&#x27;请输入修改范围(可选):&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">subject</span>: <span class=\"string\">&#x27;请简要描述提交(必填):&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">body</span>: <span class=\"string\">&#x27;请输入详细描述(可选，待优化去除，跳过即可):&#x27;</span>,</span><br><span class=\"line\">    <span class=\"comment\">// breaking: &#x27;List any BREAKING CHANGES (optional):\\n&#x27;,</span></span><br><span class=\"line\">    <span class=\"attr\">footer</span>: <span class=\"string\">&#x27;请输入要关闭的issue(待优化去除，跳过即可):&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">confirmCommit</span>: <span class=\"string\">&#x27;确认使用以上信息提交？(y/n/e/h)&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">allowCustomScopes</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"comment\">// allowBreakingChanges: [&#x27;feat&#x27;, &#x27;fix&#x27;],</span></span><br><span class=\"line\">  <span class=\"attr\">skipQuestions</span>: [<span class=\"string\">&#x27;body&#x27;</span>, <span class=\"string\">&#x27;footer&#x27;</span>],</span><br><span class=\"line\">  <span class=\"comment\">// limit subject length, commitlint默认是72</span></span><br><span class=\"line\">  <span class=\"attr\">subjectLimit</span>: <span class=\"number\">72</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"检测提交信息\"><a href=\"#检测提交信息\" class=\"headerlink\" title=\"检测提交信息\"></a>检测提交信息</h2><p>该流程用于校验提交信息的写入是否符合规则要求。</p>\n<p>安装依赖</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install ghooks  validate-commit-msg --save-dev</span><br></pre></td></tr></table></figure>\n\n<p>package.json配置</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">&quot;config&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;ghooks&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;commit-msg&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;validate-commit-msg&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"配置完成后其他人如何使用\"><a href=\"#配置完成后其他人如何使用\" class=\"headerlink\" title=\"配置完成后其他人如何使用\"></a>配置完成后其他人如何使用</h2><ol>\n<li>将配置测试完成的代码合并至主分支。</li>\n<li>其他开发者需要重新执行<code> npm i</code>安装相关依赖。</li>\n<li>需要全局安装<code> npm i commitizen -g</code></li>\n</ol>\n<h3 id=\"如何使用\"><a href=\"#如何使用\" class=\"headerlink\" title=\"如何使用\"></a>如何使用</h3><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add --all</span><br><span class=\"line\">git cz</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"效果\"><a href=\"#效果\" class=\"headerlink\" title=\"效果\"></a>效果</h3><p><img src=\"https://atlas.pingcode.com/files/public/67887292e5e4b9c9c6a650af?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWRfZm9yX3B1YmljX2ltYWdlIjoiNDAyMTgwNDVhZjkzNDg3NTgyMDI5ZjNlZDI2ZjQ3ZmEiLCJ0ZWFtX2Zvcl9wdWJsaWNfaW1hZ2UiOiI2MTZkMmU2MzJhNjgwNWE3NWY4MjAxOTEiLCJpc19pbnRlcm5hbF90b2tlbiI6dHJ1ZSwiaWF0IjoxNzM3MDkyMzE5LCJleHAiOjE3MzcxMDMxMTl9.8xPf7972RwwKZA59VQZf7dQH3OVg6WVH__l_F8V6Cqw\" alt=\"image.png\"></p>\n","feature":true,"text":"背景介绍项目中代码格式以及git message如果不加以约束，可能最终的格式会五花八门，这样很不利于项目维护，好的提交记录，会将每次提交内容的范围，内容，以及...","permalink":"/post/Git提交规范 提交信息验证","photos":[],"count_time":{"symbolsCount":"4k","symbolsTime":"4 mins."},"categories":[{"name":"其他","slug":"其他","count":2,"path":"api/categories/其他.json"}],"tags":[{"name":"其他","slug":"其他","count":2,"path":"api/tags/其他.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">背景介绍</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Commit-message-%E6%A0%BC%E5%BC%8F\"><span class=\"toc-text\">Commit message 格式</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%A6%82%E4%BD%95%E5%8A%A0%E5%85%A5%E9%A1%B9%E7%9B%AE\"><span class=\"toc-text\">如何加入项目</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%A3%80%E6%B5%8B%E6%8F%90%E4%BA%A4%E4%BF%A1%E6%81%AF\"><span class=\"toc-text\">检测提交信息</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE%E5%AE%8C%E6%88%90%E5%90%8E%E5%85%B6%E4%BB%96%E4%BA%BA%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">配置完成后其他人如何使用</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">如何使用</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%95%88%E6%9E%9C\"><span class=\"toc-text\">效果</span></a></li></ol></li></ol>","author":{"name":"权栈","slug":"blog-author","avatar":"https://p6-passport.byteacctimg.com/img/user-avatar/40c734cabc45915e93f17b88134aa761~140x140.awebp","link":"/","description":"成就伟大的唯一途径就是热爱你所做的事情","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{},"next_post":{"title":"前端项目协同开发统一代码格式化","uid":"bda55ba4f6f13ee1e9f8f3091a69e603","slug":"前端项目协同开发统一代码格式化","date":"2025-01-17T06:01:50.000Z","updated":"2025-01-17T06:07:31.330Z","comments":true,"path":"api/articles/前端项目协同开发统一代码格式化.json","keywords":null,"cover":[],"text":"问题背景现有业务项目中，开发人员使用的ide五花八门，既有Visual Studio Code、webstorm，也有idea、pycharm这种偏后端的ide...","permalink":"/post/前端项目协同开发统一代码格式化","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"其他","slug":"其他","count":2,"path":"api/categories/其他.json"}],"tags":[{"name":"其他","slug":"其他","count":2,"path":"api/tags/其他.json"}],"author":{"name":"权栈","slug":"blog-author","avatar":"https://p6-passport.byteacctimg.com/img/user-avatar/40c734cabc45915e93f17b88134aa761~140x140.awebp","link":"/","description":"成就伟大的唯一途径就是热爱你所做的事情","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}