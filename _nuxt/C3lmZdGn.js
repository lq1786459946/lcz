import{h as g,a9 as k,I as y}from"./4Ktyr8G_.js";import{u as C}from"./By1GlJfL.js";const _=(t="primary",s="操作成功！",n="ri-checkbox-circle-line")=>{const e=document.createElement("div");e.className=`v-alert v-theme--light bg-${t} v-alert--density-default v-alert--variant-flat`;const a=document.createElement("span");a.className="v-alert__underlay";const r=document.createElement("div");r.className="v-alert__prepend";const o=document.createElement("i");o.className=`${n} v-icon notranslate v-theme--light`,o.style="font-size: 18px;margin-right:5px",o.setAttribute("aria-hidden","true"),o.setAttribute("density","default"),r.appendChild(o);const l=document.createElement("div");l.className="v-alert__content",l.innerHTML=s,e.appendChild(a),e.appendChild(o),e.appendChild(l),document.body.appendChild(e);const p=e.offsetWidth,i=(window.innerWidth-p)/2;e.style.left=i+"px",setTimeout(()=>{document.body.removeChild(e)},2e3)},R=(t,s,n,e,a)=>d("/sciapi/sci/oauth/token",{method:"post",headers:{"Time-Zone":a},params:{email:t,password:s,phone:n,code:e,grant_type:"sci_web"}}),E=()=>{const t=g();return d("/sciapi/sci/oauth/token",{method:"post",params:{refresh_token:t.getRefreshToken,grant_type:"sci_web_refresh_token"}})},x=(t,s)=>d("/sciapi/sci/sendSmsValidate",{method:"post",params:{phone:t,codeType:s}}),N=(t,s)=>d("/sciapi/sci/sendEmailValidate",{method:"post",params:{email:t,codeType:s}}),P=(t,s,n,e,a)=>d("/sciapi/sci/register",{method:"post",params:{email:t,code:s,nick:n,password:e,confirmPassword:a}}),B=(t,s,n,e,a)=>d("/sciapi/sci/resetPassword",{method:"post",params:{email:t,phone:s,code:n,password:e,confirmPassword:a}}),S=(t,s,n)=>d("/sciapi/sci/bindAccount",{method:"post",params:{bindEmail:t,bindPhone:s,code:n}}),W=(t,s,n)=>d("/sciapi/sci/setPassword",{method:"post",params:{oldPassword:t,password:s,confirmPassword:n}}),u=(t,s)=>{y();const n=g();return C(t,{onRequest({options:e}){let a;a=n.getToken||k("token").value,e.headers={...e.headers,Authorization:"Basic c2FiZXI6c2FiZXJfc2VjcmV0","Blade-Requested-With":"BladeHttpRequest"},a&&(e.headers["Blade-Auth"]=`Bearer ${a}`)},onResponse({response:e}){},onResponseError({response:e}){},...s},"$enBxTtRs1P")};let m=!1,f=[];const d=(t,s)=>new Promise((n,e)=>{u(t,{method:"get",...s}).then(a=>{let r=a.data.value;if(r){let o=(r==null?void 0:r.code)||(r==null?void 0:r.error_code)||200,l=(r==null?void 0:r.error_description)||(r==null?void 0:r.msg);const p=g(),v=p.getLanguage;if(r&&o!==200){let i;try{i=JSON.parse(l)[v]||l}catch{i=l}o===400&&i=="请登录！"||i=="您的登录已过期，请重新登录！"?m?f.push(()=>{u(t,{method:"get",...s}).then(c=>{n(c.data.value)}).catch(c=>{e(c)})}):(m=!0,E().then(c=>{const b=c.access_token;p.setUserInfo(c);const w=k("token");w.value=b,f.forEach(h=>h()),f=[],m=!1,setTimeout(()=>{u(t,{method:"get",...s}).then(h=>{n(h.data.value)}).catch(h=>{e(h)})})})):i=="认证信息错误或无效"?(m=!1,_("error","您的登录已过期，请重新登录！","ri-error-warning-line"),p.logout()):(_("error",i,"ri-error-warning-line"),e(i))}else n(r)}}).catch(a=>{e(a)})});export{_ as a,N as b,x as c,R as d,S as e,P as f,d as g,B as r,W as s};
