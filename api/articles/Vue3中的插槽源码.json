{"title":"Vue3中的插槽源码","uid":"a7fb576f585a285d0be31f11b996bbe0","slug":"Vue3中的插槽源码","date":"2025-03-07T06:15:50.000Z","updated":"2025-03-07T06:19:53.950Z","comments":true,"path":"api/articles/Vue3中的插槽源码.json","keywords":null,"cover":null,"content":"<h2 id=\"dome\"><a href=\"#dome\" class=\"headerlink\" title=\"dome\"></a>dome</h2><p>我们先来看个常见的插槽demo，其中子组件代码如下：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">template</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">slot</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">slot</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">slot</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;header&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">slot</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">slot</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;footer&quot;</span> <span class=\"attr\">:desc</span>=<span class=\"string\">&quot;desc&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">slot</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">template</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">setup</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">import</span> &#123; ref &#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;vue&quot;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> desc = <span class=\"title function_\">ref</span>(<span class=\"string\">&quot;footer desc&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>在子组件中我们定义了三个插槽，第一个是默认插槽，第二个是name为<code>header</code>的插槽，第三个是name为<code>footer</code>的插槽，并且将<code>desc</code>变量传递给了父组件。</p>\n<p>我们再来看看父组件代码如下：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">template</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ChildDemo</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>default slot<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">template</span> <span class=\"attr\">v-slot:header</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>header slot<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">template</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">template</span> <span class=\"attr\">v-slot:footer</span>=<span class=\"string\">&quot;&#123; desc &#125;&quot;</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>footer slot: &#123;&#123; desc &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">template</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">ChildDemo</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">template</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">setup</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;ts&quot;</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">import</span> <span class=\"title class_\">ChildDemo</span> <span class=\"keyword\">from</span> <span class=\"string\">&quot;./child.vue&quot;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"来看看编译后的父组件\"><a href=\"#来看看编译后的父组件\" class=\"headerlink\" title=\"来看看编译后的父组件\"></a>来看看编译后的父组件</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123;</span><br><span class=\"line\">  createBlock <span class=\"keyword\">as</span> _createBlock,</span><br><span class=\"line\">  createElementVNode <span class=\"keyword\">as</span> _createElementVNode,</span><br><span class=\"line\">  openBlock <span class=\"keyword\">as</span> _openBlock,</span><br><span class=\"line\">  toDisplayString <span class=\"keyword\">as</span> _toDisplayString,</span><br><span class=\"line\">  withCtx <span class=\"keyword\">as</span> _withCtx,</span><br><span class=\"line\">&#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;/node_modules/.vite/deps/vue.js?v=64ab5d5e&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> _sfc_main = <span class=\"comment\">/* @__PURE__ */</span> <span class=\"title function_\">_defineComponent</span>(&#123;</span><br><span class=\"line\">  <span class=\"comment\">// ...省略</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">_sfc_render</span>(<span class=\"params\">_ctx, _cache, $props, $setup, $data, $options</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"title function_\">_openBlock</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">_createBlock</span>($setup[<span class=\"string\">&quot;ChildDemo&quot;</span>], <span class=\"literal\">null</span>, &#123;</span><br><span class=\"line\">      <span class=\"attr\">header</span>: <span class=\"title function_\">_withCtx</span>(</span><br><span class=\"line\">        <span class=\"function\">() =&gt;</span></span><br><span class=\"line\">          _cache[<span class=\"number\">0</span>] ||</span><br><span class=\"line\">          (_cache[<span class=\"number\">0</span>] = [</span><br><span class=\"line\">            <span class=\"title function_\">_createElementVNode</span>(</span><br><span class=\"line\">              <span class=\"string\">&quot;p&quot;</span>,</span><br><span class=\"line\">              <span class=\"literal\">null</span>,</span><br><span class=\"line\">              <span class=\"string\">&quot;header slot&quot;</span>,</span><br><span class=\"line\">              -<span class=\"number\">1</span></span><br><span class=\"line\">              <span class=\"comment\">/* HOISTED */</span></span><br><span class=\"line\">            ),</span><br><span class=\"line\">          ])</span><br><span class=\"line\">      ),</span><br><span class=\"line\">      <span class=\"attr\">footer</span>: <span class=\"title function_\">_withCtx</span>(<span class=\"function\">(<span class=\"params\">&#123; desc &#125;</span>) =&gt;</span> [</span><br><span class=\"line\">        <span class=\"title function_\">_createElementVNode</span>(</span><br><span class=\"line\">          <span class=\"string\">&quot;p&quot;</span>,</span><br><span class=\"line\">          <span class=\"literal\">null</span>,</span><br><span class=\"line\">          <span class=\"string\">&quot;footer slot: &quot;</span> + <span class=\"title function_\">_toDisplayString</span>(desc),</span><br><span class=\"line\">          <span class=\"number\">1</span></span><br><span class=\"line\">          <span class=\"comment\">/* TEXT */</span></span><br><span class=\"line\">        ),</span><br><span class=\"line\">      ]),</span><br><span class=\"line\">      <span class=\"attr\">default</span>: <span class=\"title function_\">_withCtx</span>(<span class=\"function\">() =&gt;</span> [</span><br><span class=\"line\">        _cache[<span class=\"number\">1</span>] ||</span><br><span class=\"line\">          (_cache[<span class=\"number\">1</span>] = <span class=\"title function_\">_createElementVNode</span>(</span><br><span class=\"line\">            <span class=\"string\">&quot;p&quot;</span>,</span><br><span class=\"line\">            <span class=\"literal\">null</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;default slot&quot;</span>,</span><br><span class=\"line\">            -<span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"comment\">/* HOISTED */</span></span><br><span class=\"line\">          )),</span><br><span class=\"line\">      ]),</span><br><span class=\"line\">      <span class=\"attr\">_</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">      <span class=\"comment\">/* STABLE */</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"comment\">/* @__PURE__ */</span> <span class=\"title function_\">_export_sfc</span>(_sfc_main, [</span><br><span class=\"line\">  [<span class=\"string\">&quot;render&quot;</span>, _sfc_render],</span><br><span class=\"line\">]);</span><br></pre></td></tr></table></figure>\n\n<p>在父组件中插槽经过编译后会变成一堆由插槽name组成的方法，执行这些方法就会生成插槽对应的虚拟DOM。默认插槽就是default方法，方法接收的参数就是子组件中插槽给父组件传递的变量</p>\n<h2 id=\"编译后的子组件\"><a href=\"#编译后的子组件\" class=\"headerlink\" title=\"编译后的子组件\"></a>编译后的子组件</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123;</span><br><span class=\"line\">  createElementBlock <span class=\"keyword\">as</span> _createElementBlock,</span><br><span class=\"line\">  <span class=\"title class_\">Fragment</span> <span class=\"keyword\">as</span> _Fragment,</span><br><span class=\"line\">  openBlock <span class=\"keyword\">as</span> _openBlock,</span><br><span class=\"line\">  renderSlot <span class=\"keyword\">as</span> _renderSlot,</span><br><span class=\"line\">&#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;/node_modules/.vite/deps/vue.js?v=64ab5d5e&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> _sfc_main = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// ...省略</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">_sfc_render</span>(<span class=\"params\">_ctx, _cache, $props, $setup, $data, $options</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"title function_\">_openBlock</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">_createElementBlock</span>(</span><br><span class=\"line\">      _Fragment,</span><br><span class=\"line\">      <span class=\"literal\">null</span>,</span><br><span class=\"line\">      [</span><br><span class=\"line\">        <span class=\"title function_\">_renderSlot</span>(_ctx.<span class=\"property\">$slots</span>, <span class=\"string\">&quot;default&quot;</span>),</span><br><span class=\"line\">        <span class=\"title function_\">_renderSlot</span>(_ctx.<span class=\"property\">$slots</span>, <span class=\"string\">&quot;header&quot;</span>),</span><br><span class=\"line\">        <span class=\"title function_\">_renderSlot</span>(_ctx.<span class=\"property\">$slots</span>, <span class=\"string\">&quot;footer&quot;</span>, &#123; <span class=\"attr\">desc</span>: $setup.<span class=\"property\">desc</span> &#125;),</span><br><span class=\"line\">      ],</span><br><span class=\"line\">      <span class=\"number\">64</span> <span class=\"comment\">/* STABLE_FRAGMENT */</span></span><br><span class=\"line\">    )</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"comment\">/*#__PURE__*/</span> <span class=\"title function_\">_export_sfc</span>(_sfc_main, [[<span class=\"string\">&quot;render&quot;</span>, _sfc_render]]);</span><br></pre></td></tr></table></figure>\n\n<p>子组件中的插槽实际就是在执行父组件插槽对应的方法，在执行方法时可以将子组件的变量传递给父组件，这就是作用域插槽的原理。</p>\n","feature":true,"text":"dome我们先来看个常见的插槽demo，其中子组件代码如下： 12345678910<template> <slot></slot> <slot name=\"h...","permalink":"/post/Vue3中的插槽源码","photos":[],"count_time":{"symbolsCount":"3.3k","symbolsTime":"3 mins."},"categories":[{"name":"Vue3","slug":"Vue3","count":8,"path":"api/categories/Vue3.json"}],"tags":[{"name":"Vue3","slug":"Vue3","count":8,"path":"api/tags/Vue3.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#dome\"><span class=\"toc-text\">dome</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9D%A5%E7%9C%8B%E7%9C%8B%E7%BC%96%E8%AF%91%E5%90%8E%E7%9A%84%E7%88%B6%E7%BB%84%E4%BB%B6\"><span class=\"toc-text\">来看看编译后的父组件</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%BC%96%E8%AF%91%E5%90%8E%E7%9A%84%E5%AD%90%E7%BB%84%E4%BB%B6\"><span class=\"toc-text\">编译后的子组件</span></a></li></ol>","author":{"name":"权栈","slug":"blog-author","avatar":"https://p6-passport.byteacctimg.com/img/user-avatar/40c734cabc45915e93f17b88134aa761~140x140.awebp","link":"/","description":"成就伟大的唯一途径就是热爱你所做的事情","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Three.js(一)","uid":"80efad7c695cc6b27c2c7b13bb948265","slug":"Three.js(一)","date":"2025-06-06T07:50:20.000Z","updated":"2025-06-06T07:09:02.892Z","comments":true,"path":"api/articles/Three.js(一).json","keywords":null,"cover":[],"text":"Three.js 三大要素场景（scene）、相机（camera）、渲染器（renderer） 相机获取到场景内显示的内容，然后再通过渲染器渲染到画布上面 1、...","permalink":"/post/Three.js(一)","photos":[],"count_time":{"symbolsCount":"3.1k","symbolsTime":"3 mins."},"categories":[{"name":"Three.js","slug":"Three-js","count":1,"path":"api/categories/Three-js.json"}],"tags":[{"name":"Three.js","slug":"Three-js","count":1,"path":"api/tags/Three-js.json"}],"author":{"name":"权栈","slug":"blog-author","avatar":"https://p6-passport.byteacctimg.com/img/user-avatar/40c734cabc45915e93f17b88134aa761~140x140.awebp","link":"/","description":"成就伟大的唯一途径就是热爱你所做的事情","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"monorepo架构 前端项目管理模式","uid":"23b6e0ae5d6dee99687505d16c2a98a4","slug":"monorepo架构 前端项目管理模式","date":"2025-03-07T06:06:50.000Z","updated":"2025-03-07T06:11:13.896Z","comments":true,"path":"api/articles/monorepo架构 前端项目管理模式.json","keywords":null,"cover":null,"text":"monorepo架构 前端项目管理模式项目管理模式在当下大型前端项目中基于 monorepo 的解决方案已经深入人心，无论是比如 Google、Facebook...","permalink":"/post/monorepo架构 前端项目管理模式","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"其他","slug":"其他","count":3,"path":"api/categories/其他.json"}],"tags":[{"name":"其他","slug":"其他","count":3,"path":"api/tags/其他.json"}],"author":{"name":"权栈","slug":"blog-author","avatar":"https://p6-passport.byteacctimg.com/img/user-avatar/40c734cabc45915e93f17b88134aa761~140x140.awebp","link":"/","description":"成就伟大的唯一途径就是热爱你所做的事情","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}