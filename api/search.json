[{"id":"da2d755c98b04089d7596f9ea22513af","title":"ç€‘å¸ƒæµ","content":"ä»€ä¹ˆæ˜¯ç€‘å¸ƒæµç€‘å¸ƒæµå¸ƒå±€ï¼Œä½œä¸ºä¸€ç§ç°ä»£ç½‘é¡µè®¾è®¡ä¸­çš„åˆ›æ–°å¸ƒå±€æ–¹å¼ï¼Œä»¥å…¶ç‹¬ç‰¹çš„è§†è§‰é£æ ¼å’Œæµç•…çš„ç”¨æˆ·ä½“éªŒåœ¨ä¼—å¤šç½‘ç«™è®¾è®¡ä¸­è„±é¢–è€Œå‡ºã€‚è¿™ç§å¸ƒå±€æ¨¡å¼è¢«å½¢è±¡åœ°ç§°ä¸ºâ€œç€‘å¸ƒæµâ€\nç€‘å¸ƒæµå¸ƒå±€çš„æ ¸å¿ƒç‰¹å¾å¤šåˆ—ç­‰å®½ä¸ç­‰é«˜ï¼šç€‘å¸ƒæµå¸ƒå±€ä»¥å¤šåˆ—çš„å½¢å¼å±•ç°å†…å®¹ï¼Œæ¯åˆ—å®½åº¦ä¿æŒä¸€è‡´ï¼Œè€Œé«˜åº¦åˆ™æ ¹æ®æ‰€å®¹çº³å†…å®¹çš„å¤§å°åŠ¨æ€è°ƒæ•´ï¼Œå½¢æˆé”™è½æœ‰è‡´çš„è§†è§‰æ•ˆæœã€‚\nåŠ¨æ€åŠ è½½ä¸æ— é™æ»šåŠ¨ï¼šç”¨æˆ·åœ¨æµè§ˆè¿‡ç¨‹ä¸­ï¼Œéšç€æ»šåŠ¨é¡µé¢ï¼Œæ–°çš„å†…å®¹å—ä¼šè‡ªåŠ¨åŠ è½½ï¼Œå®ç°äº†â€œæ— å°½â€çš„å†…å®¹æµï¼Œå‡å°‘äº†åˆ†é¡µæ“ä½œï¼Œæå‡äº†æµè§ˆè¿è´¯æ€§ã€‚\nè§†è§‰å¸å¼•åŠ›ï¼šå°¤å…¶æ“…é•¿å±•ç¤ºå›¾ç‰‡æˆ–è§†è§‰å…ƒç´ ä¸°å¯Œçš„åª’ä½“å†…å®¹ï¼Œä¸ºç”¨æˆ·æä¾›äº†æ²‰æµ¸å¼çš„æµè§ˆä½“éªŒï¼Œå¢åŠ äº†é¡µé¢çš„è§‚èµæ€§å’Œäº’åŠ¨æ€§ã€‚\nè®¾è®¡ç€‘å¸ƒæµå¸ƒå±€\nå…ˆè·å–å±å¹•çš„å¤§å°\nè·å–å›¾ç‰‡çš„å®½åº¦\nç¡®å®šç¬¬ä¸€è¡Œèƒ½æ”¾å‡ å¼ å›¾ï¼ˆnå¼ ï¼‰\næ“ä½œç¬¬ n+1 å¼  æ‘†æ”¾å®ƒçš„ä½ç½®ï¼Œå°†å…¶æ”¾åœ¨é«˜åº¦æœ€å°çš„é‚£ä¸€åˆ—\nè·å–æ¯ä¸€åˆ—çš„é«˜åº¦\næ”¾å…¥å›¾ç‰‡åï¼Œæ›´æ–°è¿™ä¸€åˆ—çš„é«˜åº¦\n\nHTML1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;  &lt;meta charset=&quot;UTF-8&quot;&gt;  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;  &lt;title&gt;Document&lt;/title&gt;  &lt;script src=&quot;./index.js&quot;&gt;&lt;/script&gt;   &lt;style&gt;    *&#123;      margin: 0;      padding: 0;    &#125;    #container&#123;      position: relative;    &#125;    .box&#123;      float: left;      padding: 5px;    &#125;    .box-img&#123;      width: 150px;      padding: 5px;      border: 1px solid #aaa;    &#125;    img&#123;      width: 100%;    &#125;  &lt;/style&gt;&lt;/head&gt;&lt;body&gt;  &lt;div id=&quot;container&quot;&gt;    &lt;div class=&quot;box&quot;&gt;      &lt;div class=&quot;box-img&quot;&gt;        &lt;img src=&quot;./img/1.webp&quot; alt=&quot;&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    Â·Â·Â·    Â·Â·Â·    Â·Â·Â·    &lt;div class=&quot;box&quot;&gt;      &lt;div class=&quot;box-img&quot;&gt;        &lt;img src=&quot;./img/9.webp&quot; alt=&quot;&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;box&quot;&gt;      &lt;div class=&quot;box-img&quot;&gt;        &lt;img src=&quot;./img/10.webp&quot; alt=&quot;&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;  &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;\n\njs1234567891011121314151617181920212223242526272829303132333435window.onload = function() &#123;    imgLocation(&#x27;container&#x27;, &#x27;box&#x27;)        function imgLocation(parent, child) &#123;      var cParent = document.getElementById(parent)      var cChild = cParent.getElementsByClassName(child)      var screenWidth = window.innerWidth      var imgWidth = cChild[0].offsetWidth      var num = Math.floor(screenWidth / imgWidth)      cParent.style.width = `$&#123;imgWidth * num&#125;px`        // æ“ä½œç¬¬ num+1 å¼       var boxHeightArr = []      for (var i = 0; i &lt; cChild.length; i++) &#123;        if (i &lt; num) &#123;  // ç¬¬ä¸€è¡Œ          boxHeightArr.push(cChild[i].offsetHeight)        &#125;         else &#123;          // æ‰¾æ•°ç»„æœ€å°å€¼          var minHeight = Math.min(...boxHeightArr)            var minIndex = boxHeightArr.indexOf(minHeight)             // æ‘†æ”¾å›¾ç‰‡          cChild[i].style.position = &#x27;absolute&#x27;          cChild[i].style.top = minHeight + &#x27;px&#x27;          cChild[i].style.left = cChild[minIndex].offsetLeft + &#x27;px&#x27;            // æ›´æ–°è¿™ä¸€åˆ—çš„é«˜åº¦          boxHeightArr[minIndex] = boxHeightArr[minIndex] + cChild[i].offsetHeight        &#125;      &#125;    &#125;    &#125;\n\nwindow.onload = function() &#123;&#125;js å†™åœ¨å¤´éƒ¨ï¼ŒåŠ ä¸Šè¿™ä¸ªå°±ä¸å½±å“äº†ï¼Œä¹‹åçš„ä»£ç å†™åœ¨é‡Œé¢å°±å¯ä»¥äº†ï¼›\nimgLocation(&#39;container&#39;, &#39;box&#39;)   è¿ç”¨å°è£…çš„æ€ç»´\n.offsetWidth  è·å–å®½åº¦\n.offsetHeight è·å–é«˜åº¦\n.offsetLeft   è·å–è·ç¦»çˆ¶å…ƒç´ çš„å·¦ä¾§è·ç¦»\n.offsetTop    è·å–è·ç¦»çˆ¶å…ƒç´ çš„é¡¶éƒ¨è·ç¦»\n...boxHeightArr   â€¦æ˜¯è§£æ„æ•°ç»„çš„æ“ä½œ\nindexof(arr)      ä¼šè¿”å›æ•°ç»„çš„ä¸‹æ ‡\n","slug":"ç€‘å¸ƒæµ","date":"2024-11-22T06:12:20.000Z","categories_index":"JS","tags_index":"JS","author_index":"æƒæ ˆ"},{"id":"b78b732595416811105ff8bbead66711","title":"å‰ç«¯é€šä¿¡ CustomEvent","content":"é€šè¿‡ç®€å•çš„å‡ è¡Œä»£ç ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè½»æ¾åˆ›å»ºå’Œè§¦å‘è‡ªå®šä¹‰äº‹ä»¶ï¼Œä»è€Œé™ä½ç‰¹æ®Šåœºæ™¯ä¸‹çš„å¼€å‘é£é™©ï¼Œå¹¶ä¸”æå‡æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡ã€‚è€Œä¸”å®ƒå¯ä»¥éå¸¸å®¹æ˜“çš„å†™åˆ° React å’Œ Vue é¡¹ç›®ä¸­ï¼Œ\nå®ç°è¿‡ç¨‹çœ‹çœ‹å¦‚ä½•åˆ©ç”¨ CustomEvent æ„å»ºä¸€ä¸ªå…¨å±€å¹¿æ’­æ¨é€æ¶ˆæ¯çš„æœºåˆ¶ï¼š\n1234567// åˆ›å»ºå¹¶è§¦å‘è‡ªå®šä¹‰äº‹ä»¶const customEvent = w(&#x27;yourEventName&#x27;, &#123;    detail: &#123; key: &#x27;myKey&#x27;, value: &#x27;newValue&#x27;&#125; // è‡ªå®šä¹‰æ•°æ®&#125;); window.dispatchEvent(customEvent); // æ¨é€æ¶ˆæ¯\n\næˆ‘ä»¬éœ€è¦è®¾ç½®æ¥æ”¶ç«¯ï¼š\n1234567// ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶window.addEventListener(&#x27;yourEventName&#x27;, (event) =&gt; &#123;  const &#123; key, value &#125; = event.detail;  if (key === &#x27;myKey&#x27;) &#123;    console.log(&#x27;Detected localStorage change:&#x27;, value);  &#125;&#125;);\n\nVue ç»„ä»¶ä¹‹é—´è¿›è¡Œé€šä¿¡12345678910111213141516171819202122232425&lt;template&gt;  &lt;div&gt;    &lt;input v-model=&quot;username&quot; @input=&quot;updateUser&quot; placeholder=&quot;Enter your name&quot; /&gt;  &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123;  data() &#123;    return &#123;      username: &#x27;&#x27;,    &#125;;  &#125;,  methods: &#123;    updateUser() &#123;      // åˆ›å»ºå¹¶è§¦å‘è‡ªå®šä¹‰äº‹ä»¶      const customEvent = new CustomEvent(&#x27;userUpdated&#x27;, &#123;        detail: &#123; name: this.username &#125;,      &#125;);      window.dispatchEvent(customEvent);    &#125;,  &#125;,&#125;;&lt;/script&gt;\n\nNotification.vue\n1234567891011121314151617181920212223&lt;template&gt;  &lt;div v-if=&quot;message&quot;&gt;&#123;&#123; message &#125;&#125;&lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123;  data() &#123;    return &#123;      message: &#x27;&#x27;,    &#125;;  &#125;,  mounted() &#123;    window.addEventListener(&#x27;userUpdated&#x27;, (event) =&gt; &#123;      const &#123; name &#125; = event.detail;      this.message = `User name has been changed to $&#123;name&#125;`;    &#125;);  &#125;,  beforeDestroy() &#123;    window.removeEventListener(&#x27;userUpdated&#x27;, this.eventListener);  &#125;,&#125;;&lt;/script&gt;\n\n","slug":"å‰ç«¯é€šä¿¡ CustomEvent","date":"2024-11-08T06:39:50.000Z","categories_index":"Vue","tags_index":"Vue","author_index":"æƒæ ˆ"},{"id":"4a2d58310807e71f37ee94ffca6e1c5d","title":"åœ¨ Vue ä¸­å®ç°20MBå›¾ç‰‡ä¸Šä¼ å‹ç¼©åˆ°10KB","content":"åœ¨ç°ä»£ Web åº”ç”¨ä¸­ï¼Œæ–‡ä»¶ä¸Šä¼ æ˜¯ä¸€ä¸ªå¸¸è§çš„åŠŸèƒ½ï¼Œå°¤å…¶æ˜¯åœ¨ç”¨æˆ·éœ€è¦ä¸Šä¼ å›¾ç‰‡æ—¶ã€‚ç„¶è€Œï¼Œä¸Šä¼ çš„æ–‡ä»¶å¾€å¾€ä¼šå ç”¨è¾ƒå¤§çš„å­˜å‚¨ç©ºé—´ï¼Œå½±å“æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚å› æ­¤ï¼Œé™åˆ¶æ–‡ä»¶å¤§å°æ˜¯ä¸€ä¸ªé‡è¦çš„éœ€æ±‚ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•åœ¨ Vue.js åº”ç”¨ä¸­å®ç°æ–‡ä»¶ä¸Šä¼ ï¼Œå¹¶å°†ä¸Šä¼ å‹ç¼©åˆ° 10KB\nåˆ›å»ºæ–‡ä»¶ä¸Šä¼ ç»„ä»¶æˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªç®€å•çš„æ–‡ä»¶ä¸Šä¼ ç»„ä»¶ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è¿™ä¸ªç»„ä»¶é€‰æ‹©å›¾ç‰‡æ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯åŸºæœ¬çš„ç»„ä»¶ç»“æ„ï¼š\n123456&lt;template&gt;  &lt;div&gt;    &lt;input type=&quot;file&quot; @change=&quot;handleFileUpload&quot; accept=&quot;image/*&quot; /&gt;    &lt;img v-if=&quot;imageSrc&quot; :src=&quot;imageSrc&quot; alt=&quot;Preview&quot; /&gt;  &lt;/div&gt;&lt;/template&gt;\n\nè¿™ä¸ªæ¨¡æ¿åŒ…å«ä¸€ä¸ªæ–‡ä»¶è¾“å…¥æ¡†å’Œä¸€ä¸ªç”¨äºæ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆçš„ img æ ‡ç­¾ã€‚\nå¤„ç†æ–‡ä»¶ä¸Šä¼ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç»„ä»¶ä¸­å®šä¹‰æ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ FileReader API æ¥è¯»å–æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ canvas è¿›è¡Œå›¾ç‰‡çš„å‹ç¼©å¤„ç†ã€‚\n123456789101112131415&lt;script&gt;export default &#123;  data() &#123;    return &#123;      imageSrc: null,    &#125;;  &#125;,  methods: &#123;    async handleFileUpload(event) &#123;      const file = event.target.files[0];      if (file) &#123;        const compressedFile = await this.compressImage(file);        console.log(compressedFile);      &#125;    &#125;,\n\nhandleFileUpload æ–¹æ³•ä¼šåœ¨ç”¨æˆ·é€‰æ‹©æ–‡ä»¶åè¢«è°ƒç”¨ã€‚æˆ‘ä»¬é¦–å…ˆæ£€æŸ¥ç”¨æˆ·æ˜¯å¦é€‰æ‹©äº†æ–‡ä»¶ï¼Œå¦‚æœé€‰æ‹©äº†ï¼Œåˆ™è°ƒç”¨ compressImage æ–¹æ³•è¿›è¡Œå‹ç¼©å¤„ç†ã€‚\nå‹ç¼©å›¾ç‰‡å‹ç¼©å›¾ç‰‡çš„æ ¸å¿ƒé€»è¾‘åœ¨äº compressImage æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ canvas å…ƒç´ ï¼Œå¹¶æ ¹æ®æœ€å¤§å®½é«˜å¯¹å›¾ç‰‡è¿›è¡Œç¼©æ”¾ï¼Œç„¶åå°†å…¶å‹ç¼©åˆ° 10KB ä»¥å†…ã€‚\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849      compressImage(file) &#123;      return new Promise((resolve, reject) =&gt; &#123;        const reader = new FileReader();        reader.onload = (e) =&gt; &#123;          const img = new Image();          img.src = e.target.result;          img.onload = () =&gt; &#123;            const canvas = document.createElement(&#x27;canvas&#x27;);            const ctx = canvas.getContext(&#x27;2d&#x27;);            const MAX_WIDTH = 100; // æœ€å¤§å®½åº¦            const MAX_HEIGHT = 100; // æœ€å¤§é«˜åº¦            let width = img.width;            let height = img.height;            // è®¡ç®—æ–°çš„å®½é«˜            if (width &gt; height) &#123;              if (width &gt; MAX_WIDTH) &#123;                height *= MAX_WIDTH / width;                width = MAX_WIDTH;              &#125;            &#125; else &#123;              if (height &gt; MAX_HEIGHT) &#123;                width *= MAX_HEIGHT / height;                height = MAX_HEIGHT;              &#125;            &#125;            canvas.width = width;            canvas.height = height;            ctx.drawImage(img, 0, 0, width, height);            // å‹ç¼©ä¸º 10KB            canvas.toBlob((blob) =&gt; &#123;              if (blob.size &gt; 10 * 1024) &#123; // 10KB                reject(new Error(&#x27;Compressed file exceeds 10KB.&#x27;));              &#125; else &#123;                resolve(blob);                this.imageSrc = URL.createObjectURL(blob); // æ˜¾ç¤ºé¢„è§ˆ              &#125;            &#125;, &#x27;image/jpeg&#x27;, 0.7); // è®¾å®šå‹ç¼©è´¨é‡          &#125;;        &#125;;        reader.readAsDataURL(file);      &#125;);    &#125;,  &#125;,&#125;;&lt;/script&gt;\n\nåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè¯»å–æ–‡ä»¶å¹¶åˆ›å»ºä¸€ä¸ªå›¾åƒå¯¹è±¡ã€‚åœ¨å›¾åƒåŠ è½½å®Œæˆåï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª canvasï¼Œè®¾ç½®å…¶å¤§å°ï¼Œå¹¶å°†å›¾åƒç»˜åˆ¶åˆ°ç”»å¸ƒä¸Šã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ canvas.toBlob æ–¹æ³•å°†ç”»å¸ƒå†…å®¹è½¬æ¢ä¸º Blob å¯¹è±¡ï¼Œå¹¶æ£€æŸ¥å…¶å¤§å°æ˜¯å¦å°äº 10KBã€‚å¦‚æœå‹ç¼©æˆåŠŸï¼Œæˆ‘ä»¬å°† Blob å¯¹è±¡è½¬æ¢ä¸º URL ä»¥ä¾›é¢„è§ˆã€‚\né¢„è§ˆä¸ç”¨æˆ·åé¦ˆåœ¨å¤„ç†å®Œæ–‡ä»¶ä¸Šä¼ å’Œå‹ç¼©åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»‘å®š imageSrc æ¥æ˜¾ç¤ºä¸Šä¼ åçš„å›¾ç‰‡é¢„è§ˆã€‚è¿™æ ·ç”¨æˆ·å°±å¯ä»¥å®æ—¶æŸ¥çœ‹ä»–ä»¬ä¸Šä¼ çš„æ–‡ä»¶ã€‚\n1&lt;img v-if=&quot;imageSrc&quot; :src=&quot;imageSrc&quot; alt=&quot;Preview&quot; /&gt;\n\næ€»ç»“é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæˆ‘ä»¬æˆåŠŸåˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„æ–‡ä»¶ä¸Šä¼ ç»„ä»¶ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°é™åˆ¶ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ä¸º 10KBã€‚è¿™ç§å¤„ç†æ–¹å¼ä¸ä»…èƒ½ä¿è¯ä¸Šä¼ çš„æ–‡ä»¶ç¬¦åˆå¤§å°è¦æ±‚ï¼ŒåŒæ—¶ä¹Ÿèƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿è¯ä¸Šä¼ çš„é€Ÿåº¦å’Œç”¨æˆ·ä½“éªŒã€‚\nå¦‚æœä½ éœ€è¦æ”¯æŒå…¶ä»–ç±»å‹çš„æ–‡ä»¶æˆ–è€…æ‰©å±•æ›´å¤šåŠŸèƒ½ï¼Œå¯ä»¥æ ¹æ®å®é™…éœ€æ±‚å¯¹ä»£ç è¿›è¡Œç›¸åº”çš„ä¿®æ”¹ã€‚è¿™ç§æ–¹æ³•ä¹Ÿå¯ä»¥ä½œä¸ºå…¶ä»–æ–‡ä»¶å¤„ç†åŠŸèƒ½çš„åŸºç¡€ï¼Œå¸®åŠ©ä½ åœ¨ Vue åº”ç”¨ä¸­å®ç°æ›´å¤æ‚çš„æ–‡ä»¶ä¸Šä¼ é€»è¾‘ã€‚\n","slug":"åœ¨ Vue ä¸­å®ç°æ–‡ä»¶ä¸Šä¼ å¹¶é™åˆ¶æ–‡ä»¶å¤§å°ä¸º 10KB","date":"2024-11-01T06:02:00.000Z","categories_index":"Vue","tags_index":"Vue","author_index":"æƒæ ˆ"},{"id":"322d11b057e8d3400060738444344655","title":"Vue3æºç â€”â€”renderå‡½æ•°","content":"åœ¨äº†è§£vue renderå‡½æ•°ä¹‹å‰, éœ€è¦å…ˆäº†è§£ä¸‹Vueçš„æ•´ä½“æµç¨‹\nåº”è¯¥å¯ä»¥ç†è§£ä¸€ä¸ªVueç»„ä»¶æ˜¯å¦‚ä½•è¿è¡Œèµ·æ¥çš„.\n\næ¨¡æ¿é€šè¿‡ç¼–è¯‘ç”ŸæˆASTæ ‘\nASTæ ‘ç”ŸæˆVueçš„renderæ¸²æŸ“å‡½æ•°\nrenderæ¸²æŸ“å‡½æ•°ç»“åˆæ•°æ®ç”ŸæˆvNode(Virtual DOM Node)æ ‘\nDiffå’ŒPatchåç”Ÿæ–°çš„UIç•Œé¢(çœŸå®DOMæ¸²æŸ“)\n\næˆ‘ä»¬éœ€è¦äº†è§£ä»¥ä¸‹å‡ ä¸ªæ¦‚å¿µ:\n\næ¨¡æ¿, Vueæ¨¡æ¿æ˜¯çº¯HTML, åŸºäºVueçš„æ¨¡æ¿è¯­æ³•, å¯ä»¥æ¯”è¾ƒæ–¹ä¾¿çš„å¤„ç†æ•°æ®å’ŒUIç•Œé¢çš„å…³ç³»\nAST, å³Abstract Syntax Treeçš„ç®€ç§°, Vueå°†HTMLæ¨¡æ¿è§£æä¸ºAST,å¹¶å¯¹ASTè¿›è¡Œä¸€äº›ä¼˜åŒ–çš„æ ‡è®°å¤„ç†, æå–æœ€å¤§çš„é™æ€æ ‘,ä»¥ä½¿Virtual DOMç›´æ¥è·³è¿‡åé¢çš„Diff\nrenderæ¸²æŸ“å‡½æ•°, renderæ¸²æŸ“å‡½æ•°æ˜¯ç”¨æ¥ç”ŸæˆVirtual DOMçš„. Vueæ¨èä½¿ç”¨æ¨¡æ¿æ¥æ„å»ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åº, åœ¨åº•å±‚å®ç°ä¸­Vueæœ€ç»ˆè¿˜æ˜¯ä¼šå°†æ¨¡æ¿ç¼–è¯‘æˆæ¸²æŸ“å‡½æ•°. å› æ­¤, è‹¥æˆ‘ä»¬æƒ³è¦å¾—åˆ°æ›´å¥½çš„æ§åˆ¶, å¯ä»¥ç›´æ¥å†™æ¸²æŸ“å‡½æ•°.(é‡ç‚¹)\nVirtual DOM, è™šæ‹ŸDOM\nWatcher, æ¯ä¸ªVueç»„ä»¶éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„watcher, å®ƒä¼šåœ¨ç»„ä»¶renderæ—¶æ”¶é›†ç»„ä»¶æ‰€ä¾èµ–çš„æ•°æ®, å¹¶åœ¨ä¾èµ–æœ‰æ›´æ–°æ—¶, è§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“, Vueä¼šè‡ªåŠ¨ä¼˜åŒ–å¹¶æ›´æ–°éœ€è¦æ›´æ–°DOM\n\n.vueå•æ–‡ä»¶çš„å®ç°12345678910111213141516171819202122232425262728293031&lt;template&gt;    &lt;h1 v-if=&quot;level === 1&quot;&gt;        &lt;slot&gt;&lt;/slot&gt;    &lt;/h1&gt;    &lt;h2 v-else-if=&quot;level === 2&quot;&gt;        &lt;slot&gt;&lt;/slot&gt;    &lt;/h2&gt;    &lt;h3 v-else-if=&quot;level === 3&quot;&gt;        &lt;slot&gt;&lt;/slot&gt;    &lt;/h3&gt;    &lt;h4 v-else-if=&quot;level === 4&quot;&gt;        &lt;slot&gt;&lt;/slot&gt;    &lt;/h4&gt;    &lt;h5 v-else-if=&quot;level === 5&quot;&gt;        &lt;slot&gt;&lt;/slot&gt;    &lt;/h5&gt;    &lt;h6 v-else-if=&quot;level === 6&quot;&gt;        &lt;slot&gt;&lt;/slot&gt;    &lt;/h6&gt;&lt;/template&gt;&lt;script&gt;export default &#123;  name: &#x27;anchored-heading&#x27;,  props: &#123;        level: &#123;            type: Number,            required: true        &#125;    &#125;&#125;&lt;/script&gt;\n\nrenderå‡½æ•°çš„å®ç°123456789101112131415Vue.component(&#x27;anchored-heading&#x27;, &#123;    render: function (createElement) &#123;        return createElement(            &#x27;h&#x27; + this.level,   // tag name æ ‡ç­¾åç§°            this.$slots.default // å­ç»„ä»¶ä¸­çš„é˜µåˆ—        )    &#125;,    props: &#123;        level: &#123;            type: Number,            required: true        &#125;    &#125;&#125;)\n\ncreateElementè§£æè¿‡ç¨‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104const SIMPLE_NORMALIZE = 1const ALWAYS_NORMALIZE = 2function createElement (context, tag, data, children, normalizationType, alwaysNormalize) &#123;    // å…¼å®¹ä¸ä¼ dataçš„æƒ…å†µ    if (Array.isArray(data) || isPrimitive(data)) &#123;        normalizationType = children        children = data        data = undefined    &#125;    // å¦‚æœalwaysNormalizeæ˜¯true    // é‚£ä¹ˆnormalizationTypeåº”è¯¥è®¾ç½®ä¸ºå¸¸é‡ALWAYS_NORMALIZEçš„å€¼    if (alwaysNormalize) normalizationType = ALWAYS_NORMALIZE        // è°ƒç”¨_createElementåˆ›å»ºè™šæ‹ŸèŠ‚ç‚¹        return _createElement(context, tag, data, children, normalizationType)    &#125;    function _createElement (context, tag, data, children, normalizationType) &#123;        /**        * å¦‚æœå­˜åœ¨data.__ob__ï¼Œè¯´æ˜dataæ˜¯è¢«Observerè§‚å¯Ÿçš„æ•°æ®        * ä¸èƒ½ç”¨ä½œè™šæ‹ŸèŠ‚ç‚¹çš„data        * éœ€è¦æŠ›å‡ºè­¦å‘Šï¼Œå¹¶è¿”å›ä¸€ä¸ªç©ºèŠ‚ç‚¹        *         * è¢«ç›‘æ§çš„dataä¸èƒ½è¢«ç”¨ä½œvnodeæ¸²æŸ“çš„æ•°æ®çš„åŸå› æ˜¯ï¼š        * dataåœ¨vnodeæ¸²æŸ“è¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¢«æ”¹å˜ï¼Œè¿™æ ·ä¼šè§¦å‘ç›‘æ§ï¼Œå¯¼è‡´ä¸ç¬¦åˆé¢„æœŸçš„æ“ä½œ        */        if (data &amp;&amp; data.__ob__) &#123;            process.env.NODE_ENV !== &#x27;production&#x27; &amp;&amp; warn(            `Avoid using observed data object as vnode data: $&#123;JSON.stringify(data)&#125;\\n` +            &#x27;Always create fresh vnode data objects in each render!&#x27;,            context            )            return createEmptyVNode()        &#125;        // å½“ç»„ä»¶çš„iså±æ€§è¢«è®¾ç½®ä¸ºä¸€ä¸ªfalsyçš„å€¼        // Vueå°†ä¸ä¼šçŸ¥é“è¦æŠŠè¿™ä¸ªç»„ä»¶æ¸²æŸ“æˆä»€ä¹ˆ        // æ‰€ä»¥æ¸²æŸ“ä¸€ä¸ªç©ºèŠ‚ç‚¹        if (!tag) &#123;            return createEmptyVNode()        &#125;        // ä½œç”¨åŸŸæ’æ§½        if (Array.isArray(children) &amp;&amp; typeof children[0] === &#x27;function&#x27;) &#123;            data = data || &#123;&#125;            data.scopedSlots = &#123; default: children[0] &#125;            children.length = 0        &#125;        // æ ¹æ®normalizationTypeçš„å€¼ï¼Œé€‰æ‹©ä¸åŒçš„å¤„ç†æ–¹æ³•        if (normalizationType === ALWAYS_NORMALIZE) &#123;            children = normalizeChildren(children)        &#125; else if (normalizationType === SIMPLE_NORMALIZE) &#123;            children = simpleNormalizeChildren(children)        &#125;        let vnode, ns        // å¦‚æœæ ‡ç­¾åæ˜¯å­—ç¬¦ä¸²ç±»å‹        if (typeof tag === &#x27;string&#x27;) &#123;            let Ctor            // è·å–æ ‡ç­¾åçš„å‘½åç©ºé—´            ns = config.getTagNamespace(tag)            // åˆ¤æ–­æ˜¯å¦ä¸ºä¿ç•™æ ‡ç­¾            if (config.isReservedTag(tag)) &#123;                // å¦‚æœæ˜¯ä¿ç•™æ ‡ç­¾,å°±åˆ›å»ºä¸€ä¸ªè¿™æ ·çš„vnode                vnode = new VNode(                    config.parsePlatformTagName(tag), data, children,                    undefined, undefined, context                )                // å¦‚æœä¸æ˜¯ä¿ç•™æ ‡ç­¾ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å°è¯•ä»vmçš„componentsä¸ŠæŸ¥æ‰¾æ˜¯å¦æœ‰è¿™ä¸ªæ ‡ç­¾çš„å®šä¹‰            &#125; else if ((Ctor = resolveAsset(context.$options, &#x27;components&#x27;, tag))) &#123;                // å¦‚æœæ‰¾åˆ°äº†è¿™ä¸ªæ ‡ç­¾çš„å®šä¹‰ï¼Œå°±ä»¥æ­¤åˆ›å»ºè™šæ‹Ÿç»„ä»¶èŠ‚ç‚¹                vnode = createComponent(Ctor, data, context, children, tag)            &#125; else &#123;                // å…œåº•æ–¹æ¡ˆï¼Œæ­£å¸¸åˆ›å»ºä¸€ä¸ªvnode                vnode = new VNode(                    tag, data, children,                    undefined, undefined, context                )            &#125;        // å½“tagä¸æ˜¯å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œæˆ‘ä»¬è®¤ä¸ºtagæ˜¯ç»„ä»¶çš„æ„é€ ç±»        // æ‰€ä»¥ç›´æ¥åˆ›å»º        &#125; else &#123;            vnode = createComponent(tag, data, context, children)        &#125;        // å¦‚æœæœ‰vnode        if (vnode) &#123;            // å¦‚æœæœ‰namespaceï¼Œå°±åº”ç”¨ä¸‹namespaceï¼Œç„¶åè¿”å›vnode            if (ns) applyNS(vnode, ns)            return vnode        // å¦åˆ™ï¼Œè¿”å›ä¸€ä¸ªç©ºèŠ‚ç‚¹        &#125; else &#123;            return createEmptyVNode()        &#125;    &#125;&#125;\n\n","slug":"Vue3æºç â€”â€”renderå‡½æ•°","date":"2024-10-18T07:25:50.000Z","categories_index":"Vue3","tags_index":"Vue3","author_index":"æƒæ ˆ"},{"id":"c86a81eebdde1918fe7712218383ec84","title":"Vue3æºç â€”â€”hå‡½æ•°","content":"Vueå’ŒReactè¿™ç±»æ¡†æ¶æ¯”èµ·è¿œå¤æ—¶æœŸçš„jQueryï¼Œæœ€å¤§çš„æ”¹å˜å°±æ˜¯é‡‡ç”¨äº†MVVMæ¶æ„ã€‚\nè€ŒMVVMæ¶æ„çš„æ ¸å¿ƒï¼Œåˆ™æ˜¯è™šæ‹ŸDOMã€‚\nåŸºæœ¬æ¦‚å¿µè™šæ‹ŸDOMè¯´åˆ°è™šæ‹ŸDOMï¼Œå…ˆå¾—è¯´èµ·çœŸå®DOMã€‚çœŸå®çš„DOMå°±æ˜¯ä¸€é¢—HTMLæ ‘ï¼Œé‡Œé¢åŒ…å«äº†èŠ‚ç‚¹ã€å±æ€§ï¼ˆclassã€idã€styleç­‰ï¼‰ã€å­èŠ‚ç‚¹ä¿¡æ¯ã€‚\nä¾‹å¦‚è¿™æ ·çš„DOMèŠ‚ç‚¹\n1&lt;div id=&quot;app&quot; class=&quot;test&quot;&gt;hello world&lt;/div&gt;\n\nè™šæ‹Ÿçš„DOMä¹Ÿè¦åŒ…æ‹¬å’ŒçœŸå®DOMä¸€æ ·çš„ä¿¡æ¯ã€‚åŒºåˆ«åœ¨äºï¼Œå®ƒç”¨JSå¯¹è±¡æ¥è¡¨ç¤º\nä¾‹å¦‚åˆšæ‰çš„DOMèŠ‚ç‚¹ï¼Œç”¨JSå¯ä»¥è¿™æ ·è¡¨ç¤º\n12345678const vnode = &#123;    type: &quot;div&quot;,    props: &#123;        id: &quot;app&quot;,        class: &quot;test&quot;    &#125;,    children: &quot;hello world&quot;&#125;\n\nå¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªvnodeå¯¹è±¡ï¼Œç”¨äº†typeã€propså’Œchildrenåˆ†åˆ«è¡¨ç¤ºäº†è¿™ä¸ªçœŸå®DOMèŠ‚ç‚¹çš„ç±»å‹ï¼ˆdivï¼‰ã€å±æ€§ï¼ˆidä¸ºappï¼Œclassä¸ºtestï¼‰ä»¥åŠå­èŠ‚ç‚¹ï¼ˆå­—ç¬¦ä¸²hello worldï¼‰ã€‚çœ‹ç€è¿™æ ·æ ¼å¼çš„JSå¯¹è±¡ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“åœ°æ¨ç†å¾—åˆ°ä¸€ä¸ªçœŸå®çš„DOMèŠ‚ç‚¹ã€‚æˆ‘ä»¬æŠŠè¿™æ ·çš„ä¸€ä¸ªå¯¹è±¡ç§°ä¹‹ä¸ºè™šæ‹ŸDOMã€‚\nhå‡½æ•°åœ¨Vueæºç ä¸­ï¼Œè™šæ‹ŸDOMæ˜¯ç”±hå‡½æ•°ç”Ÿæˆçš„ã€‚ç”Ÿæˆæ—¶åŒæ ·å¯ä»¥ä¼ å…¥èŠ‚ç‚¹ç±»å‹ã€å±æ€§ä»¥åŠå­èŠ‚ç‚¹ä¿¡æ¯ã€‚\n1h(&quot;div&quot;, &#123; id: &quot;app&quot;, class: &quot;test&quot; &#125;, &quot;hello world&quot;)\n\nå°è¯•æ‰“å°è¿™ä¸ªhå‡½æ•°ç”Ÿæˆçš„vnodeï¼Œå†…éƒ¨ä¿¡æ¯æ¯”è¾ƒä¸°å¯Œï¼Œç”¨æ³¨é‡Šæ ‡æ³¨äº†ä¸€äº›æ ¸å¿ƒçš„å±æ€§\n1234567891011121314151617181920212223242526272829303132&#123;        // æ˜¯å¦æ˜¯VNodeå¯¹è±¡        &quot;__v_isVNode&quot;: true,        &quot;__v_skip&quot;: true,        // èŠ‚ç‚¹ç±»å‹        &quot;type&quot;: &quot;div&quot;,        // èŠ‚ç‚¹å±æ€§        &quot;props&quot;: &#123; &quot;class&quot;: &quot;test&quot;, &quot;id&quot;: &quot;app&quot; &#125;,        &quot;key&quot;: null,        &quot;ref&quot;: null,        &quot;scopeId&quot;: null,        &quot;slotScopeIds&quot;: null,        // å­èŠ‚ç‚¹        &quot;children&quot;: &quot;hello world&quot;,        &quot;component&quot;: null,        &quot;suspense&quot;: null,        &quot;ssContent&quot;: null,        &quot;ssFallback&quot;: null,        &quot;dirs&quot;: null,        &quot;transition&quot;: null,        &quot;el&quot;: null,        &quot;anchor&quot;: null,        &quot;target&quot;: null,        &quot;targetAnchor&quot;: null,        &quot;staticCount&quot;: 0,        &quot;shapeFlag&quot;: 9,        &quot;patchFlag&quot;: 0,        &quot;dynamicProps&quot;: null,        &quot;dynamicChildren&quot;: null,        &quot;appContext&quot;: null&#125;\n\nhå‡½æ•°æ¡†æ¶åŸºæœ¬æ¡†æ¶å¯¹äºhå‡½æ•°ï¼Œæˆ‘ä»¬çŸ¥é“åº”è¯¥åŒ…æ‹¬ä¸‰ä¸ªå‚æ•°\n\nèŠ‚ç‚¹ç±»å‹type\nå±æ€§propsï¼ˆå¯é€‰ï¼‰\nå­èŠ‚ç‚¹childrenï¼ˆå¯é€‰ï¼‰\n\nè€ƒè™‘åˆ°å±æ€§å’Œå­èŠ‚ç‚¹éƒ½æ˜¯å¯é€‰å‚æ•°ï¼Œå› æ­¤è¦é’ˆå¯¹å…¥å‚æ•°é‡å’Œç±»å‹åšä¸€äº›åˆ¤æ–­ï¼Œå¤§æ¦‚çš„è§„åˆ™å¦‚ä¸‹\n12345678910111213141516171819202122232425export function h(type: any, propsOrChildren?: any, children?: any): VNode &#123;  const l = arguments.length;  // ä¸¤ä¸ªå‚æ•°ï¼Œä¸çŸ¥é“æ˜¯propsæ²¡ä¼ è¿˜æ˜¯childrenæ²¡ä¼   if (l == 2) &#123;    if (isObject(propsOrChildren) &amp;&amp; !isArray(propsOrChildren)) &#123;      if (isVNode(propsOrChildren)) &#123;        return createVNode(type, null, [propsOrChildren]);      &#125;      return createVNode(type, propsOrChildren, []);    &#125; else &#123;      return createVNode(type, null, propsOrChildren);    &#125;  &#125; else &#123;    // ä¸‰ä¸ªåŠä»¥ä¸Šçš„å‚æ•°ï¼Œè‚¯å®šæ˜¯propså’Œchildrenéƒ½æœ‰    if (l &gt; 3) &#123;      children = Array.prototype.slice.call(arguments, 2);    &#125; else if (l === 3 &amp;&amp; isVNode(children)) &#123;      children = [children];    &#125;    return createVNode(type, propsOrChildren, children);  &#125;&#125;\n\nè‡³äºæ˜¯å¦ä¸ºvnodeçš„åˆ¤æ–­ï¼Œç›´æ¥æ ¹æ®__v_isVNodeå±æ€§å°±å¯å¾—çŸ¥\n123export function isVNode(value: any): value is VNode &#123;  return value ? value.__v_isVNode === true : false;&#125;\n\næ•´ä½“æ¡†æ¶å‡ºæ¥äº†ï¼Œæ¥ä¸‹æ¥vnodeçš„ç”Ÿæˆï¼Œä¸»è¦å°±æ˜¯createVNodeè¿™ä¸ªæ–¹æ³•äº†\nvnodeçš„ç±»å‹å…³äºDOMèŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¤§æ¦‚å¯ä»¥åˆ†æˆè¿™æ ·ä¸€äº›ç±»åˆ«\n\næ ‡å‡†èŠ‚ç‚¹ï¼šdivã€h1ç­‰å¸¸è§„æ ‡ç­¾\næ³¨é‡ŠèŠ‚ç‚¹\nFragmentèŠ‚ç‚¹\nç»„ä»¶\nâ€¦â€¦\n\né‚£ä¹ˆï¼Œç›¸å¯¹çš„ï¼Œvnodeä¹Ÿä¼šåŒºåˆ†ä¸€äº›èŠ‚ç‚¹ç±»å‹ã€‚\næŸ¥çœ‹Vueæºç å¯ä»¥å¾—çŸ¥ï¼Œé‡Œé¢åŒ…å«äº†æ–‡æœ¬èŠ‚ç‚¹Textã€ç‰‡æ®µèŠ‚ç‚¹Fragmentã€DOMèŠ‚ç‚¹Elementã€ç»„ä»¶èŠ‚ç‚¹Componentã€æ³¨é‡ŠèŠ‚ç‚¹Commentç­‰ç­‰ã€‚\næ­¤å¤–ï¼Œå¯¹äºchildrenæ¥è¯´ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªï¼Œä¹Ÿå¯èƒ½æ˜¯æ•°ç»„ï¼Œç”šè‡³æ˜¯å¯¹è±¡ã€å‡½æ•°ç­‰ç­‰å¤šç§ä¸åŒç±»å‹ã€‚\næºç ä¸­ï¼Œä¸ºäº†åŒºåˆ†ä¸åŒçš„èŠ‚ç‚¹ï¼Œä½¿ç”¨äº†shapeFlagï¼Œè€Œä¸”è¿™ä¸ªå€¼è¿˜ç”¨äºŒè¿›åˆ¶ä½è¿›è¡Œè®¡ç®—ã€‚\n123456789101112131415161718192021222324252627282930export const enum ShapeFlags &#123;  /**   * type = Element   */  ELEMENT = 1,  /**   * å‡½æ•°ç»„ä»¶   */  FUNCTIONAL_COMPONENT = 1 &lt;&lt; 1,  /**   * æœ‰çŠ¶æ€ï¼ˆå“åº”æ•°æ®ï¼‰ç»„ä»¶   */  STATEFUL_COMPONENT = 1 &lt;&lt; 2,  /**   * children = Text   */  TEXT_CHILDREN = 1 &lt;&lt; 3,  /**   * children = Array   */  ARRAY_CHILDREN = 1 &lt;&lt; 4,  /**   * children = slot   */  SLOTS_CHILDREN = 1 &lt;&lt; 5,  /**   * ç»„ä»¶ï¼šæœ‰çŠ¶æ€ï¼ˆå“åº”æ•°æ®ï¼‰ç»„ä»¶ | å‡½æ•°ç»„ä»¶   */  COMPONENT = ShapeFlags.STATEFUL_COMPONENT | ShapeFlags.FUNCTIONAL_COMPONENT,&#125;\n\nhå‡½æ•°å®ç°elementèŠ‚ç‚¹+æ–‡æœ¬childrenhå‡½æ•°æœ€ç®€å•çš„ç”¨æ³•æ˜¯åˆ›å»ºä¸€ä¸ªæœ‰tagåç§°çš„èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹æ˜¯æ–‡æœ¬ã€‚\n1const vnode = h(&quot;div&quot;, &quot;hello world&quot;);\n\nä¸ºäº†å®ç°VNodeçš„æ„å»ºï¼Œéœ€è¦å…ˆæ„å»ºcreateVNodeæ–¹æ³•ï¼Œæ¥æ”¶typeã€propsã€childrenè¿™ä¸‰ä¸ªå‚æ•°ã€‚\n123456789101112131415export interface VNode &#123;  __v_isVNode: true  type: any  props: any  children: any  shapeFlag: number&#125;export function createVNode(type, props, children): VNode &#123;  // è¿™é‡Œå…ˆå¤„ç†æ–‡æœ¬ç±»å‹ï¼Œå…¶ä»–çš„shapeFlagå…ˆä¸å¤„ç†  const shapeFlag = isString(type) ? ShapeFlags.ELEMENT : 0;    return createBaseVNode(type, props, children, shapeFlag);&#125;\n\nç”Ÿæˆäº†shapeFlagåï¼Œè¦å…ˆåˆ›å»ºVNodeçš„ä¸€äº›åŸºæœ¬å±æ€§ï¼Œæºç ä¸­ç”¨çš„å°±æ˜¯createBaseVNodeæ–¹æ³•ï¼Œå¹¶ä¸”åœ¨è¿™ä¹‹åä½¿ç”¨normalizeChildrenæ ‡å‡†åŒ–childrençš„ç±»å‹ï¼ˆå³ä½¿ç”¨ä½æˆ–è¿ç®—å¾—åˆ°ä¸€ä¸ªshapeFlagå€¼ï¼‰\n123456789101112131415161718192021222324252627282930313233// åˆ›å»ºåŸºç¡€vnodefunction createBaseVNode(type, props, children, shapeFlag) &#123;  const vnode = &#123;    __v_isVNode: true,    type,    props,    shapeFlag,  &#125; as VNode;  normalizeChildren(vnode, children);  return vnode;&#125;function normalizeChildren(vnode: VNode, children: unknown) &#123;  let type = 0;  if (children === null) &#123;    children = null;  &#125; else if (isArray(children)) &#123;    // TODO: æ•°ç»„ç±»å‹childrenå¤„ç†  &#125; else if (typeof children === &quot;object&quot;) &#123;    // TODO: å¯¹è±¡ç±»å‹çš„childrenå¤„ç†  &#125; else if (isFunction(children)) &#123;    // TODO: å‡½æ•°ç±»å‹çš„childrenå¤„ç†  &#125; else &#123;    children = String(children);    type = ShapeFlags.TEXT_CHILDREN;  &#125;  vnode.children = children;  vnode.shapeFlag |= type;&#125;\n\næ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡hå‡½æ•°æ‹¿åˆ°tagä¸ºstringï¼ˆä¾‹å¦‚divã€pç­‰ï¼‰ï¼Œä¸”childrenå†…å®¹æ˜¯textçš„vnodeå€¼äº†ï¼Œå’Œæºç çš„æ ¸å¿ƒå†…å®¹æ˜¯ä¸€è‡´çš„\n123const vnode = h(&quot;div&quot;, &quot;hello world&quot;);console.log(vnode); // shapeFlagæ˜¯9ï¼Œchildrenæ˜¯hello world\n\nelementèŠ‚ç‚¹+æ•°ç»„childrenç›¸æ¯”äºä¸Šä¸€ä¸ªèŠ‚ç‚¹ç±»å‹ï¼Œè¿™ä¸ªçš„åŒºåˆ«å°±æ˜¯childrenä¸å†æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè€Œæ˜¯å¤šä¸ª\n1const vnode = h(&quot;div&quot;, [h(&quot;p&quot;, &quot;p1&quot;), h(&quot;p&quot;, &quot;p2&quot;), h(&quot;p&quot;, &quot;p3&quot;)]);\n\nå…¶ä¸­æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„è§£æå°±æ˜¯åˆšæ‰element+textè¿™ç§ç»„åˆï¼Œè€Œä¸”è¿™å‡ ä¸ªèŠ‚ç‚¹ä¼šå…ˆè¢«å¤„ç†æˆVNodeï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯æ•´ä½“divè¿™ä¸ªèŠ‚ç‚¹\næŸ¥çœ‹æºç å¯ä»¥çŸ¥é“ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æœ€åç”Ÿæˆdivçš„VNodeçš„æ—¶å€™æä¾›ä¸€ä¸ªtypeæ•°å€¼å°±è¡Œ\n123456789function normalizeChildren(vnode: VNode, children: unknown) &#123;  ......  else if (isArray(children)) &#123;    type = ShapeFlags.ARRAY_CHILDREN;  &#125;    ......&#125;\n\nè¿™æ—¶å€™è¿™ä¸ªVNodeçš„æ‰“å°ç»“æœå°±å’Œæºç æ ¸å¿ƒä¸€è‡´äº†\n123const vnode = h(&quot;div&quot;, [h(&quot;p&quot;, &quot;p1&quot;), h(&quot;p&quot;, &quot;p2&quot;), h(&quot;p&quot;, &quot;p3&quot;)]);console.log(vnode); // shapeFlagæ˜¯17ï¼Œchildrenä¹Ÿæ˜¯vnodeèŠ‚ç‚¹ï¼ŒshapeFlagéƒ½æ˜¯9\n\nä»è¿™é‡Œä¸éš¾å‘ç°ï¼ŒVNodeä¸­ä¸€ä¸ªå¾ˆå…³é”®çš„å±æ€§æ˜¯shapeFlagï¼Œæ­£å¦‚åå­—ä¸€æ ·ï¼Œå®ƒæè¿°äº†è™šæ‹ŸDOMèŠ‚ç‚¹çš„å½¢çŠ¶ï¼Œè€Œè¿™ä¸ªå½¢çŠ¶åŒ…æ‹¬äº†çˆ¶èŠ‚ç‚¹ç±»å‹å’Œå­èŠ‚ç‚¹ç±»å‹&#x2F;å½¢çŠ¶ï¼Œå…¶ä¸­ï¼š\n\ncreateBaseVNodeï¼šæä¾›äº†çˆ¶èŠ‚ç‚¹çš„ç±»å‹\nnormalizeChildrenï¼šæä¾›äº†å­èŠ‚ç‚¹çš„ç±»å‹å’Œå½¢çŠ¶\n\nç»„ä»¶Componenté¦–å…ˆè¦æ˜ç¡®ä¸€ä¸ªé—®é¢˜ï¼šåœ¨Vueä¸­ï¼Œç»„ä»¶çš„æœ¬è´¨æ˜¯å¯¹è±¡&#x2F;å‡½æ•°\næ‰€ä»¥å®é™…ä¸Šåœ¨Vueä¸­å†™çš„ç»„ä»¶ï¼Œå¦‚æœéœ€è¦æ¸²æŸ“çš„è¯ï¼Œè¦ç”¨å¯¹è±¡åŒ…è£¹ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªrenderæ–¹æ³•\n12345678910const component = &#123;  render() &#123;    const vnode1 = h(&quot;div&quot;, &quot;this is component&quot;);    return vnode1;  &#125;,&#125;;const vnode2 = h(component);render(vnode2, document.querySelector(&#x27;#app&#x27;));\n\næŒ‰ç…§ä¹‹å‰çš„hå‡½æ•°å®ç°å’Œç†è§£ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥åœ¨componentçš„renderä¸­ç›´æ¥è¿”å›ä¸€ä¸ªVNodeå¯¹è±¡ï¼Œrenderæ–¹æ³•ç›´æ¥ç»™ä¸€ä¸ªVNodeå¯¹è±¡ï¼Œä¹Ÿèƒ½è¾¾åˆ°ä¸€æ ·çš„æ•ˆæœï¼Œä¸»è¦çš„æ³¨æ„ç‚¹å°±æ˜¯shapeFlagå€¼è¦ä¿æŒå’Œæºç ä¸€è‡´\n12345678910111213141516const component = &#123;  render() &#123;    return &#123;      v__is_vnode: true,      type: &quot;div&quot;,      children: &quot;this is component&quot;,      shapeFlag: 9    &#125;  &#125;&#125;render(&#123;  v__is_vnode: true,  type: component,  shapeFlag: 4&#125;, document.querySelector(&#x27;#app&#x27;));\n\næ‰€ä»¥åªéœ€è¦æ³¨æ„å¤„ç†ä¸€ä¸‹typeå’ŒshapeFlagå€¼ï¼Œå°±å¯ä»¥å®Œæˆç»„ä»¶componentçš„hå‡½æ•°äº†ï¼Œåªè¦åœ¨createVNodeä¸­ä¿®æ”¹ä¸€è¡Œå³å¯\n12345678910function createVNode(type, props, children): VNode &#123;  ......  const shapeFlag = isString(type)    ? ShapeFlags.ELEMENT    : isObject(type)    ? ShapeFlags.STATEFUL_COMPONENT    : 0;  ......&#125;\n\næŒ‰ç…§ä¹‹å‰çš„ä»£ç ï¼Œæœ€åç”Ÿæˆçš„VNodeé‡Œçš„childrenä¼šå˜æˆâ€undefinedâ€ï¼Œå…¶å®æ˜¯normalizeChildrené‡Œé¢çš„åˆ¤æ–­æ¡ä»¶è¿‡äºä¸¥è‹›äº†ï¼ŒæŠŠ===æ”¹æˆ==å³å¯\n1234567function normalizeChildren(vnode: VNode, children: unknown) &#123;  ......  if (children == null) &#123;    children = null;  &#125;  ......&#125;\n\nå…¶ä»–ä¸€äº›ç®€å•èŠ‚ç‚¹è¿™é‡Œçš„ç®€å•èŠ‚ç‚¹åŒ…æ‹¬ï¼š\n\nçº¯æ–‡æœ¬Text\næ³¨é‡ŠComment\nç‰‡æ®µFragment\n\næŸ¥çœ‹æºç å¯ä»¥å‘ç°ï¼Œç”¨hå‡½æ•°æ„å»ºçš„è¿™äº›èŠ‚ç‚¹çš„typeéƒ½æ˜¯Symbolç±»å‹ï¼ŒshapeFlagéƒ½æ˜¯8\n12345const vnodeText = h(Text, &quot;this is text&quot;);const vnodeComment = h(Comment, &quot;this is comment&quot;);const vnodeFragment = h(Fragment, &quot;this is fragment&quot;);\n\nç›¸æ¯”äºä¹‹å‰çš„ä»£ç ï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘typeçš„é—®é¢˜ï¼Œè¿™é‡Œç›´æ¥åˆ›å»ºå‡ ä¸ªå¸¸é‡å¤„ç†å³å¯\n123export const Fragment = Symbol(&quot;Fragment&quot;);export const Text = Symbol(&quot;Text&quot;);export const Comment = Symbol(&quot;Comment&quot;);\n\nå¤„ç†å®Œä¹‹åï¼Œhå‡½æ•°å¯¹è¿™äº›ç®€å•èŠ‚ç‚¹çš„è¾“å‡ºå°±å’Œæºç æ ¸å¿ƒä¿æŒä¸€è‡´äº†\nclasså’Œstyleçš„å¢å¼ºå¤„ç†Vueä¸­å¯¹classå’Œstyleï¼Œæ”¯æŒä½¿ç”¨æ•°ç»„&#x2F;å¯¹è±¡ï¼ŒåŠ¨æ€ç»‘å®šå€¼\n12345const vnode = h(&#x27;div&#x27;, &#123;  class: &#123;    &#x27;red&#x27;: true  &#125;&#125;, &#x27;improve class&#x27;);\n\næŒ‰ç…§ä¸Šé¢çš„ä»£ç ï¼Œå¯ä»¥æ‹¿åˆ°ä¸€ä¸ªå¸¦æœ‰classä¸ºredçš„div\né˜…è¯»æºç å¾—çŸ¥ï¼Œè¿™ä¸ªå¢å¼ºå¤„ç†éœ€è¦æ·»åŠ ä¸€ä¸ªnormalizeClassæ–¹æ³•ï¼Œæ–¹æ³•æœ¬è´¨ä¸Šä¹Ÿæ˜¯å¯¹classå¯¹è±¡åšä¸€ä¸ªéå†ï¼Œé’ˆå¯¹string&#x2F;array&#x2F;objectåšä¸åŒçš„å¤„ç†æ–¹å¼ï¼Œæœ€åæ‹¼æ¥æˆstring\n123456789101112131415161718192021222324252627282930313233function normalizeClass(value: unknown): string &#123;  let res = &quot;&quot;;  if (isString(value)) &#123;    res = value;  &#125; else if (isArray(value)) &#123;    for (let i = 0; i &lt; value.length; i++) &#123;      const normalized = normalizeClass(value[i]);      if (normalized) &#123;        res += normalized + &quot; &quot;;      &#125;    &#125;  &#125; else if (isObject(value)) &#123;    for (const name in value as object) &#123;      if ((value as object)[name]) &#123;        res += name + &quot; &quot;;      &#125;    &#125;  &#125;  return res.trim();&#125;function createVNode(type, props, children): VNode &#123;  if (props) &#123;    let &#123; class: klass, style &#125; = props;    if (klass &amp;&amp; !isString(klass)) &#123;      props.class = normalizeClass(klass);    &#125;  &#125;  ......&#125;\n\nstyleçš„å¤„ç†é€»è¾‘ä¸Šå’Œclassä¸€è‡´\n","slug":"Vue3æºç â€”â€”hå‡½æ•°","date":"2024-10-12T06:57:10.000Z","categories_index":"Vue3","tags_index":"Vue3","author_index":"æƒæ ˆ"},{"id":"a4c1e6f4a7d260a2971f3f08fe46eea6","title":"Vue3.5 useId","content":"useIdçš„ä½œç”¨ä»–çš„ä½œç”¨ä¹Ÿæ˜¯ç”Ÿæˆå”¯ä¸€IDï¼ŒåŒä¸€ä¸ªVueåº”ç”¨é‡Œé¢æ¯æ¬¡è°ƒç”¨useIdç”Ÿæˆçš„IDéƒ½ä¸åŒã€‚\nä½¿ç”¨æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œä»£ç å¦‚ä¸‹ï¼š\n123456789101112&lt;script setup lang=&quot;ts&quot;&gt;import &#123; useId &#125; from &#x27;vue&#x27;const id0 = useId();console.log(id0); // v-0const id1 = useId();console.log(id1); // v-1const id2 = useId();console.log(id2); // v-2&lt;/script&gt;\n\nuseIdæ˜¯å¦‚ä½•å®ç°çš„æ¥çœ‹çœ‹useIdçš„æºç ï¼Œéå¸¸ç®€å•ï¼ï¼ç®€åŒ–åçš„ä»£ç å¦‚ä¸‹ï¼š\n12345678function useId(): string &#123;  const i = getCurrentInstance()  if (i) &#123;    return (i.appContext.config.idPrefix || &#x27;v&#x27;) + &#x27;-&#x27; + i.ids[0] + i.ids[1]++  &#125;  return &#x27;&#x27;&#125;\n\næ€»ç»“ç”Ÿæˆçš„IDåˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š\n\nç¬¬ä¸€éƒ¨åˆ†ä¸ºå‰ç¼€ï¼šapp.config.idPrefixï¼Œå¦‚æœæ²¡æœ‰é…ç½®ï¼Œé‚£ä¹ˆå°±æ˜¯å­—ç¬¦ä¸²vã€‚\n\nç¬¬äºŒéƒ¨åˆ†å­—ç¬¦ä¸²ï¼š-ã€‚\n\nç¬¬ä¸‰éƒ¨åˆ†çš„å€¼ä¸ºä¸€ä¸ªè‡ªå¢çš„æ•°å­—ï¼Œå­˜åœ¨vueå®ä¾‹ä¸Šé¢çš„idså±æ€§ï¼Œæ‰€æœ‰çš„vueå®ä¾‹ä¸Šé¢çš„idså±æ€§éƒ½æ˜¯æŒ‡å‘åŒä¸€ä¸ªæ•°ç»„ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆè¯´useIdå¯ä»¥åœ¨Vueåº”ç”¨å†…ç”Ÿæˆå”¯ä¸€çš„IDï¼Œè€Œä¸æ˜¯åœ¨Vueç»„ä»¶å†…ç”Ÿæˆå”¯ä¸€çš„IDã€‚\n\n\n","slug":"Vue3.5 useId","date":"2024-09-27T07:14:20.000Z","categories_index":"Vue3","tags_index":"Vue3","author_index":"æƒæ ˆ"},{"id":"56ce95bec0e493691d1f055dfbf1898e","title":"å‰ç«¯ä¼˜åŒ–é¦–æ¬¡åŠ è½½é€Ÿåº¦","content":"compression-webpack-plugincompression-webpack-plugin æ˜¯ä¸€ä¸ª Webpack æ’ä»¶ï¼Œç”¨äºå‹ç¼©ç”Ÿæˆçš„é™æ€æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨ Gzip æˆ– Brotli å‹ç¼©æ ¼å¼ã€‚è¿™æœ‰åŠ©äºå‡å°æ–‡ä»¶å¤§å°ï¼Œä»è€Œæé«˜ç½‘é¡µåŠ è½½é€Ÿåº¦å’Œæ€§èƒ½ã€‚\nclean-webpack-pluginclean-webpack-plugin æ˜¯ä¸€ä¸ª Webpack æ’ä»¶ï¼Œç”¨äºåœ¨æ¯æ¬¡æ„å»ºå‰è‡ªåŠ¨æ¸…ç†è¾“å‡ºç›®å½•ï¼ˆå¦‚ dist æ–‡ä»¶å¤¹ï¼‰ï¼Œä»¥ç¡®ä¿æ–°æ„å»ºçš„æ–‡ä»¶æ˜¯æœ€æ–°çš„ï¼Œé¿å…é—ç•™æ—§æ–‡ä»¶ã€‚\nterser-webpack-pluginterser-webpack-plugin æ˜¯ä¸€ä¸ª Webpack æ’ä»¶ï¼Œç”¨äºå‹ç¼©å’Œæ··æ·† JavaScript ä»£ç ï¼Œé€šå¸¸åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚å®ƒåŸºäº Terser å·¥å…·ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°å‡å°‘ JavaScript æ–‡ä»¶çš„ä½“ç§¯ï¼Œä»è€Œæé«˜ç½‘é¡µåŠ è½½é€Ÿåº¦ã€‚\nhtml-webpack-pluginhtml-webpack-plugin æ˜¯ä¸€ä¸ª Webpack æ’ä»¶ï¼Œç”¨äºç®€åŒ–ç”Ÿæˆ HTML æ–‡ä»¶çš„è¿‡ç¨‹ï¼Œé€šå¸¸ç”¨äºå°†æ‰“åŒ…çš„ JavaScript å’Œ CSS æ–‡ä»¶è‡ªåŠ¨æ³¨å…¥åˆ° HTML æ¨¡æ¿ä¸­ã€‚\n@vue&#x2F;preload-webpack-plugin@vue&#x2F;preload-webpack-plugin æ˜¯ä¸€ä¸ª Webpack æ’ä»¶ï¼Œä¸»è¦ç”¨äºä¼˜åŒ– Vue åº”ç”¨çš„èµ„æºåŠ è½½æ€§èƒ½ã€‚å®ƒå¯ä»¥è‡ªåŠ¨æ·»åŠ   æ ‡ç­¾åˆ°ç”Ÿæˆçš„ HTML æ–‡ä»¶ä¸­ï¼Œä»¥ä¾¿æµè§ˆå™¨é¢„åŠ è½½å…³é”®èµ„æºï¼ˆå¦‚ JavaScript å’Œ CSS æ–‡ä»¶ï¼‰ã€‚\nvue.config æ–‡ä»¶\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172const path = require(&quot;path&quot;);const px2rem = require(&quot;postcss-px2rem&quot;);const postcss = px2rem(&#123;  remUnit: 37.5, // åŸºå‡†å¤§å° baseSizeï¼Œéœ€è¦å’Œrem.jsä¸­ç›¸åŒ&#125;);let productionGzipExtensions = /\\.(js|css|json|txt|html|ico|svg)(\\?.*)?$/i;const CompressionPlugin = require(&quot;compression-webpack-plugin&quot;);const &#123; CleanWebpackPlugin &#125; = require(&quot;clean-webpack-plugin&quot;); // ç”¨äºåœ¨æ¯æ¬¡æ„å»ºå‰æ¸…ç† /dist æ–‡ä»¶å¤¹const TerserPlugin = require(&quot;terser-webpack-plugin&quot;); // ç”¨äºå‹ç¼© JavaScript ä»£ç const &#123; BundleAnalyzerPlugin &#125; = require(&quot;webpack-bundle-analyzer&quot;); //const HtmlWebpackPlugin = require(&quot;html-webpack-plugin&quot;);const PreloadPlugin = require(&quot;@vue/preload-webpack-plugin&quot;);require(&quot;events&quot;).EventEmitter.defaultMaxListeners = 0;module.exports = &#123;  // è·¯å¾„å‰ç¼€  publicPath: process.env.VUE_APP_PUBLICPATH,  assetsDir: &quot;static&quot;,  // æ˜¯å¦å¯ç”¨ eslint-loader åœ¨ä¿å­˜æ—¶æ£€æŸ¥ä»£ç   lintOnSave: true,  // æ˜¯å¦ç”Ÿæˆ source map æ–‡ä»¶ï¼Œç”Ÿäº§ç¯å¢ƒå¯ä»¥å…³é—­ä»¥æå‡æ‰“åŒ…é€Ÿåº¦  productionSourceMap: process.env.NODE_ENV == &quot;development&quot;,  // æ‰©å±• webpack-chain é…ç½®ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ– Webpack é…ç½®  chainWebpack: (config) =&gt; &#123;    // å¿½ç•¥çš„æ‰“åŒ…æ–‡ä»¶    config.externals(&#123;      vue: &quot;Vue&quot;,      &quot;vue-router&quot;: &quot;VueRouter&quot;,      vuex: &quot;Vuex&quot;,      axios: &quot;axios&quot;,      &quot;element-ui&quot;: &quot;ELEMENT&quot;,    &#125;);    // é…ç½®å…¥å£æ–‡ä»¶    const entry = config.entry(&quot;app&quot;);    entry.add(&quot;babel-polyfill&quot;).end();    entry.add(&quot;classlist-polyfill&quot;).end();    entry.add(&quot;@/mock&quot;).end();    // // é…ç½®é¢„åŠ è½½å’Œé¢„å–ï¼Œä¼˜åŒ–åŠ è½½æ€§èƒ½    // config.plugin(&quot;preload&quot;).tap((options) =&gt; &#123;    //   options[0].fileBlacklist.push(/\\.map$/, /hot-update\\.js$/);    //   return options;    // &#125;);    // ç§»é™¤ prefetch æ’ä»¶ï¼Œé¿å…åŠ è½½ä¸å¿…è¦çš„èµ„æº    // config.plugins.delete(&quot;prefetch&quot;);  &#125;,  // é…ç½® Webpack  configureWebpack: (config) =&gt; &#123;    const plugins = [      new CleanWebpackPlugin(),      new HtmlWebpackPlugin(&#123;        filename: &quot;index.html&quot;,        template: &quot;public/index.html&quot;,        inject: true,        templateParameters: &#123;          BASE_URL: &quot;/&quot;, // ä¼ é€’ BASE_URL åˆ°æ¨¡æ¿        &#125;,      &#125;),      new PreloadPlugin(&#123;        rel: &quot;preload&quot;,        include: &quot;initial&quot;,        fileBlacklist: [/\\.map$/, /hot-update\\.js$/, /vendor\\..*\\.js$/],        // æ ¹æ®éœ€è¦è¿›è¡Œæ›´å¤šé…ç½®      &#125;),    ];    if (      process.env.NODE_ENV === &quot;production&quot; ||      process.env.NODE_ENV === &quot;test&quot;    ) &#123;      plugins.push(        new CompressionPlugin(&#123;          filename: &quot;[path][base].gz&quot;,          algorithm: &quot;gzip&quot;,          test: productionGzipExtensions,          threshold: 10240,          minRatio: 0.8,          deleteOriginalAssets: false,          // exclude: /(cdn|util)\\/.*\\.(js|css|json|txt|html|ico|svg)$/i,        &#125;),        new BundleAnalyzerPlugin(&#123;          analyzerMode: &quot;static&quot;,          reportFilename: &quot;bundle-report.html&quot;,          openAnalyzer: true,        &#125;)      );      config.optimization = &#123;        minimize: true,        minimizer: [          new TerserPlugin(&#123;            terserOptions: &#123;              compress: &#123;                drop_console: true,                drop_debugger: true,              &#125;,              output: &#123;                comments: false,              &#125;,            &#125;,            parallel: true,          &#125;),        ],        splitChunks: &#123;          // Uncomment this block if needed          chunks: &quot;all&quot;,          maxInitialRequests: 5,          minSize: 30000,          maxSize: 250000,          cacheGroups: &#123;            vendor: &#123;              test: /[\\\\/]node_modules[\\\\/]/,              name(module) &#123;                const packageName = module.context.match(                  /[\\\\/]node_modules[\\\\/](.*?)([\\\\/]|$)/                )[1];                return `npm.$&#123;packageName.replace(&quot;@&quot;, &quot;&quot;)&#125;`;              &#125;,              priority: -10,            &#125;,            common: &#123;              name: &quot;common&quot;,              minChunks: 2,              priority: -20,              reuseExistingChunk: true,              chunks: &quot;all&quot;,            &#125;,          &#125;,        &#125;,      &#125;;    &#125; else if (process.env.NODE_ENV === &quot;development&quot;) &#123;      config.devtool = &quot;source-map&quot;;    &#125;    config.plugins.push(...plugins);  &#125;,  css: &#123;    extract: &#123; ignoreOrder: true &#125;,    loaderOptions: &#123;      postcss: &#123;        plugins: [postcss],      &#125;,    &#125;,  &#125;,  transpileDependencies: [&quot;ol&quot;],  // å¼€å‘æ¨¡å¼åå‘ä»£ç†é…ç½®ï¼Œç”Ÿäº§æ¨¡å¼è¯·ä½¿ç”¨Nginxéƒ¨ç½²å¹¶é…ç½®åå‘ä»£ç†  devServer: &#123;    port: 1888,    proxy: &#123;      &quot;/api&quot;: &#123;        // æœ¬åœ°æœåŠ¡æ¥å£åœ°å€        target: process.env.VUE_APP_BASE_API_COMMON_URL,        // è¿œç¨‹æ¼”ç¤ºæœåŠ¡åœ°å€, å¯ç”¨äºç›´æ¥å¯åŠ¨é¡¹ç›®        // target: &#x27;https://saber.bladex.vip/api&#x27;,        ws: true,        pathRewrite: &#123;          &quot;^/api&quot;: &quot;/&quot;,        &#125;,      &#125;,    &#125;,  &#125;,  // é€šè¿‡ç¯å¢ƒå˜é‡æ§åˆ¶æ˜¯å¦å¯ç”¨æ€§èƒ½æç¤º  //  performance: &#123;  //   hints: (process.env.NODE_ENV === &#x27;production&#x27; || process.env.NODE_ENV === &#x27;test&#x27;) ? &#x27;warning&#x27; : false  // &#125;&#125;;\n\nä¿®æ”¹æµ‹è¯•ç¯å¢ƒé…ç½®NODE_ENV æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œç”¨äºæŒ‡ç¤º Node.js åº”ç”¨ç¨‹åºçš„è¿è¡Œç¯å¢ƒã€‚å®ƒé€šå¸¸æœ‰ä¸‰ä¸ªä¸»è¦å€¼ï¼š development ã€ production å’Œ test ã€‚\nåªæœ‰ production ç”Ÿæˆç¯å¢ƒæ‰ä¼šå‹ç¼©æ–‡ä»¶ å¦‚æœæ˜¯ NODE_ENV&#x3D;test æ”¹æˆ NODE_ENV&#x3D;production\n\nä¿®æ”¹åŠ¨æ€è·¯ç”±æ‡’åŠ è½½æ–¹å¼\nåŠ è½½æ—¶æœºï¼š\nrequireï¼šåŒæ­¥åŠ è½½ï¼Œè¿è¡Œæ—¶å†³å®šã€‚\nimportï¼šå¼‚æ­¥åŠ è½½ï¼Œç¼–è¯‘æ—¶ç¡®å®šã€‚\n\n\nä½œç”¨åŸŸï¼š\nrequireï¼šåœ¨æ¨¡å—å†…éƒ¨ï¼Œä½œç”¨åŸŸè¾ƒå°é—­ã€‚\nimportï¼šæ”¯æŒå‘½åå¯¼å…¥å’Œé»˜è®¤å¯¼å…¥ï¼Œçµæ´»æ€§æ›´é«˜ã€‚\n\n\nç¯å¢ƒï¼š\nrequireï¼šä¸»è¦ç”¨äº Node.jsã€‚\nimportï¼šé€‚ç”¨äºç°ä»£æµè§ˆå™¨å’Œæ”¯æŒ ES6 çš„ç¯å¢ƒã€‚\n\n\n\n\n","slug":"å‰ç«¯ä¼˜åŒ–é¦–æ¬¡åŠ è½½é€Ÿåº¦","date":"2024-09-20T07:08:20.000Z","categories_index":"Vue2","tags_index":"Vue2","author_index":"æƒæ ˆ"},{"id":"d5edacab67506b18e45fcb0990be9618","title":"å‰ç«¯å¤§å±è‡ªé€‚åº”æ–¹æ¡ˆ","content":"æ˜“ç”¨ ğŸš€è°ƒç”¨ä»…éœ€ä¸€è¡Œä»£ç ï¼Œå³å¯é€‚é…è®¾ç½®åˆ†è¾¨ç‡ä»¥ä¸‹çš„æ‰€æœ‰å±å¹•ï¼Œæ— éœ€ä»»ä½•å…¶ä»–è¾…åŠ©\næ€§èƒ½ âš¡åªå½±å“ä¸€ä¸ªå…ƒç´ æ ·å¼ï¼Œè®¡ç®—é‡æå°\nçµæ´» ğŸ’¥å¯ä»¥ç»™é¡¹ç›®å…¨å±€è‡ªé€‚åº”ï¼Œä¹Ÿå¯ä»¥å•ç‹¬é¡µé¢åšè‡ªé€‚åº”\nåŸç†å³åœ¨ scale ç­‰æ¯”ç¼©æ”¾çš„åŸºç¡€ä¸Šï¼Œè·å–å±å¹•çš„å®½åº¦é™¤ä»¥è®¾è®¡ç¨¿çš„å®½åº¦ï¼Œè·å–åˆ°å®½åº¦æ¯”ä¾‹å€¼ï¼›è·å–å±å¹•çš„é«˜åº¦é™¤ä»¥è®¾è®¡ç¨¿çš„é«˜åº¦ï¼Œè·å–åˆ°é«˜åº¦æ¯”ä¾‹å€¼ï¼›ä½¿ç”¨ transform: scale(x, x) åŠ¨æ€ç›‘å¬æ¥å®ç°é¡µé¢çš„ç¼©æ”¾æ¯”ä¾‹ï¼Œä»è€Œè¿˜åŸ UI å›¾æ•ˆæœã€‚è¿™å¯ä»¥æ”¯æŒè®¾è®¡ç¨¿ä»¥ä¸‹çš„å„ç§åˆ†è¾¨ç‡ã€‚\nä½¿ç”¨ä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253* æ ¹æ®è§†å£å°ºå¯¸è°ƒæ•´ç»™å®šå…ƒç´ çš„ç¼©æ”¾æ¯”ä¾‹ã€‚ * @param &#123;HTMLElement&#125; e - è¦è°ƒæ•´çš„å…ƒç´ ã€‚ * @param &#123;number&#125; planWidth - å…ƒç´ çš„è®¡åˆ’å®½åº¦,é»˜è®¤1980pxã€‚ * @param &#123;number&#125; planHeight - å…ƒç´ çš„è®¡åˆ’é«˜åº¦,é»˜è®¤1080pxã€‚ */    function selfAdaption(e, planWidth = 1980, planHeight = 1080) &#123;      /**       * è·å–å®¢æˆ·ç«¯è§†å£çš„å½“å‰å°ºå¯¸ï¼Œå¹¶æ ¹æ®æœ€å°è®¡åˆ’å°ºå¯¸è¿›è¡Œè°ƒæ•´ã€‚       * @returns &#123;&#123;width: number, height: number&#125;&#125; å®¢æˆ·ç«¯è§†å£çš„è°ƒæ•´åå®½åº¦å’Œé«˜åº¦ã€‚       */      console.log(planWidth, planHeight);      const getClientDimensions = () =&gt; &#123;        // è·å–å®¢æˆ·ç«¯è§†å£çš„å½“å‰å®½åº¦å’Œé«˜åº¦        let width = document.body.clientWidth || document.documentElement.clientWidth;        let height = document.body.clientHeight || document.documentElement.clientHeight;        // å¦‚æœè®¡åˆ’é«˜åº¦å°äº1080ï¼Œåˆ™è¿›è¡Œé«˜åº¦è°ƒæ•´        if (planHeight &lt; 1080) &#123;          height -= (1080 - planHeight);        &#125;        // å¦‚æœè®¡åˆ’å®½åº¦å°äº1920ï¼Œåˆ™è¿›è¡Œå®½åº¦è°ƒæ•´        if (planWidth &lt; 1920) &#123;          width -= (1920 - planWidth);        &#125;        return &#123; width, height &#125;;      &#125;;      /**       * æ ¹æ®å½“å‰è§†å£å°ºå¯¸æ›´æ–°å…ƒç´ çš„ç¼©æ”¾æ¯”ä¾‹ã€‚       */      const updateScale = () =&gt; &#123;        // è·å–è°ƒæ•´åçš„å®¢æˆ·ç«¯å°ºå¯¸        const &#123; width, height &#125; = getClientDimensions();        // è®¡ç®—å®½åº¦å’Œé«˜åº¦çš„ç¼©æ”¾æ¯”ä¾‹        const ratioWidth = width / planWidth;        const ratioHeight = height / planHeight;        // å¯¹å…ƒç´ åº”ç”¨ç¼©æ”¾å˜æ¢        e.style.transform = `scale($&#123;ratioWidth&#125;, $&#123;ratioHeight&#125;)`;      &#125;;      // è®¾ç½®å…ƒç´ çš„åˆå§‹æ ·å¼      e.style.cssText += `    transform-origin: 0 0 0;    display: flex;    min-width: auto;    min-height: auto;    overflow: hidden;    width: $&#123;planWidth&#125;px;    height: $&#123;planHeight&#125;px;  `;      // åˆå§‹æ›´æ–°ç¼©æ”¾æ¯”ä¾‹      updateScale();      // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼Œåœ¨çª—å£è°ƒæ•´å¤§å°æ—¶æ›´æ–°ç¼©æ”¾æ¯”ä¾‹      window.addEventListener(&#x27;resize&#x27;, updateScale);    &#125;selfAdaptionï¼ˆeï¼‰ä¼ é€’çš„è¦è‡ªé€‚åº”æœ€å¤–å±‚dom\n\n\n\n\n\n\n\n\n\n\nä½¿ç”¨ transform: scale è‡ªé€‚åº”åï¼Œåœ°å›¾ä¸Šç‚¹å‡»äº‹ä»¶å¤±æ•ˆï¼Œè§£å†³åŠæ³•ï¼š\n12345678910resetMapSize() &#123;Â Â       let mapContent = document.getElementById(&quot;map&quot;);Â Â       mapContent.style.transform = `scale($&#123;1 / ratioWidth&#125;,$&#123;1 / ratioHeight&#125;)`Â Â     &#125;Â Â // ç”¨å®Œåè®°å¾—é”€æ¯ç›‘å¬äº‹ä»¶ æ¯”å¦‚ vue ä¸­Â Â destroyed () &#123;Â Â     window.removeEventListener(&#x27;resize&#x27;,this.resetMapSize)Â Â   &#125;Â \n","slug":"å‰ç«¯å¤§å±è‡ªé€‚åº”æ–¹æ¡ˆ","date":"2024-09-12T02:58:20.000Z","categories_index":"JS","tags_index":"JS","author_index":"æƒæ ˆ"},{"id":"32c8c23c6d89385feba3d0e7e602221c","title":"Vue3.5 æºç è§£æï¼Œ useTemplateRef å®ç°åŸç†","content":"useTemplateRef çš„ä½œç”¨useTemplateRef æ˜¯ç”¨æ¥ä¸“é—¨è·å– dom æˆ–è€… ç»„ä»¶ç¤ºä¾‹ çš„ã€‚\nåœ¨ä¹‹å‰ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è·å– dom ï¼Œé‚£ä¹ˆéœ€è¦è¿™ä¹ˆåšï¼š\n\nå…ˆä¸º dom æŒ‡å®š ref å±æ€§ï¼Œå¹¶ä¸”ç»™å®šä¸€ä¸ª value å€¼\n\nåœ¨ js ä¸­ï¼Œå£°æ˜ value å€¼çš„å˜é‡ï¼Œå¹¶ä¸”ç»™å®šåˆå§‹å€¼ä¸º ç©ºçš„ ref\n12345678910&lt;script setup&gt;// é¦–å…ˆï¼Œæ‚¨å®šä¹‰äº†ä¸€ä¸ªå€¼ä¸ºundefinedæˆ–ç©ºçš„ref// å¹¶ä»¥æ‚¨æƒ³è¦çš„æ–¹å¼å‘½åç”Ÿæˆçš„å¯ç”¨å†…å®¹const divEl = ref();&lt;/script&gt;&lt;template&gt;&lt;!-- ç„¶åä½¿ç”¨ä¸â€œrefâ€å±æ€§çš„å€¼ç›¸åŒçš„åç§°,åœ¨æ¨¡æ¿ä¸­çš„æŸä¸ªåœ°æ–¹ --&gt;&lt;div ref=&quot;divEl&quot; &gt;&lt;/div&gt;&lt;/template&gt;\n\nä½†æ˜¯ï¼Œè¿™ç§æ–¹æ¡ˆå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯ï¼šref é€šå¸¸ç”¨æ¥å£°æ˜å“åº”å¼æ•°æ®ã€‚å½“ ref ä¸å…‰ä½œä¸ºå“åº”å¼å£°æ˜ï¼Œè¿˜è¢«ä½œä¸º dom å®ä¾‹çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±éš¾å…æœ‰ç‚¹è®©äººç–‘æƒ‘äº†ã€‚\næ‰€ä»¥åœ¨ï¼ˆ3.5 ä¹‹åï¼‰ Vue æ¨å‡ºäº†ä¸€ä¸ªæ–°çš„ API å«åš useTemplateRef æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š\n123456789101112131415&lt;template&gt; &lt;div&gt;  &lt;div ref=&quot;el&quot;&gt;ç¨‹åºå‘˜Sunday&lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;import &#123; onMounted, useTemplateRef &#125; from &#x27;vue&#x27;const elRef = useTemplateRef(&#x27;el&#x27;)onMounted(() =&gt; &#123; console.log(elRef.value) // dom ç¤ºä¾‹&#125;)&lt;/script&gt;\n\nuseTemplateRef çš„å®ç°åŸç†1234567891011121314export function useTemplateRef(key: Keys) &#123;  const i = getCurrentInstance();  const r = shallowRef(null);  if (i) &#123;    const refs = i.refs === EMPTY_OBJ ? (i.refs = &#123;&#125;) : i.refs;    Object.defineProperty(refs, key, &#123;      enumerable: true,      get: () =&gt; r.value,      set: (val) =&gt; (r.value = val),    &#125;);  &#125;  return r;&#125;\n\nç¬¬ä¸€ä¸ª iï¼šé€šè¿‡ getCurrentInstance() è·å–ï¼Œå¾—åˆ°çš„æ˜¯ ä¸Šä¸‹æ–‡å®ä¾‹ã€‚â€‹ æ¥ä¸‹æ¥ï¼Œé€šè¿‡ i.refs è·å–åˆ°æ‰€æœ‰çš„ ref æ•°æ®ï¼Œç„¶åä¸º refs æ·»åŠ  Object.defineProperty çš„ç›‘å¬ï¼Œç›‘å¬çš„å±æ€§åå°±æ˜¯å…¥å‚ keyã€‚å¦‚æœä»¥ useTemplateRef(â€˜elâ€™) ä¸ºä¾‹ï¼Œé‚£ä¹ˆå°±æ˜¯ â€œelâ€ã€‚\né€šè¿‡ç›‘å¬å¯¹åº” key çš„ get å’Œ set æ ‡è®°ï¼Œè¿™é‡Œ é‡ç‚¹å…³æ³¨ set æ ‡è®°ï¼Œåœ¨è¿™é‡Œä¸º r.value è¿›è¡Œäº†èµ‹å€¼ï¼Œå³ï¼šr.value &#x3D; valã€‚è¿™é‡Œçš„ val å°±æ˜¯ refs[key] çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„ ref ç»„ä»¶å®ä¾‹ã€‚\nç¬¬äºŒä¸ª rï¼šé€šè¿‡ shallowRef(null) è·å–ï¼Œä½œä¸ºè¿”å›å€¼r ä½œä¸º useTemplateRef çš„è¿”å›å€¼å³ æœ€ç»ˆè·å–çš„ç»„ä»¶ç¤ºä¾‹ã€‚\n","slug":"Vue3.5 æºç è§£æï¼Œ useTemplateRef å®ç°åŸç†","date":"2024-09-06T06:07:04.000Z","categories_index":"Vue3","tags_index":"Vue3","author_index":"æƒæ ˆ"},{"id":"c34479c7fc43ef2eede71b250f18b4aa","title":"refå’ŒreactiveåŸç†","content":"refref çš„å¤„ç†ä¸Šå°±æ˜¯å…ˆå°†åŸºæœ¬ç±»å‹è½¬æ¢æˆå¯¹è±¡ç±»å‹ï¼Œç„¶ååœ¨é‡Œé¢åŠ å…¥ä¸€ä¸ª this._v_isRef çš„å¸ƒå°”ç±»å‹çš„å€¼ï¼Œæ¥åˆ¤æ–­å®ƒæ˜¯ä¸æ˜¯è¢« ref å¤„ç†äº†ï¼Œç„¶åå°†ä¸Šé¢å†™çš„ track å’Œ trigger å‡½æ•°å†™å…¥ get å’Œ set å‡½æ•°é‡Œé¢ï¼Œå¦‚æœä½ è¦å¤„ç†çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆ vue3 å°±ä¼šæŠŠå®ƒæ”¹æˆ reactive çš„å¤„ç†æ–¹å¼ã€‚æ‰€ä»¥è¯´ï¼Œref å¯ä»¥å¤„ç†åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹ï¼Œè€Œ reactive å¤„ç†çš„æ˜¯å¼•ç”¨ç±»å‹ï¼ŒäºŒè€…çš„åŒºåˆ«ä¸æ˜¯å¾ˆå¤§ã€‚\nreactive\né¦–å…ˆæˆ‘ä»¬å–ä¸€ä¸ªå¯¹è±¡{a: 1}\n\nç„¶åè°ƒç”¨å°è£…å¥½çš„ reactive å‡½æ•° const state &#x3D; reactive({a: 1})\n\nè¿™ä¸ªæ—¶å€™å°±ä¼šè¿›å…¥ä»£ç ç‰‡æ®µ 1.1 é‡Œé¢çš„ reactive å‡½æ•°ï¼Œåœ¨è¿›å…¥ createReactiveObject å‡½æ•°\n\nç„¶åå°±ä¼šå¯¹æˆ‘ä»¬è¦ä»£ç†çš„å¯¹è±¡è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ˜¯å¯¹è±¡çš„è¯å°±ç»§ç»­ä¸‹å»\n\nåœ¨åˆ¤æ–­æˆ‘ä»¬æ˜¯ä¸æ˜¯å·²ç»ä»£ç†è¿‡è¿™ä¸ªå¯¹è±¡ï¼ˆå°±æ˜¯æˆ‘ä»¬é¢„å…ˆç©ºå‡ºä¸€ä¸ªä½ç½®ï¼Œå°†å·²ç»ä»£ç†è¿‡çš„å¯¹è±¡å…¨éƒ¨å­˜å‚¨ä¸‹æ¥ï¼‰ï¼Œä»£ç†è¿‡å°±è¿”å›ä»£ç†åçš„å€¼ï¼Œæ²¡æœ‰çš„è¯å°±åˆ›å»ºä¸€ä¸ªæ–°çš„ä»£ç†\n\nå†ç„¶åç»‘å®šä¸Š proxy å‡½æ•°é‡Œé¢çš„ get å’Œ set å›è°ƒå‡½æ•°ï¼ˆå¯ä»¥çœ‹åˆ°ä»£ç  1.2ï¼‰\n\n\n","slug":"refå’ŒreactiveåŸç†","date":"2024-08-27T08:30:20.000Z","categories_index":"Vue3","tags_index":"Vue3","author_index":"æƒæ ˆ"},{"id":"2e839452302506867eaaf60fd116d0d6","title":"vue3 Api","content":"defineProps()å’Œ defineEmits()\nv-model:childValueModel ä¿®æ”¹äº†å€¼ æœ¬æ¥åº”è¯¥æ˜¯ modeValue\ndefineEmites() ä½¿ç”¨è¦æ·»åŠ  update:\n1&lt;defineModelChild v-model;childValueModel=&quot;childValue&quot;&gt;&lt;/defineModelChild&gt;\n\nâ€‹\n123456789&lt;template&gt;&lt;div&gt;&#123;&#123; childValueModel &#125;&#125;&lt;/div&gt;&lt;button @click=&quot;myEmits(&#x27;update:childValueModel&#x27;, childValueModel + 1)&quot;&gt;æ•°æ® + 1&lt;/button&gt;&lt;/template&gt;&lt;script setup&gt;const myProps = defineProps([&#x27;childValueModel&#x27;]);const myEmits= defineEmits([&#x27;update:childValueModel&#x27;]);&lt;/script&gt;\n\nçˆ¶ç»„ä»¶\n12345678910111213&lt;script setup&gt;import HelloWorld from &#x27;./components/defineProps-----defineEmits .vue&#x27;//çˆ¶ç»„ä»¶function count(value) &#123;  console.log(value);&#125;&lt;/script&gt;&lt;template&gt;  &lt;HelloWorld a=&quot;qwdqwd&quot;    @count=&#x27;count&#x27; /&gt;&lt;/template&gt;\n\nå­ç»„ä»¶\n1234567891011121314151617&lt;script setup&gt;import &#123; ref &#125; from &quot;vue&quot;//å­ç»„ä»¶let count = ref(0)let emit = defineEmits([&quot;count&quot;])const props = defineProps((&#123;  a: String&#125;))function increment() &#123;  count.value++  emit(&quot;count&quot;, count.value)&#125;&lt;/script&gt;&lt;template&gt;  &lt;button @click=&quot;increment&quot;&gt;&#123;&#123; count &#125;&#125; &#123;&#123;props.a&#125;&#125;&lt;/button&gt;&lt;/template&gt;\n\ndefineModel() 3.4+ç‰ˆæœ¬\ndefineModel å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œæ˜¯å¯¹ v-model å†åŒ…è£…çš„è¯­æ³•ç³–\ndefineModel å¸®ä½ è·å–åˆ°äº† prop ä¸­çš„ modelValue ï¼Œä¸”å½“ å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨å¸®ä½ è°ƒç”¨ update:modelValue\n123456const myProps = defineProps([&quot;modelValue&quot;]);const myEmits = defineEmits([&quot;update:modelValue&quot;]);// è¯´ç™½äº†ï¼Œè¿™é‡Œçš„ modelValue ç­‰ä»·äº props.modelValue + emit(&#x27;update:modelValue&#x27;)// defineModel å¸®ä½  å°è£…äº† modelValue å’Œ update:modelValueconst modelValue = defineModel();\n\nçˆ¶ç»„ä»¶\n12345678910&lt;template&gt;  &lt;defineModelChild v-model=&quot;childValue&quot;&gt;&lt;/defineModelChild&gt;&lt;/template&gt;&lt;script setup&gt;import &#123; ref &#125; from &#x27;vue&#x27;;import defineModelChild from &#x27;./components/defineModelChild.vue&#x27;;const childValue = ref(0);&lt;/script&gt;\n\nv-model å­ç»„ä»¶\n1234567891011&lt;template&gt;&lt;template&gt;  &lt;div&gt;&#123;&#123; modelValue &#125;&#125;&lt;/div&gt;  &lt;button @click=&quot;myEmits(&#x27;update:modelValue&#x27;, modelValue + 1)&quot;&gt;æ•°æ® + 1&lt;/button&gt;&lt;/template&gt;&lt;script setup&gt;defineProps([&#x27;modelValue&#x27;]);const myEmits = defineEmits([&#x27;update:modelValue&#x27;]);&lt;/script&gt;\n\ndefineModel() å­ç»„ä»¶\n12345678&lt;template&gt;  &lt;div&gt;&#123;&#123; modelValue &#125;&#125;&lt;/div&gt;  &lt;button @click=&quot;modelValue++&quot;&gt;æ•°æ® + 1&lt;/button&gt;&lt;/template&gt;&lt;script setup&gt;const modelValue = defineModel();&lt;/script&gt;\n\ndefineExpose å­ä¼ çˆ¶\nï¼ˆç”¨åœ¨å­ç»„ä»¶ï¼Œæš´éœ²æƒ³ä¼ é€’çš„å€¼æˆ–æ–¹æ³•ï¼Œçˆ¶ç»„ä»¶é€šè¿‡ ref å±æ€§è·å–å­ç»„ä»¶æš´éœ²çš„ï¼‰\nä½¿ç”¨ script setup çš„ç»„ä»¶æ˜¯é»˜è®¤å…³é—­çš„â€”â€”å³é€šè¿‡æ¨¡æ¿å¼•ç”¨æˆ–è€… $parent é“¾è·å–åˆ°çš„ç»„ä»¶çš„å…¬å¼€å®ä¾‹ï¼Œä¸ä¼šæš´éœ²ä»»ä½•åœ¨ script setup ä¸­å£°æ˜çš„ç»‘å®šã€‚\né‚£ä¹ˆï¼Œé€šè¿‡ defineExpose ç¼–è¯‘å™¨å®æ¥æ˜¾å¼æŒ‡å®šåœ¨\nç„¶åï¼Œçˆ¶ç»„ä»¶é€šè¿‡ ref å±æ€§è®¿é—®å­ç»„ä»¶\nçˆ¶ç»„ä»¶ï¼š\n123456789101112131415161718&lt;Index ref=&quot;childeRef&quot;&gt;&lt;/Index&gt;&lt;script setup&gt;    import Index from &quot;./index.vue&quot;;    const childeRef = ref();    function test() &#123;        console.log(childeRef.value.msg) // Hello World    &#125;    onMounted(() =&gt; &#123;      let flag:boolean = true;      let value:number= 5;      childeRef.value.childFn(flag,value) // è°ƒç”¨å­ç»„ä»¶å‡½æ•°, è¾“å‡º 6    &#125;)&lt;/script&gt;\n\nå­ç»„ä»¶ï¼š\n1234567891011121314151617&lt;script setup&gt;    import &#123;ref&#125; from &quot;vue&quot;;    function childFn(typeï¼šboolean, dataï¼šnumber) &#123;        console.log(&#x27;æˆ‘æ˜¯å­ç»„ä»¶&#x27;);        if(data)&#123;           let value = data + 1;           return value;        &#125;    &#125;    const msg = &#x27;Hello World&#x27;;    defineExpose(&#123; //æš´éœ²æƒ³è¦ä¼ é€’çš„å€¼æˆ–æ–¹æ³•        msg,        childFn,    &#125;);&lt;/script&gt;\n\ndefineOptions 3.3+\n123456789&lt;script setup&gt;import &#123; defineOptions &#125; from &#x27;vue&#x27;defineOptions(&#123;name: &#x27;Foo&#x27;,//ç»„ä»¶é‡å‘½å inheritAttrs: false,//...æ›´å¤šè‡ªå®šä¹‰å±æ€§&#125;)&lt;/script&gt;\n\ncomputed è®¡ç®—å±æ€§\n1234567891011121314151617181920212223&lt;script setup &gt;import &#123; computed, reactive &#125; from &quot;vue&quot;;const author = reactive(&#123;  books: [    &#x27;Vue 2 - Advanced Guide&#x27;,    &#x27;Vue 3 - Basic Guide&#x27;,    &#x27;Vue 4 - The Mystery&#x27;  ]&#125;)const publishedBooksMessage = computed(() =&gt; &#123;  return author.books.length &gt; 0 ? &#x27; Yes&#x27; : &quot;No&quot;&#125;)&lt;/script&gt;&lt;template&gt;  &lt;div&gt;    &#123;&#123; publishedBooksMessage &#125;&#125;  &lt;/div&gt;&lt;/template&gt;&lt;style  scoped&gt;&lt;/style&gt;\n\ncomputed ä¼ å‚\n12345678910111213141516171819202122232425262728&lt;script setup &gt;import &#123; computed, reactive &#125; from &quot;vue&quot;;const author = reactive(&#123;  name: &#x27;John Doe&#x27;,  books: [    &#x27;Vue 2 - Advanced Guide&#x27;,    &#x27;Vue 3 - Basic Guide&#x27;,    &#x27;Vue 4 - The Mystery&#x27;  ]&#125;)const publishedBooksMessage = computed(() =&gt; &#123;  return function (value) &#123;    console.log(value)    return author.books.length &gt; 0 ? &#x27; Yes&#x27; : &quot;No&quot;  &#125;&#125;)&lt;/script&gt;&lt;template&gt;  &lt;div&gt;    &lt;p&gt;Has published books:&lt;/p&gt;    &#123;&#123; publishedBooksMessage(12) &#125;&#125;  &lt;/div&gt;&lt;/template&gt;&lt;style  scoped&gt;&lt;/style&gt;\n\nwatch ç›‘å¬\né»˜è®¤å¼€å¯æ·±åº¦ç›‘å¬\n123456789101112131415161718192021222324252627282930&lt;script setup &gt;import &#123; ref, watch &#125; from &quot;vue&quot;const count = ref(0)const btnClick = () =&gt; &#123;  count.value++;&#125;// âœ… æ–¹æ³•ä¸€ï¼Œä¼ é€’å“åº”å¯¹è±¡watch(count, (newValue, oldValue) =&gt; &#123;  console.log(newValue, oldValue)&#125;)// âŒ æ–¹æ³•äºŒï¼šä¼ é€’å“åº”å¯¹è±¡ä¸‹çš„å±æ€§watch(user.name, (value) =&gt; &#123;    console.log(value) // ç›‘å¬å¤±è´¥ï¼Œæ²¡è¾“å‡º&#125;)// âœ… æ–¹æ³•ä¸‰ï¼šä¼ é€’å‡½æ•°ï¼Œå‡½æ•°è¿”å›å“åº”å¯¹è±¡å±æ€§watch(() =&gt; user.name, (value) =&gt; &#123;    console.log(value); // ç›‘å¬æˆåŠŸï¼Œè¾“å‡º jake&#125;)&lt;/script&gt;&lt;template&gt;  &lt;div&gt;    &lt;button @click=&quot;btnClick&quot;&gt;ç‚¹å‡»&lt;/button&gt;    &#123;&#123; count &#125;&#125;  &lt;/div&gt;&lt;/template&gt;&lt;style  scoped&gt;&lt;/style&gt;\n\nwatchEffect çš„ä½¿ç”¨\nwatchEffect ä¹Ÿæ˜¯ä¸€ä¸ªå¸§å¬å™¨ï¼Œæ˜¯ä¸€ä¸ªå‰¯ä½œç”¨å‡½æ•°ã€‚ å®ƒä¼šç›‘å¬å¼•ç”¨æ•°æ®ç±»å‹çš„æ‰€æœ‰å±æ€§ï¼Œä¸éœ€è¦å…·ä½“åˆ°æŸä¸ªå±æ€§ï¼Œä¸€æ—¦è¿è¡Œå°±ä¼šç«‹å³ç›‘å¬ï¼Œç»„ä»¶å¸è½½çš„æ—¶å€™ä¼šåœæ­¢ç›‘å¬ã€‚\n123456789101112131415161718192021222324&lt;script setup &gt;import &#123; reactive, ref, watch, watchEffect &#125; from &quot;vue&quot;const count = reactive(&#123; name: &#x27;112&#x27;, data: [&quot;ä½ å¥½&quot;] &#125;)const btnClick = () =&gt; &#123;  count.data[0] = &#x27;è¢«æ”¹äº†&#x27;&#125;watchEffect(() =&gt; &#123;  console.log(count.data[0]);&#125;) watch([count,obj],() =&gt; &#123;      console.log(&#x27;ç›‘å¬çš„å¤šä¸ªæ•°æ®æ”¹å˜äº†&#x27;)    &#125;)&lt;/script&gt;&lt;template&gt;  &lt;div&gt;    &lt;button @click=&quot;btnClick&quot;&gt;ç‚¹å‡»&lt;/button&gt;    &#123;&#123;count.data[0]&#125;&#125;  &lt;/div&gt;&lt;/template&gt;&lt;style  scoped&gt;&lt;/style&gt;\n\nstopWatchEffect åœæ­¢ç›‘å¬\n1234567const stop = watchEffect(() =&gt; &#123;  console.log(&quot;name:&quot;, obj.name);&#125;);const stopWatchEffect = () =&gt; &#123;  console.log(&quot;åœæ­¢ç›‘å¬&quot;);  stop();&#125;;\n\nonInvalidate å‡½æ•° è§£å†³æ‰§è¡Œé¡ºåºä¹±çš„é—®é¢˜\n","slug":"vue3 Api","date":"2024-06-13T08:39:58.000Z","categories_index":"Vue3","tags_index":"Vue3","author_index":"æƒæ ˆ"}]