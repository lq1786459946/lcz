import{_ as he}from"./2BlOukxT.js";import{r as C,J as ue,c as I,o as f,w as t,a as e,f as i,d as h,V as d,i as H,u as a,X as fe,g as V,b as W,k as ae,x as xe,m as j,F as T,h as F,Z as ve,t as $,Y as be,K as J,L as K,M as q,v as te,q as de,e as Ae,a3 as De}from"./CnuomZrk.js";import{u as Te,V as Ie,a as Ue}from"./Bfr6Sgel.js";import{u as Re}from"./dXGWV11w.js";import{c as Be}from"./D-NZNAlt.js";import{b as ze,f as Ne}from"./C0ATfDYJ.js";import{C as me}from"./CVj2jVhd.js";import{I as Fe,L as Pe}from"./jT-fiLzj.js";import{u as Oe,S as je,P as qe,U as He,E as Je}from"./C9zGyex1.js";import{a as Ke,c as We,V as Q}from"./BQV00918.js";import{V as G}from"./DRUaJwo7.js";import{V as B}from"./DpX84nPs.js";import{V as Y}from"./BM5uu3-6.js";import{_ as Xe}from"./Ikdb0YeY.js";import{V as ke}from"./9_89H3jd.js";import{_ as Ye}from"./D_aEEmAQ.js";import{$ as _e}from"./VpPsBD4i.js";import{V as R}from"./C5itGDkh.js";import{V as le}from"./J8NvyoUP.js";import{V as ie,a as ne,b as oe}from"./CcLwsTP6.js";import{V as ye}from"./BEvpqIqK.js";import{V as Z}from"./Cj1spGCk.js";import{V as $e}from"./-fAUXWz3.js";import{V as Ce}from"./B1cM5iYL.js";import{V as ge}from"./Fe_cnmBv.js";import"./B0wkeW91.js";import"./cDhjtOJI.js";/* empty css        */import"./DWpBGHOm.js";import"./CqzD6X7m.js";import"./KEzkHOjn.js";import"./DY7PVvcf.js";import"./DmoV_8k7.js";import"./C-GTDzx5.js";/* empty css        */import"./CYA0dyx_.js";import"./BsKgkAtJ.js";import"./oSMZqe4k.js";import"./BErCBOBj.js";import"./Bjdq3k92.js";import"./RgM8UNVF.js";import"./DUPbah5Z.js";import"./Cbcoqhwy.js";import"./D-PTy7x9.js";const Ze={class:"px-1 pe-6 py-1"},Ge=i("div",{class:"text-disabled font-weight-medium"}," To: ",-1),Qe={class:"cursor-pointer text-medium-emphasis"},et=i("span",{class:"mx-1"},"|",-1),tt={key:0},at=i("div",{class:"text-disabled font-weight-medium"}," Cc: ",-1),lt={key:0},it=i("div",{class:"text-disabled font-weight-medium"}," Bcc: ",-1),nt=i("div",{class:"text-disabled font-weight-medium"}," Subject: ",-1),ot={class:"tiptap-editor-wrapper"},st={key:0,class:"d-flex flex-wrap gap-x-1 px-4 py-2"},rt={class:"mx-5"},dt={class:"d-flex align-center px-5 py-4 gap-4"},ct={__name:"ComposeDialog",emits:["close"],setup(M,{emit:U}){const m=C(""),w=C(""),x=C(""),L=C(""),E=C(""),z=C(""),v=C(!1),g=C(!1),b=()=>{w.value=x.value=L.value=""},_=Oe({content:"",extensions:[je,Fe,qe.configure({placeholder:"Message"}),He,Pe.configure({openOnClick:!1})]}),k=()=>{var r,s,O;const p=(r=_.value)==null?void 0:r.getAttributes("link").href,l=window.prompt("URL",p);if(l!==null){if(l===""){(s=_.value)==null||s.chain().focus().extendMarkRange("link").unsetLink().run();return}(O=_.value)==null||O.chain().focus().extendMarkRange("link").setLink({href:l}).run()}},A=()=>{var l;const p=window.prompt("URL");p&&((l=_.value)==null||l.chain().focus().setImage({src:p}).run())};return(p,l)=>{const r=ue("IconBtn");return f(),I(Q,{class:"email-compose-dialog",elevation:"24","max-width":"30vw"},{default:t(()=>[e(Ke,{class:"py-3"},{append:t(()=>[e(r,{onClick:l[0]||(l[0]=s=>p.$emit("close"))},{default:t(()=>[e(d,{icon:"ri-subtract-line"})]),_:1}),e(r,{onClick:l[1]||(l[1]=s=>{p.$emit("close"),b(),v.value=!1,g.value=!1})},{default:t(()=>[e(d,{icon:"ri-close-line"})]),_:1})]),default:t(()=>[e(We,{class:"text-medium-emphasis"},{default:t(()=>[h(" Compose Mail ")]),_:1})]),_:1}),i("div",Ze,[e(G,{modelValue:a(w),"onUpdate:modelValue":l[4]||(l[4]=s=>H(w)?w.value=s:null),density:"compact"},{"prepend-inner":t(()=>[Ge]),append:t(()=>[i("span",Qe,[i("span",{onClick:l[2]||(l[2]=s=>v.value=!a(v))},"Cc"),et,i("span",{onClick:l[3]||(l[3]=s=>g.value=!a(g))},"Bcc")])]),_:1},8,["modelValue"])]),e(fe,null,{default:t(()=>[a(v)?(f(),V("div",tt,[e(B),e(G,{modelValue:a(E),"onUpdate:modelValue":l[5]||(l[5]=s=>H(E)?E.value=s:null),density:"compact"},{"prepend-inner":t(()=>[at]),_:1},8,["modelValue"])])):W("",!0)]),_:1}),e(fe,null,{default:t(()=>[a(g)?(f(),V("div",lt,[e(B),e(G,{modelValue:a(z),"onUpdate:modelValue":l[6]||(l[6]=s=>H(z)?z.value=s:null),density:"compact"},{"prepend-inner":t(()=>[it]),_:1},8,["modelValue"])])):W("",!0)]),_:1}),e(B),e(G,{modelValue:a(x),"onUpdate:modelValue":l[7]||(l[7]=s=>H(x)?x.value=s:null),density:"compact"},{"prepend-inner":t(()=>[nt]),_:1},8,["modelValue"]),e(B),i("div",ot,[a(_)?(f(),V("div",st,[e(r,{rounded:"",color:a(_).isActive("bold")?"primary":"",variant:a(_).isActive("bold")?"tonal":"text",onClick:l[8]||(l[8]=s=>a(_).chain().focus().toggleBold().run())},{default:t(()=>[e(d,{icon:"ri-bold"})]),_:1},8,["color","variant"]),e(r,{rounded:"",color:a(_).isActive("underline")?"primary":"",variant:a(_).isActive("underline")?"tonal":"text",onClick:l[9]||(l[9]=s=>a(_).commands.toggleUnderline())},{default:t(()=>[e(d,{icon:"ri-underline"})]),_:1},8,["color","variant"]),e(r,{rounded:"",color:a(_).isActive("italic")?"primary":"",variant:a(_).isActive("italic")?"tonal":"text",onClick:l[10]||(l[10]=s=>a(_).chain().focus().toggleItalic().run())},{default:t(()=>[e(d,{icon:"ri-italic"})]),_:1},8,["color","variant"]),e(r,{rounded:"",color:a(_).isActive("bulletList")?"primary":"",variant:a(_).isActive("bulletList")?"tonal":"text",onClick:l[11]||(l[11]=s=>a(_).chain().focus().toggleBulletList().run())},{default:t(()=>[e(d,{icon:"ri-list-check"})]),_:1},8,["color","variant"]),e(r,{rounded:"",color:a(_).isActive("orderedList")?"primary":"",variant:a(_).isActive("orderedList")?"tonal":"text",onClick:l[12]||(l[12]=s=>a(_).chain().focus().toggleOrderedList().run())},{default:t(()=>[e(d,{icon:"ri-list-ordered-2"})]),_:1},8,["color","variant"]),e(r,{rounded:"",onClick:k},{default:t(()=>[e(d,{icon:"ri-links-line"})]),_:1}),e(r,{rounded:"",onClick:A},{default:t(()=>[e(d,{icon:"ri-image-line"})]),_:1})])):W("",!0),e(B),i("div",rt,[e(a(Je),{editor:a(_)},null,8,["editor"])])]),i("div",dt,[e(ae,{"append-icon":"ri-send-plane-line",disabled:a(w)==="",onClick:l[13]||(l[13]=s=>{p.$emit("close"),m.value="",b(),v.value=!1,g.value=!1})},{default:t(()=>[h(" Send ")]),_:1},8,["disabled"]),e(r,null,{default:t(()=>[e(d,{icon:"ri-attachment-2"})]),_:1}),e(Y),e(r,null,{default:t(()=>[e(d,{icon:"ri-more-2-line"})]),_:1}),e(r,{onClick:l[14]||(l[14]=s=>{p.$emit("close"),b(),m.value="",v.value=!1,g.value=!1})},{default:t(()=>[e(d,{icon:"ri-delete-bin-7-line"})]),_:1})])]),_:1})}}},ut={class:"d-flex flex-column h-100"},mt={class:"pa-5"},pt={class:"email-filters-labels"},ft=["href","onClick"],vt=i("li",{class:"text-sm d-block text-uppercase text-disabled mt-9 mb-4"}," LABELS ",-1),_t=["href","onClick"],gt=Object.assign({inheritAttrs:!1},{__name:"EmailLeftSidebarContent",props:{emailsMeta:{type:Object,required:!0}},emits:["toggleComposeDialogVisibility"],setup(M,{emit:U}){const m=M,w=C(0),x=C(0),L=C(0),E=C(0);xe(()=>m.emailsMeta,g=>{g&&(w.value=g.inbox,x.value=g.draft,L.value=g.spam,E.value=g.star)},{immediate:!0,deep:!0});const z=j(()=>[{title:"Inbox",prependIcon:"ri-mail-line",to:{name:"apps-email"},badge:{content:w.value,color:"primary"}},{title:"Sent",prependIcon:"ri-send-plane-line",to:{name:"apps-email-filter",params:{filter:"sent"}}},{title:"Draft",prependIcon:"ri-edit-box-line",to:{name:"apps-email-filter",params:{filter:"draft"}},badge:{content:x.value,color:"warning"}},{title:"Starred",prependIcon:"ri-star-line",to:{name:"apps-email-filter",params:{filter:"starred"}},badge:{content:E.value,color:"success"}},{title:"Spam",prependIcon:"ri-spam-2-line",to:{name:"apps-email-filter",params:{filter:"spam"}},badge:{content:L.value,color:"error"}},{title:"Trash",prependIcon:"ri-delete-bin-7-line",to:{name:"apps-email-filter",params:{filter:"trashed"}}}]),v=[{title:"Personal",color:"success",to:{name:"apps-email-label",params:{label:"personal"}}},{title:"Company",color:"primary",to:{name:"apps-email-label",params:{label:"company"}}},{title:"Important",color:"warning",to:{name:"apps-email-label",params:{label:"important"}}},{title:"Private",color:"error",to:{name:"apps-email-label",params:{label:"private"}}}];return(g,b)=>{const _=Xe;return f(),V("div",ut,[i("div",mt,[e(ae,{block:"",onClick:b[0]||(b[0]=k=>g.$emit("toggleComposeDialogVisibility"))},{default:t(()=>[h(" Compose ")]),_:1})]),e(a(me),{options:{wheelPropagation:!1},class:"h-100 pt-4"},{default:t(()=>[i("ul",pt,[(f(!0),V(T,null,F(a(z),k=>(f(),I(_,{key:k.title,class:"d-flex align-center cursor-pointer",to:k.to,custom:""},{default:t(({isActive:A,href:p,navigate:l})=>{var r;return[i("li",ve(g.$attrs,{href:p,class:[A&&"email-filter-active text-primary","d-flex align-center cursor-pointer"],onClick:l}),[e(d,{icon:k.prependIcon,class:"me-2",size:"20"},null,8,["icon"]),i("span",null,$(k.title),1),e(Y),(r=k.badge)!=null&&r.content?(f(),I(ke,{key:0,size:"x-small",color:k.badge.color},{default:t(()=>[h($(k.badge.content),1)]),_:2},1032,["color"])):W("",!0)],16,ft)]}),_:2},1032,["to"]))),128)),vt,(f(),V(T,null,F(v,k=>e(_,{key:k.title,class:"d-flex align-center",to:k.to,custom:""},{default:t(({isActive:A,href:p,navigate:l})=>[i("li",ve(g.$attrs,{href:p,class:[A&&"email-label-active text-primary","cursor-pointer"],onClick:l}),[e(d,{color:k.color,icon:"ri-circle-fill",size:"12",class:"me-2"},null,8,["color"]),i("span",null,$(k.title),1)],16,_t)]),_:2},1032,["to"])),64))])]),_:1})])}}}),ce=()=>{const M=be(),U=async(v,g)=>{await _e("apps/email",{method:"POST",body:JSON.stringify({ids:v,data:g})})};return{labels:[{title:"personal",color:"success"},{title:"company",color:"primary"},{title:"important",color:"warning"},{title:"private",color:"error"}],resolveLabelColor:v=>v==="personal"?"success":v==="company"?"primary":v==="important"?"warning":v==="private"?"error":"secondary",shallShowMoveToActionFor:v=>v==="trash"?M.params.filter!=="trashed":v==="inbox"?!(M.params.filter===void 0||M.params.filter==="sent"||M.params.filter==="draft"):v==="spam"?!(M.params.filter==="spam"||M.params.filter==="sent"||M.params.filter==="draft"):!1,emailMoveToFolderActions:[{action:"inbox",icon:"ri-mail-line"},{action:"spam",icon:"ri-spam-2-line"},{action:"trash",icon:"ri-delete-bin-line"}],moveSelectedEmailTo:async(v,g)=>{const b={};v==="inbox"?(M.params.filter==="trashed"&&(b.isDeleted=!1),b.folder="inbox"):v==="spam"?(M.params.filter==="trashed"&&(b.isDeleted=!1),b.folder="spam"):v==="trash"&&(b.isDeleted=!0),await U(g,b)},updateEmails:U,updateEmailLabels:async(v,g)=>{await _e("/apps/email",{method:"POST",body:{ids:v,label:g}})}}},ht={class:"email-view-header d-flex align-center px-5 py-4"},xt={class:"d-flex align-center flex-wrap flex-grow-1 overflow-hidden gap-2"},bt={class:"text-h6 font-weight-regular text-truncate"},kt={class:"d-flex flex-wrap gap-2"},yt={class:"d-flex align-center gap-2"},$t={class:"email-view-action-bar d-flex align-center text-medium-emphasis gap-1 px-5"},Ct={class:"d-flex align-center gap-x-1"},wt={class:"d-flex align-start"},Vt={class:"d-flex flex-wrap flex-grow-1 overflow-hidden"},Et={class:"text-truncate"},Mt={class:"text-h6 font-weight-regular text-truncate"},St={class:"text-body-2 mb-0"},Lt={class:"d-flex align-center"},At={class:"text-disabled me-4"},Dt={class:"text-body-1 font-weight-medium text-truncate mb-4"},Tt=["innerHTML"],It=i("span",null,"2 Attachments",-1),Ut={class:"text-base"},Rt=i("span",{class:"text-primary cursor-pointer"}," Forward ",-1),Bt={class:"text-body-1 text-high-emphasis mb-4"},zt={class:"d-flex justify-end gap-4 pt-2 flex-wrap"},Nt={__name:"EmailView",props:{email:{type:null,required:!0},emailMeta:{type:Object,required:!0}},emits:["refresh","navigated","close","trash","unread","read","star","unstar"],setup(M,{emit:U}){const m=M,w=U,x=C(""),L=C(!1),E=C(!0),{updateEmailLabels:z}=ce(),{labels:v,resolveLabelColor:g,emailMoveToFolderActions:b,shallShowMoveToActionFor:_,moveSelectedEmailTo:k}=ce(),A=async l=>{await k(l,[m.email.id]),w("refresh"),w("close")},p=async l=>{await z([m.email.id],l),w("refresh")};return(l,r)=>{const s=ue("IconBtn"),O=he,se=Ye;return f(),I(Ce,{temporary:"","model-value":!!m.email,location:"right",scrim:!1,floating:"",class:"email-view"},{default:t(()=>[m.email?(f(),V(T,{key:0},[i("div",ht,[e(s,{class:"me-2 flip-in-rtl",onClick:r[0]||(r[0]=c=>{l.$emit("close"),L.value=!1,E.value=!0,x.value=""})},{default:t(()=>[e(d,{icon:"ri-arrow-left-s-line"})]),_:1}),i("div",xt,[i("h6",bt,$(m.email.subject),1),i("div",kt,[(f(!0),V(T,null,F(m.email.labels,c=>(f(),I(ke,{key:c,color:a(g)(c),size:"small",class:"text-capitalize flex-shrink-0"},{default:t(()=>[h($(c),1)]),_:2},1032,["color"]))),128))])]),i("div",yt,[e(s,{variant:"plain",disabled:!m.emailMeta.hasPreviousEmail,class:"flip-in-rtl",onClick:r[1]||(r[1]=c=>l.$emit("navigated","previous"))},{default:t(()=>[e(d,{icon:"ri-arrow-left-s-line"})]),_:1},8,["disabled"]),e(s,{variant:"plain",class:"flip-in-rtl",disabled:!m.emailMeta.hasNextEmail,onClick:r[2]||(r[2]=c=>l.$emit("navigated","next"))},{default:t(()=>[e(d,{icon:"ri-arrow-right-s-line"})]),_:1},8,["disabled"])])]),e(B),i("div",$t,[J(e(s,{onClick:r[3]||(r[3]=c=>{l.$emit("trash"),l.$emit("close")})},{default:t(()=>[e(d,{icon:"ri-delete-bin-7-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[h(" Delete Mail ")]),_:1})]),_:1},512),[[K,!m.email.isDeleted]]),e(s,{onClick:r[4]||(r[4]=q(c=>{l.$emit("unread"),l.$emit("close")},["stop"]))},{default:t(()=>[e(d,{icon:"ri-mail-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[h(" Mark as Unread ")]),_:1})]),_:1}),e(s,null,{default:t(()=>[e(d,{icon:"ri-folder-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[h(" Move to ")]),_:1}),e(le,{activator:"parent"},{default:t(()=>[e(ie,{density:"compact"},{default:t(()=>[(f(!0),V(T,null,F(a(b),c=>(f(),I(ne,{key:c.title,class:te([a(_)(c.action)?"d-flex":"d-none","align-center"]),href:"#",onClick:N=>A(c.action)},{prepend:t(()=>[e(d,{icon:c.icon,class:"me-2",size:"20"},null,8,["icon"])]),default:t(()=>[e(oe,{class:"text-capitalize"},{default:t(()=>[h($(c.action),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(s,null,{default:t(()=>[e(d,{icon:"ri-price-tag-3-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[h(" Label ")]),_:1}),e(le,{activator:"parent"},{default:t(()=>[e(ie,{density:"compact"},{default:t(()=>[(f(!0),V(T,null,F(a(v),c=>(f(),I(ne,{key:c.title,href:"#",onClick:q(N=>p(c.title),["stop"])},{prepend:t(()=>[e(ye,{inline:"",color:a(g)(c.title),dot:""},null,8,["color"])]),default:t(()=>[e(oe,{class:"ms-2 text-capitalize"},{default:t(()=>[h($(c.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(Y),i("div",Ct,[e(s,{color:m.email.isStarred?"warning":"default",onClick:r[5]||(r[5]=c=>{var N;(N=m.email)!=null&&N.isStarred?l.$emit("unstar"):l.$emit("star"),l.$emit("refresh")})},{default:t(()=>[e(d,{color:m.email.isStarred?"warning":"",icon:"ri-star-line"},null,8,["color"])]),_:1},8,["color"]),e(O)])]),e(B),e(a(me),{tag:"div",class:"mail-content-container flex-grow-1 pa-sm-12 pa-6",options:{wheelPropagation:!1}},{default:t(()=>[e(Q,{class:"mb-4"},{default:t(()=>[e(Z,{class:"mail-header"},{default:t(()=>[i("div",wt,[e($e,{size:"38",class:"me-3"},{default:t(()=>[e(de,{src:m.email.from.avatar,alt:m.email.from.name},null,8,["src","alt"])]),_:1}),i("div",Vt,[i("div",Et,[i("h6",Mt,$(m.email.from.name),1),i("p",St,$(m.email.from.email),1)]),e(Y),i("div",Lt,[i("span",At,$(("formatDate"in l?l.formatDate:a(ze))(m.email.time)),1),J(e(s,null,{default:t(()=>[e(d,{icon:"ri-attachment-2"})]),_:1},512),[[K,m.email.attachments.length]])])]),e(O,{class:"align-self-sm-center"})])]),_:1}),e(B),e(Z,null,{default:t(()=>[i("div",Dt,$(m.email.from.name)+", ",1),i("div",{class:"text-base",innerHTML:m.email.message},null,8,Tt)]),_:1}),m.email.attachments.length?(f(),V(T,{key:0},[e(B),e(Z,{class:"d-flex flex-column gap-y-4 pt-4"},{default:t(()=>[It,(f(!0),V(T,null,F(m.email.attachments,c=>(f(),V("div",{key:c.fileName,class:"d-flex align-center"},[e(de,{src:c.thumbnail,alt:c.fileName,"aspect-ratio":"1","max-height":"24","max-width":"24",class:"me-2"},null,8,["src","alt"]),i("span",null,$(c.fileName),1)]))),128))]),_:1})],64)):W("",!0)]),_:1}),J(e(Q,null,{default:t(()=>[e(Z,{class:"font-weight-medium text-high-emphasis"},{default:t(()=>[i("div",Ut,[h(" Click here to "),i("span",{class:"text-primary cursor-pointer",onClick:r[6]||(r[6]=c=>{L.value=!a(L),E.value=!a(E)})}," Reply "),h(" or "),Rt])]),_:1})]),_:1},512),[[K,a(E)]]),a(L)?(f(),I(Q,{key:0},{default:t(()=>[e(Z,null,{default:t(()=>{var c;return[i("h6",Bt," Reply to "+$((c=M.email)==null?void 0:c.from.name),1),e(se,{modelValue:a(x),"onUpdate:modelValue":r[7]||(r[7]=N=>H(x)?x.value=N:null),placeholder:"Write your message...","is-divider":!1},null,8,["modelValue"]),i("div",zt,[e(s,{icon:"ri-delete-bin-7-line",onClick:r[8]||(r[8]=N=>{L.value=!a(L),E.value=!a(E),x.value=""})}),e(ae,{variant:"text",color:"secondary"},{prepend:t(()=>[e(d,{icon:"ri-attachment-2",class:"text-high-emphasis"})]),default:t(()=>[h(" Attachments ")]),_:1}),e(ae,{"append-icon":"ri-send-plane-line"},{default:t(()=>[h(" Send ")]),_:1})])]}),_:1})]),_:1})):W("",!0)]),_:1})],64)):W("",!0)]),_:1},8,["model-value"])}}},Ft={class:"d-flex align-center"},Pt={class:"py-2 px-4 d-flex align-center"},Ot=["onClick"],jt={class:"text-h6"},qt={class:"text-body-2 truncate"},Ht={class:"text-sm text-disabled"},Jt={class:"email-actions d-none"},Kt={class:"py-4 px-5 text-center"},Wt=i("span",{class:"text-high-emphasis"},"No items found.",-1),Xt=[Wt],Fa={__name:"index",async setup(M){let U,m;const{isLeftSidebarOpen:w}=Te(),x=be(),{labels:L,resolveLabelColor:E,emailMoveToFolderActions:z,shallShowMoveToActionFor:v,moveSelectedEmailTo:g,updateEmails:b,updateEmailLabels:_}=ce(),k=C(!1),A=C(""),p=C([]),{data:l,execute:r}=([U,m]=Ae(()=>Re(Be("/apps/email",{query:{q:A,filter:()=>"filter"in x.params?x.params.filter:void 0,label:()=>"label"in x.params?x.params.label:void 0}}))),U=await U,m(),U),s=j(()=>l.value.emails),O=j(()=>l.value.emailsMeta),se=u=>{const n=p.value.indexOf(u);n===-1?p.value.push(u):p.value.splice(n,1)},c=j(()=>s.value.length&&s.value.length===p.value.length),N=j(()=>!!p.value.length&&s.value.length!==p.value.length),re=j(()=>p.value.every(u=>{var n;return(n=s.value.find(S=>S.id===u))==null?void 0:n.isRead})),we=()=>{p.value=c.value?[]:s.value.map(u=>u.id)},y=C(null),Ve=j(()=>{const u={hasNextEmail:!1,hasPreviousEmail:!1};if(y.value){const n=s.value.findIndex(S=>{var X;return S.id===((X=y.value)==null?void 0:X.id)});u.hasNextEmail=!!s.value[n+1],u.hasPreviousEmail=!!s.value[n-1]}return u}),pe=async()=>{await r(),y.value&&(y.value=s.value.find(u=>{var n;return u.id===((n=y.value)==null?void 0:n.id)}))},D=async(u,n=p.value)=>{p.value=[],n.length&&(u==="trash"?await b(n,{isDeleted:!0}):u==="spam"?await b(n,{folder:"spam"}):u==="unread"?await b(n,{isRead:!1}):u==="read"?await b(n,{isRead:!0}):u==="star"?await b(n,{isStarred:!0}):u==="unstar"&&await b(n,{isStarred:!1}),y.value?pe():await r())},Ee=async u=>{await g(u,p.value),await r()},Me=async u=>{await _(p.value,u),await r()},Se=u=>{if(!y.value)return;const n=s.value.findIndex(X=>{var o;return X.id===((o=y.value)==null?void 0:o.id)}),S=u==="previous"?n-1:n+1;y.value=s.value[S]},Le=async u=>{y.value=u,await D("read",[u.id])};return xe(()=>x.params,()=>{p.value=[]},{deep:!0}),(u,n)=>{const S=ue("IconBtn"),X=he;return f(),I(Ie,{style:{"z-index":"0","min-block-size":"100%"},class:"email-app-layout"},{default:t(()=>[e(Ce,{modelValue:a(w),"onUpdate:modelValue":n[1]||(n[1]=o=>H(w)?w.value=o:null),absolute:"",touchless:"",location:"start",temporary:u.$vuetify.display.mdAndDown},{default:t(()=>[e(gt,{"emails-meta":a(O),onToggleComposeDialogVisibility:n[0]||(n[0]=o=>k.value=!a(k))},null,8,["emails-meta"])]),_:1},8,["modelValue","temporary"]),e(Nt,{email:a(y),"email-meta":a(Ve),onRefresh:pe,onNavigated:Se,onClose:n[2]||(n[2]=o=>y.value=null),onTrash:n[3]||(n[3]=o=>D("trash",a(y)?[a(y).id]:[])),onUnread:n[4]||(n[4]=o=>D("unread",a(y)?[a(y).id]:[])),onStar:n[5]||(n[5]=o=>D("star",a(y)?[a(y).id]:[])),onUnstar:n[6]||(n[6]=o=>D("unstar",a(y)?[a(y).id]:[]))},null,8,["email","email-meta"]),e(Ue,null,{default:t(()=>[e(Q,{flat:"",class:"email-content-list h-100 d-flex flex-column"},{default:t(()=>[i("div",Ft,[e(S,{class:"d-lg-none ms-3",onClick:n[7]||(n[7]=o=>w.value=!0)},{default:t(()=>[e(d,{icon:"ri-menu-line"})]),_:1}),e(G,{modelValue:a(A),"onUpdate:modelValue":n[8]||(n[8]=o=>H(A)?A.value=o:null),density:"default",class:"email-search px-1 flex-grow-1",placeholder:"Search mail"},{"prepend-inner":t(()=>[e(d,{color:"disabled",size:"22",icon:"ri-search-line"})]),_:1},8,["modelValue"])]),e(B),i("div",Pt,[e(ge,{"model-value":a(c),indeterminate:a(N),class:"d-flex","onUpdate:modelValue":we},null,8,["model-value","indeterminate"]),i("div",{class:"w-100 d-flex align-center action-bar-actions gap-1",style:De({visibility:a(N)||a(c)?void 0:"hidden"})},[J(e(S,{onClick:n[9]||(n[9]=o=>D("trash"))},{default:t(()=>[e(d,{icon:"ri-delete-bin-7-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[h(" Delete Mail ")]),_:1})]),_:1},512),[[K,"filter"in a(x).params?a(x).params.filter!=="trashed":!0]]),e(S,{onClick:n[10]||(n[10]=o=>a(re)?D("unread"):D("read"))},{default:t(()=>[e(d,{icon:a(re)?"ri-mail-line":"ri-mail-open-line"},null,8,["icon"]),e(R,{activator:"parent",location:"top"},{default:t(()=>[h($(a(re)?"Mark as Unread":"Mark as Read"),1)]),_:1})]),_:1}),e(S,null,{default:t(()=>[e(d,{icon:"ri-folder-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[h(" Folder ")]),_:1}),e(le,{activator:"parent"},{default:t(()=>[e(ie,{density:"compact"},{default:t(()=>[(f(!0),V(T,null,F(a(z),o=>(f(),I(ne,{key:o.title,class:te([a(v)(o.action)?"d-flex":"d-none","align-center"]),href:"#",onClick:ee=>Ee(o.action)},{prepend:t(()=>[e(d,{icon:o.icon,class:"me-2",size:"20"},null,8,["icon"])]),default:t(()=>[e(oe,{class:"text-capitalize"},{default:t(()=>[h($(o.action),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(S,null,{default:t(()=>[e(d,{icon:"ri-price-tag-3-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[h(" Label ")]),_:1}),e(le,{activator:"parent"},{default:t(()=>[e(ie,{density:"compact"},{default:t(()=>[(f(!0),V(T,null,F(a(L),o=>(f(),I(ne,{key:o.title,href:"#",onClick:ee=>Me(o.title)},{prepend:t(()=>[e(ye,{inline:"",color:a(E)(o.title),dot:""},null,8,["color"])]),default:t(()=>[e(oe,{class:"ms-2 text-capitalize"},{default:t(()=>[h($(o.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})],4),e(Y),e(S,{class:"me-1",onClick:a(r)},{default:t(()=>[e(d,{icon:"ri-refresh-line"})]),_:1},8,["onClick"]),e(X)]),e(B),e(a(me),{tag:"ul",options:{wheelPropagation:!1},class:"email-list"},{default:t(()=>[(f(!0),V(T,null,F(a(s),o=>{var ee;return J((f(),V("li",{key:o.id,class:te(["email-item d-flex align-center pa-4 gap-2 cursor-pointer",[{"email-read":o.isRead}]]),onClick:P=>Le(o)},[e(ge,{"model-value":a(p).includes(o.id),class:"flex-shrink-0","onUpdate:modelValue":P=>se(o.id),onClick:n[11]||(n[11]=q(()=>{},["stop"]))},null,8,["model-value","onUpdate:modelValue"]),e(S,{color:o.isStarred?"warning":"default",onClick:q(P=>D(o.isStarred?"unstar":"star",[o.id]),["stop"])},{default:t(()=>[e(d,{icon:"ri-star-line"})]),_:2},1032,["color","onClick"]),e($e,{size:"32"},{default:t(()=>[e(de,{src:o.from.avatar,alt:o.from.name},null,8,["src","alt"])]),_:2},1024),i("h6",jt,$(o.from.name),1),i("span",qt,$(o.subject),1),e(Y),i("div",{class:te(["email-meta align-center gap-2",u.$vuetify.display.xs?"d-none":""])},[(f(!0),V(T,null,F(o.labels,P=>(f(),I(d,{key:P,icon:"ri-circle-fill",size:"10",color:a(E)(P)},null,8,["color"]))),128)),i("span",Ht,$(("formatDateToMonthShort"in u?u.formatDateToMonthShort:a(Ne))(o.time)),1)],2),i("div",Jt,[e(S,{onClick:q(P=>D("trash",[o.id]),["stop"])},{default:t(()=>[e(d,{icon:"ri-delete-bin-7-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[h(" Delete Mail ")]),_:1})]),_:2},1032,["onClick"]),e(S,{class:"mx-2",onClick:q(P=>D(o.isRead?"unread":"read",[o.id]),["stop"])},{default:t(()=>[e(d,{icon:o.isRead?"ri-mail-line":"ri-mail-open-line"},null,8,["icon"]),e(R,{activator:"parent",location:"top"},{default:t(()=>[h($(o.isRead?"Mark as Unread":"Mark as Read"),1)]),_:2},1024)]),_:2},1032,["onClick"]),e(S,{onClick:q(P=>D("spam",[o.id]),["stop"])},{default:t(()=>[e(d,{icon:"ri-error-warning-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[h(" Move to Spam ")]),_:1})]),_:2},1032,["onClick"])])],10,Ot)),[[K,(ee=a(s))==null?void 0:ee.length]])}),128)),J(i("li",Kt,Xt,512),[[K,!a(s).length]])]),_:1})]),_:1}),J(e(ct,{onClose:n[12]||(n[12]=o=>k.value=!1)},null,512),[[K,a(k)]])]),_:1})]),_:1})}}};export{Fa as default};
