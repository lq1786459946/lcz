[{"id":"a4c1e6f4a7d260a2971f3f08fe46eea6","title":"Vue3.5 useId","content":"useIdçš„ä½œç”¨ä»–çš„ä½œç”¨ä¹Ÿæ˜¯ç”Ÿæˆå”¯ä¸€IDï¼ŒåŒä¸€ä¸ªVueåº”ç”¨é‡Œé¢æ¯æ¬¡è°ƒç”¨useIdç”Ÿæˆçš„IDéƒ½ä¸åŒã€‚\nä½¿ç”¨æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œä»£ç å¦‚ä¸‹ï¼š\n123456789101112&lt;script setup lang=&quot;ts&quot;&gt;import &#123; useId &#125; from &#x27;vue&#x27;const id0 = useId();console.log(id0); // v-0const id1 = useId();console.log(id1); // v-1const id2 = useId();console.log(id2); // v-2&lt;/script&gt;\n\nuseIdæ˜¯å¦‚ä½•å®ç°çš„æ¥çœ‹çœ‹useIdçš„æºç ï¼Œéå¸¸ç®€å•ï¼ï¼ç®€åŒ–åçš„ä»£ç å¦‚ä¸‹ï¼š\n12345678function useId(): string &#123;  const i = getCurrentInstance()  if (i) &#123;    return (i.appContext.config.idPrefix || &#x27;v&#x27;) + &#x27;-&#x27; + i.ids[0] + i.ids[1]++  &#125;  return &#x27;&#x27;&#125;\n\næ€»ç»“ç”Ÿæˆçš„IDåˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š\n\nç¬¬ä¸€éƒ¨åˆ†ä¸ºå‰ç¼€ï¼šapp.config.idPrefixï¼Œå¦‚æœæ²¡æœ‰é…ç½®ï¼Œé‚£ä¹ˆå°±æ˜¯å­—ç¬¦ä¸²vã€‚\n\nç¬¬äºŒéƒ¨åˆ†å­—ç¬¦ä¸²ï¼š-ã€‚\n\nç¬¬ä¸‰éƒ¨åˆ†çš„å€¼ä¸ºä¸€ä¸ªè‡ªå¢çš„æ•°å­—ï¼Œå­˜åœ¨vueå®ä¾‹ä¸Šé¢çš„idså±æ€§ï¼Œæ‰€æœ‰çš„vueå®ä¾‹ä¸Šé¢çš„idså±æ€§éƒ½æ˜¯æŒ‡å‘åŒä¸€ä¸ªæ•°ç»„ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆè¯´useIdå¯ä»¥åœ¨Vueåº”ç”¨å†…ç”Ÿæˆå”¯ä¸€çš„IDï¼Œè€Œä¸æ˜¯åœ¨Vueç»„ä»¶å†…ç”Ÿæˆå”¯ä¸€çš„IDã€‚\n\n\n","slug":"Vue3.5 useId","date":"2024-09-27T07:14:20.000Z","categories_index":"Vue3","tags_index":"Vue3","author_index":"æƒæ ˆ"},{"id":"56ce95bec0e493691d1f055dfbf1898e","title":"å‰ç«¯ä¼˜åŒ–é¦–æ¬¡åŠ è½½é€Ÿåº¦","content":"compression-webpack-plugincompression-webpack-plugin æ˜¯ä¸€ä¸ª Webpack æ’ä»¶ï¼Œç”¨äºå‹ç¼©ç”Ÿæˆçš„é™æ€æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨ Gzip æˆ– Brotli å‹ç¼©æ ¼å¼ã€‚è¿™æœ‰åŠ©äºå‡å°æ–‡ä»¶å¤§å°ï¼Œä»è€Œæé«˜ç½‘é¡µåŠ è½½é€Ÿåº¦å’Œæ€§èƒ½ã€‚\nclean-webpack-pluginclean-webpack-plugin æ˜¯ä¸€ä¸ª Webpack æ’ä»¶ï¼Œç”¨äºåœ¨æ¯æ¬¡æ„å»ºå‰è‡ªåŠ¨æ¸…ç†è¾“å‡ºç›®å½•ï¼ˆå¦‚ dist æ–‡ä»¶å¤¹ï¼‰ï¼Œä»¥ç¡®ä¿æ–°æ„å»ºçš„æ–‡ä»¶æ˜¯æœ€æ–°çš„ï¼Œé¿å…é—ç•™æ—§æ–‡ä»¶ã€‚\nterser-webpack-pluginterser-webpack-plugin æ˜¯ä¸€ä¸ª Webpack æ’ä»¶ï¼Œç”¨äºå‹ç¼©å’Œæ··æ·† JavaScript ä»£ç ï¼Œé€šå¸¸åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚å®ƒåŸºäº Terser å·¥å…·ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°å‡å°‘ JavaScript æ–‡ä»¶çš„ä½“ç§¯ï¼Œä»è€Œæé«˜ç½‘é¡µåŠ è½½é€Ÿåº¦ã€‚\nhtml-webpack-pluginhtml-webpack-plugin æ˜¯ä¸€ä¸ª Webpack æ’ä»¶ï¼Œç”¨äºç®€åŒ–ç”Ÿæˆ HTML æ–‡ä»¶çš„è¿‡ç¨‹ï¼Œé€šå¸¸ç”¨äºå°†æ‰“åŒ…çš„ JavaScript å’Œ CSS æ–‡ä»¶è‡ªåŠ¨æ³¨å…¥åˆ° HTML æ¨¡æ¿ä¸­ã€‚\n@vue&#x2F;preload-webpack-plugin@vue&#x2F;preload-webpack-plugin æ˜¯ä¸€ä¸ª Webpack æ’ä»¶ï¼Œä¸»è¦ç”¨äºä¼˜åŒ– Vue åº”ç”¨çš„èµ„æºåŠ è½½æ€§èƒ½ã€‚å®ƒå¯ä»¥è‡ªåŠ¨æ·»åŠ   æ ‡ç­¾åˆ°ç”Ÿæˆçš„ HTML æ–‡ä»¶ä¸­ï¼Œä»¥ä¾¿æµè§ˆå™¨é¢„åŠ è½½å…³é”®èµ„æºï¼ˆå¦‚ JavaScript å’Œ CSS æ–‡ä»¶ï¼‰ã€‚\nvue.config æ–‡ä»¶\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172const path = require(&quot;path&quot;);const px2rem = require(&quot;postcss-px2rem&quot;);const postcss = px2rem(&#123;  remUnit: 37.5, // åŸºå‡†å¤§å° baseSizeï¼Œéœ€è¦å’Œrem.jsä¸­ç›¸åŒ&#125;);let productionGzipExtensions = /\\.(js|css|json|txt|html|ico|svg)(\\?.*)?$/i;const CompressionPlugin = require(&quot;compression-webpack-plugin&quot;);const &#123; CleanWebpackPlugin &#125; = require(&quot;clean-webpack-plugin&quot;); // ç”¨äºåœ¨æ¯æ¬¡æ„å»ºå‰æ¸…ç† /dist æ–‡ä»¶å¤¹const TerserPlugin = require(&quot;terser-webpack-plugin&quot;); // ç”¨äºå‹ç¼© JavaScript ä»£ç const &#123; BundleAnalyzerPlugin &#125; = require(&quot;webpack-bundle-analyzer&quot;); //const HtmlWebpackPlugin = require(&quot;html-webpack-plugin&quot;);const PreloadPlugin = require(&quot;@vue/preload-webpack-plugin&quot;);require(&quot;events&quot;).EventEmitter.defaultMaxListeners = 0;module.exports = &#123;  // è·¯å¾„å‰ç¼€  publicPath: process.env.VUE_APP_PUBLICPATH,  assetsDir: &quot;static&quot;,  // æ˜¯å¦å¯ç”¨ eslint-loader åœ¨ä¿å­˜æ—¶æ£€æŸ¥ä»£ç   lintOnSave: true,  // æ˜¯å¦ç”Ÿæˆ source map æ–‡ä»¶ï¼Œç”Ÿäº§ç¯å¢ƒå¯ä»¥å…³é—­ä»¥æå‡æ‰“åŒ…é€Ÿåº¦  productionSourceMap: process.env.NODE_ENV == &quot;development&quot;,  // æ‰©å±• webpack-chain é…ç½®ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ– Webpack é…ç½®  chainWebpack: (config) =&gt; &#123;    // å¿½ç•¥çš„æ‰“åŒ…æ–‡ä»¶    config.externals(&#123;      vue: &quot;Vue&quot;,      &quot;vue-router&quot;: &quot;VueRouter&quot;,      vuex: &quot;Vuex&quot;,      axios: &quot;axios&quot;,      &quot;element-ui&quot;: &quot;ELEMENT&quot;,    &#125;);    // é…ç½®å…¥å£æ–‡ä»¶    const entry = config.entry(&quot;app&quot;);    entry.add(&quot;babel-polyfill&quot;).end();    entry.add(&quot;classlist-polyfill&quot;).end();    entry.add(&quot;@/mock&quot;).end();    // // é…ç½®é¢„åŠ è½½å’Œé¢„å–ï¼Œä¼˜åŒ–åŠ è½½æ€§èƒ½    // config.plugin(&quot;preload&quot;).tap((options) =&gt; &#123;    //   options[0].fileBlacklist.push(/\\.map$/, /hot-update\\.js$/);    //   return options;    // &#125;);    // ç§»é™¤ prefetch æ’ä»¶ï¼Œé¿å…åŠ è½½ä¸å¿…è¦çš„èµ„æº    // config.plugins.delete(&quot;prefetch&quot;);  &#125;,  // é…ç½® Webpack  configureWebpack: (config) =&gt; &#123;    const plugins = [      new CleanWebpackPlugin(),      new HtmlWebpackPlugin(&#123;        filename: &quot;index.html&quot;,        template: &quot;public/index.html&quot;,        inject: true,        templateParameters: &#123;          BASE_URL: &quot;/&quot;, // ä¼ é€’ BASE_URL åˆ°æ¨¡æ¿        &#125;,      &#125;),      new PreloadPlugin(&#123;        rel: &quot;preload&quot;,        include: &quot;initial&quot;,        fileBlacklist: [/\\.map$/, /hot-update\\.js$/, /vendor\\..*\\.js$/],        // æ ¹æ®éœ€è¦è¿›è¡Œæ›´å¤šé…ç½®      &#125;),    ];    if (      process.env.NODE_ENV === &quot;production&quot; ||      process.env.NODE_ENV === &quot;test&quot;    ) &#123;      plugins.push(        new CompressionPlugin(&#123;          filename: &quot;[path][base].gz&quot;,          algorithm: &quot;gzip&quot;,          test: productionGzipExtensions,          threshold: 10240,          minRatio: 0.8,          deleteOriginalAssets: false,          // exclude: /(cdn|util)\\/.*\\.(js|css|json|txt|html|ico|svg)$/i,        &#125;),        new BundleAnalyzerPlugin(&#123;          analyzerMode: &quot;static&quot;,          reportFilename: &quot;bundle-report.html&quot;,          openAnalyzer: true,        &#125;)      );      config.optimization = &#123;        minimize: true,        minimizer: [          new TerserPlugin(&#123;            terserOptions: &#123;              compress: &#123;                drop_console: true,                drop_debugger: true,              &#125;,              output: &#123;                comments: false,              &#125;,            &#125;,            parallel: true,          &#125;),        ],        splitChunks: &#123;          // Uncomment this block if needed          chunks: &quot;all&quot;,          maxInitialRequests: 5,          minSize: 30000,          maxSize: 250000,          cacheGroups: &#123;            vendor: &#123;              test: /[\\\\/]node_modules[\\\\/]/,              name(module) &#123;                const packageName = module.context.match(                  /[\\\\/]node_modules[\\\\/](.*?)([\\\\/]|$)/                )[1];                return `npm.$&#123;packageName.replace(&quot;@&quot;, &quot;&quot;)&#125;`;              &#125;,              priority: -10,            &#125;,            common: &#123;              name: &quot;common&quot;,              minChunks: 2,              priority: -20,              reuseExistingChunk: true,              chunks: &quot;all&quot;,            &#125;,          &#125;,        &#125;,      &#125;;    &#125; else if (process.env.NODE_ENV === &quot;development&quot;) &#123;      config.devtool = &quot;source-map&quot;;    &#125;    config.plugins.push(...plugins);  &#125;,  css: &#123;    extract: &#123; ignoreOrder: true &#125;,    loaderOptions: &#123;      postcss: &#123;        plugins: [postcss],      &#125;,    &#125;,  &#125;,  transpileDependencies: [&quot;ol&quot;],  // å¼€å‘æ¨¡å¼åå‘ä»£ç†é…ç½®ï¼Œç”Ÿäº§æ¨¡å¼è¯·ä½¿ç”¨Nginxéƒ¨ç½²å¹¶é…ç½®åå‘ä»£ç†  devServer: &#123;    port: 1888,    proxy: &#123;      &quot;/api&quot;: &#123;        // æœ¬åœ°æœåŠ¡æ¥å£åœ°å€        target: process.env.VUE_APP_BASE_API_COMMON_URL,        // è¿œç¨‹æ¼”ç¤ºæœåŠ¡åœ°å€, å¯ç”¨äºç›´æ¥å¯åŠ¨é¡¹ç›®        // target: &#x27;https://saber.bladex.vip/api&#x27;,        ws: true,        pathRewrite: &#123;          &quot;^/api&quot;: &quot;/&quot;,        &#125;,      &#125;,    &#125;,  &#125;,  // é€šè¿‡ç¯å¢ƒå˜é‡æ§åˆ¶æ˜¯å¦å¯ç”¨æ€§èƒ½æç¤º  //  performance: &#123;  //   hints: (process.env.NODE_ENV === &#x27;production&#x27; || process.env.NODE_ENV === &#x27;test&#x27;) ? &#x27;warning&#x27; : false  // &#125;&#125;;\n\nä¿®æ”¹æµ‹è¯•ç¯å¢ƒé…ç½®NODE_ENV æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œç”¨äºæŒ‡ç¤º Node.js åº”ç”¨ç¨‹åºçš„è¿è¡Œç¯å¢ƒã€‚å®ƒé€šå¸¸æœ‰ä¸‰ä¸ªä¸»è¦å€¼ï¼š development ã€ production å’Œ test ã€‚\nåªæœ‰ production ç”Ÿæˆç¯å¢ƒæ‰ä¼šå‹ç¼©æ–‡ä»¶ å¦‚æœæ˜¯ NODE_ENV&#x3D;test æ”¹æˆ NODE_ENV&#x3D;production\n\nä¿®æ”¹åŠ¨æ€è·¯ç”±æ‡’åŠ è½½æ–¹å¼\nåŠ è½½æ—¶æœºï¼š\nrequireï¼šåŒæ­¥åŠ è½½ï¼Œè¿è¡Œæ—¶å†³å®šã€‚\nimportï¼šå¼‚æ­¥åŠ è½½ï¼Œç¼–è¯‘æ—¶ç¡®å®šã€‚\n\n\nä½œç”¨åŸŸï¼š\nrequireï¼šåœ¨æ¨¡å—å†…éƒ¨ï¼Œä½œç”¨åŸŸè¾ƒå°é—­ã€‚\nimportï¼šæ”¯æŒå‘½åå¯¼å…¥å’Œé»˜è®¤å¯¼å…¥ï¼Œçµæ´»æ€§æ›´é«˜ã€‚\n\n\nç¯å¢ƒï¼š\nrequireï¼šä¸»è¦ç”¨äº Node.jsã€‚\nimportï¼šé€‚ç”¨äºç°ä»£æµè§ˆå™¨å’Œæ”¯æŒ ES6 çš„ç¯å¢ƒã€‚\n\n\n\n\n","slug":"å‰ç«¯ä¼˜åŒ–é¦–æ¬¡åŠ è½½é€Ÿåº¦","date":"2024-09-20T07:08:20.000Z","categories_index":"Vue2","tags_index":"Vue2","author_index":"æƒæ ˆ"},{"id":"d5edacab67506b18e45fcb0990be9618","title":"å‰ç«¯å¤§å±è‡ªé€‚åº”æ–¹æ¡ˆ","content":"æ˜“ç”¨ ğŸš€è°ƒç”¨ä»…éœ€ä¸€è¡Œä»£ç ï¼Œå³å¯é€‚é…è®¾ç½®åˆ†è¾¨ç‡ä»¥ä¸‹çš„æ‰€æœ‰å±å¹•ï¼Œæ— éœ€ä»»ä½•å…¶ä»–è¾…åŠ©\næ€§èƒ½ âš¡åªå½±å“ä¸€ä¸ªå…ƒç´ æ ·å¼ï¼Œè®¡ç®—é‡æå°\nçµæ´» ğŸ’¥å¯ä»¥ç»™é¡¹ç›®å…¨å±€è‡ªé€‚åº”ï¼Œä¹Ÿå¯ä»¥å•ç‹¬é¡µé¢åšè‡ªé€‚åº”\nåŸç†å³åœ¨ scale ç­‰æ¯”ç¼©æ”¾çš„åŸºç¡€ä¸Šï¼Œè·å–å±å¹•çš„å®½åº¦é™¤ä»¥è®¾è®¡ç¨¿çš„å®½åº¦ï¼Œè·å–åˆ°å®½åº¦æ¯”ä¾‹å€¼ï¼›è·å–å±å¹•çš„é«˜åº¦é™¤ä»¥è®¾è®¡ç¨¿çš„é«˜åº¦ï¼Œè·å–åˆ°é«˜åº¦æ¯”ä¾‹å€¼ï¼›ä½¿ç”¨ transform: scale(x, x) åŠ¨æ€ç›‘å¬æ¥å®ç°é¡µé¢çš„ç¼©æ”¾æ¯”ä¾‹ï¼Œä»è€Œè¿˜åŸ UI å›¾æ•ˆæœã€‚è¿™å¯ä»¥æ”¯æŒè®¾è®¡ç¨¿ä»¥ä¸‹çš„å„ç§åˆ†è¾¨ç‡ã€‚\nä½¿ç”¨ä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253* æ ¹æ®è§†å£å°ºå¯¸è°ƒæ•´ç»™å®šå…ƒç´ çš„ç¼©æ”¾æ¯”ä¾‹ã€‚ * @param &#123;HTMLElement&#125; e - è¦è°ƒæ•´çš„å…ƒç´ ã€‚ * @param &#123;number&#125; planWidth - å…ƒç´ çš„è®¡åˆ’å®½åº¦,é»˜è®¤1980pxã€‚ * @param &#123;number&#125; planHeight - å…ƒç´ çš„è®¡åˆ’é«˜åº¦,é»˜è®¤1080pxã€‚ */    function selfAdaption(e, planWidth = 1980, planHeight = 1080) &#123;      /**       * è·å–å®¢æˆ·ç«¯è§†å£çš„å½“å‰å°ºå¯¸ï¼Œå¹¶æ ¹æ®æœ€å°è®¡åˆ’å°ºå¯¸è¿›è¡Œè°ƒæ•´ã€‚       * @returns &#123;&#123;width: number, height: number&#125;&#125; å®¢æˆ·ç«¯è§†å£çš„è°ƒæ•´åå®½åº¦å’Œé«˜åº¦ã€‚       */      console.log(planWidth, planHeight);      const getClientDimensions = () =&gt; &#123;        // è·å–å®¢æˆ·ç«¯è§†å£çš„å½“å‰å®½åº¦å’Œé«˜åº¦        let width = document.body.clientWidth || document.documentElement.clientWidth;        let height = document.body.clientHeight || document.documentElement.clientHeight;        // å¦‚æœè®¡åˆ’é«˜åº¦å°äº1080ï¼Œåˆ™è¿›è¡Œé«˜åº¦è°ƒæ•´        if (planHeight &lt; 1080) &#123;          height -= (1080 - planHeight);        &#125;        // å¦‚æœè®¡åˆ’å®½åº¦å°äº1920ï¼Œåˆ™è¿›è¡Œå®½åº¦è°ƒæ•´        if (planWidth &lt; 1920) &#123;          width -= (1920 - planWidth);        &#125;        return &#123; width, height &#125;;      &#125;;      /**       * æ ¹æ®å½“å‰è§†å£å°ºå¯¸æ›´æ–°å…ƒç´ çš„ç¼©æ”¾æ¯”ä¾‹ã€‚       */      const updateScale = () =&gt; &#123;        // è·å–è°ƒæ•´åçš„å®¢æˆ·ç«¯å°ºå¯¸        const &#123; width, height &#125; = getClientDimensions();        // è®¡ç®—å®½åº¦å’Œé«˜åº¦çš„ç¼©æ”¾æ¯”ä¾‹        const ratioWidth = width / planWidth;        const ratioHeight = height / planHeight;        // å¯¹å…ƒç´ åº”ç”¨ç¼©æ”¾å˜æ¢        e.style.transform = `scale($&#123;ratioWidth&#125;, $&#123;ratioHeight&#125;)`;      &#125;;      // è®¾ç½®å…ƒç´ çš„åˆå§‹æ ·å¼      e.style.cssText += `    transform-origin: 0 0 0;    display: flex;    min-width: auto;    min-height: auto;    overflow: hidden;    width: $&#123;planWidth&#125;px;    height: $&#123;planHeight&#125;px;  `;      // åˆå§‹æ›´æ–°ç¼©æ”¾æ¯”ä¾‹      updateScale();      // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼Œåœ¨çª—å£è°ƒæ•´å¤§å°æ—¶æ›´æ–°ç¼©æ”¾æ¯”ä¾‹      window.addEventListener(&#x27;resize&#x27;, updateScale);    &#125;selfAdaptionï¼ˆeï¼‰ä¼ é€’çš„è¦è‡ªé€‚åº”æœ€å¤–å±‚dom\n\n\n\n\n\n\n\n\n\n\nä½¿ç”¨ transform: scale è‡ªé€‚åº”åï¼Œåœ°å›¾ä¸Šç‚¹å‡»äº‹ä»¶å¤±æ•ˆï¼Œè§£å†³åŠæ³•ï¼š\n12345678910resetMapSize() &#123;Â Â       let mapContent = document.getElementById(&quot;map&quot;);Â Â       mapContent.style.transform = `scale($&#123;1 / ratioWidth&#125;,$&#123;1 / ratioHeight&#125;)`Â Â     &#125;Â Â // ç”¨å®Œåè®°å¾—é”€æ¯ç›‘å¬äº‹ä»¶ æ¯”å¦‚ vue ä¸­Â Â destroyed () &#123;Â Â     window.removeEventListener(&#x27;resize&#x27;,this.resetMapSize)Â Â   &#125;Â \n","slug":"å‰ç«¯å¤§å±è‡ªé€‚åº”æ–¹æ¡ˆ","date":"2024-09-12T02:58:20.000Z","categories_index":"JS","tags_index":"JS","author_index":"æƒæ ˆ"},{"id":"32c8c23c6d89385feba3d0e7e602221c","title":"Vue3.5 æºç è§£æï¼Œ useTemplateRef å®ç°åŸç†","content":"useTemplateRef çš„ä½œç”¨useTemplateRef æ˜¯ç”¨æ¥ä¸“é—¨è·å– dom æˆ–è€… ç»„ä»¶ç¤ºä¾‹ çš„ã€‚\nåœ¨ä¹‹å‰ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è·å– dom ï¼Œé‚£ä¹ˆéœ€è¦è¿™ä¹ˆåšï¼š\n\nå…ˆä¸º dom æŒ‡å®š ref å±æ€§ï¼Œå¹¶ä¸”ç»™å®šä¸€ä¸ª value å€¼\n\nåœ¨ js ä¸­ï¼Œå£°æ˜ value å€¼çš„å˜é‡ï¼Œå¹¶ä¸”ç»™å®šåˆå§‹å€¼ä¸º ç©ºçš„ ref\n12345678910&lt;script setup&gt;// é¦–å…ˆï¼Œæ‚¨å®šä¹‰äº†ä¸€ä¸ªå€¼ä¸ºundefinedæˆ–ç©ºçš„ref// å¹¶ä»¥æ‚¨æƒ³è¦çš„æ–¹å¼å‘½åç”Ÿæˆçš„å¯ç”¨å†…å®¹const divEl = ref();&lt;/script&gt;&lt;template&gt;&lt;!-- ç„¶åä½¿ç”¨ä¸â€œrefâ€å±æ€§çš„å€¼ç›¸åŒçš„åç§°,åœ¨æ¨¡æ¿ä¸­çš„æŸä¸ªåœ°æ–¹ --&gt;&lt;div ref=&quot;divEl&quot; &gt;&lt;/div&gt;&lt;/template&gt;\n\nä½†æ˜¯ï¼Œè¿™ç§æ–¹æ¡ˆå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯ï¼šref é€šå¸¸ç”¨æ¥å£°æ˜å“åº”å¼æ•°æ®ã€‚å½“ ref ä¸å…‰ä½œä¸ºå“åº”å¼å£°æ˜ï¼Œè¿˜è¢«ä½œä¸º dom å®ä¾‹çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±éš¾å…æœ‰ç‚¹è®©äººç–‘æƒ‘äº†ã€‚\næ‰€ä»¥åœ¨ï¼ˆ3.5 ä¹‹åï¼‰ Vue æ¨å‡ºäº†ä¸€ä¸ªæ–°çš„ API å«åš useTemplateRef æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š\n123456789101112131415&lt;template&gt; &lt;div&gt;  &lt;div ref=&quot;el&quot;&gt;ç¨‹åºå‘˜Sunday&lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;import &#123; onMounted, useTemplateRef &#125; from &#x27;vue&#x27;const elRef = useTemplateRef(&#x27;el&#x27;)onMounted(() =&gt; &#123; console.log(elRef.value) // dom ç¤ºä¾‹&#125;)&lt;/script&gt;\n\nuseTemplateRef çš„å®ç°åŸç†1234567891011121314export function useTemplateRef(key: Keys) &#123;  const i = getCurrentInstance();  const r = shallowRef(null);  if (i) &#123;    const refs = i.refs === EMPTY_OBJ ? (i.refs = &#123;&#125;) : i.refs;    Object.defineProperty(refs, key, &#123;      enumerable: true,      get: () =&gt; r.value,      set: (val) =&gt; (r.value = val),    &#125;);  &#125;  return r;&#125;\n\nç¬¬ä¸€ä¸ª iï¼šé€šè¿‡ getCurrentInstance() è·å–ï¼Œå¾—åˆ°çš„æ˜¯ ä¸Šä¸‹æ–‡å®ä¾‹ã€‚â€‹ æ¥ä¸‹æ¥ï¼Œé€šè¿‡ i.refs è·å–åˆ°æ‰€æœ‰çš„ ref æ•°æ®ï¼Œç„¶åä¸º refs æ·»åŠ  Object.defineProperty çš„ç›‘å¬ï¼Œç›‘å¬çš„å±æ€§åå°±æ˜¯å…¥å‚ keyã€‚å¦‚æœä»¥ useTemplateRef(â€˜elâ€™) ä¸ºä¾‹ï¼Œé‚£ä¹ˆå°±æ˜¯ â€œelâ€ã€‚\né€šè¿‡ç›‘å¬å¯¹åº” key çš„ get å’Œ set æ ‡è®°ï¼Œè¿™é‡Œ é‡ç‚¹å…³æ³¨ set æ ‡è®°ï¼Œåœ¨è¿™é‡Œä¸º r.value è¿›è¡Œäº†èµ‹å€¼ï¼Œå³ï¼šr.value &#x3D; valã€‚è¿™é‡Œçš„ val å°±æ˜¯ refs[key] çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„ ref ç»„ä»¶å®ä¾‹ã€‚\nç¬¬äºŒä¸ª rï¼šé€šè¿‡ shallowRef(null) è·å–ï¼Œä½œä¸ºè¿”å›å€¼r ä½œä¸º useTemplateRef çš„è¿”å›å€¼å³ æœ€ç»ˆè·å–çš„ç»„ä»¶ç¤ºä¾‹ã€‚\n","slug":"Vue3.5 æºç è§£æï¼Œ useTemplateRef å®ç°åŸç†","date":"2024-09-06T06:07:04.000Z","categories_index":"Vue3","tags_index":"Vue3","author_index":"æƒæ ˆ"},{"id":"c34479c7fc43ef2eede71b250f18b4aa","title":"refå’ŒreactiveåŸç†","content":"refref çš„å¤„ç†ä¸Šå°±æ˜¯å…ˆå°†åŸºæœ¬ç±»å‹è½¬æ¢æˆå¯¹è±¡ç±»å‹ï¼Œç„¶ååœ¨é‡Œé¢åŠ å…¥ä¸€ä¸ª this._v_isRef çš„å¸ƒå°”ç±»å‹çš„å€¼ï¼Œæ¥åˆ¤æ–­å®ƒæ˜¯ä¸æ˜¯è¢« ref å¤„ç†äº†ï¼Œç„¶åå°†ä¸Šé¢å†™çš„ track å’Œ trigger å‡½æ•°å†™å…¥ get å’Œ set å‡½æ•°é‡Œé¢ï¼Œå¦‚æœä½ è¦å¤„ç†çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆ vue3 å°±ä¼šæŠŠå®ƒæ”¹æˆ reactive çš„å¤„ç†æ–¹å¼ã€‚æ‰€ä»¥è¯´ï¼Œref å¯ä»¥å¤„ç†åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹ï¼Œè€Œ reactive å¤„ç†çš„æ˜¯å¼•ç”¨ç±»å‹ï¼ŒäºŒè€…çš„åŒºåˆ«ä¸æ˜¯å¾ˆå¤§ã€‚\nreactive\né¦–å…ˆæˆ‘ä»¬å–ä¸€ä¸ªå¯¹è±¡{a: 1}\n\nç„¶åè°ƒç”¨å°è£…å¥½çš„ reactive å‡½æ•° const state &#x3D; reactive({a: 1})\n\nè¿™ä¸ªæ—¶å€™å°±ä¼šè¿›å…¥ä»£ç ç‰‡æ®µ 1.1 é‡Œé¢çš„ reactive å‡½æ•°ï¼Œåœ¨è¿›å…¥ createReactiveObject å‡½æ•°\n\nç„¶åå°±ä¼šå¯¹æˆ‘ä»¬è¦ä»£ç†çš„å¯¹è±¡è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ˜¯å¯¹è±¡çš„è¯å°±ç»§ç»­ä¸‹å»\n\nåœ¨åˆ¤æ–­æˆ‘ä»¬æ˜¯ä¸æ˜¯å·²ç»ä»£ç†è¿‡è¿™ä¸ªå¯¹è±¡ï¼ˆå°±æ˜¯æˆ‘ä»¬é¢„å…ˆç©ºå‡ºä¸€ä¸ªä½ç½®ï¼Œå°†å·²ç»ä»£ç†è¿‡çš„å¯¹è±¡å…¨éƒ¨å­˜å‚¨ä¸‹æ¥ï¼‰ï¼Œä»£ç†è¿‡å°±è¿”å›ä»£ç†åçš„å€¼ï¼Œæ²¡æœ‰çš„è¯å°±åˆ›å»ºä¸€ä¸ªæ–°çš„ä»£ç†\n\nå†ç„¶åç»‘å®šä¸Š proxy å‡½æ•°é‡Œé¢çš„ get å’Œ set å›è°ƒå‡½æ•°ï¼ˆå¯ä»¥çœ‹åˆ°ä»£ç  1.2ï¼‰\n\n\n","slug":"refå’ŒreactiveåŸç†","date":"2024-08-27T08:30:20.000Z","categories_index":"Vue3","tags_index":"Vue3","author_index":"æƒæ ˆ"},{"id":"2e839452302506867eaaf60fd116d0d6","title":"vue3 Api","content":"defineProps()å’Œ defineEmits()\nv-model:childValueModel ä¿®æ”¹äº†å€¼ æœ¬æ¥åº”è¯¥æ˜¯ modeValue\ndefineEmites() ä½¿ç”¨è¦æ·»åŠ  update:\n1&lt;defineModelChild v-model;childValueModel=&quot;childValue&quot;&gt;&lt;/defineModelChild&gt;\n\nâ€‹\n123456789&lt;template&gt;&lt;div&gt;&#123;&#123; childValueModel &#125;&#125;&lt;/div&gt;&lt;button @click=&quot;myEmits(&#x27;update:childValueModel&#x27;, childValueModel + 1)&quot;&gt;æ•°æ® + 1&lt;/button&gt;&lt;/template&gt;&lt;script setup&gt;const myProps = defineProps([&#x27;childValueModel&#x27;]);const myEmits= defineEmits([&#x27;update:childValueModel&#x27;]);&lt;/script&gt;\n\nçˆ¶ç»„ä»¶\n12345678910111213&lt;script setup&gt;import HelloWorld from &#x27;./components/defineProps-----defineEmits .vue&#x27;//çˆ¶ç»„ä»¶function count(value) &#123;  console.log(value);&#125;&lt;/script&gt;&lt;template&gt;  &lt;HelloWorld a=&quot;qwdqwd&quot;    @count=&#x27;count&#x27; /&gt;&lt;/template&gt;\n\nå­ç»„ä»¶\n1234567891011121314151617&lt;script setup&gt;import &#123; ref &#125; from &quot;vue&quot;//å­ç»„ä»¶let count = ref(0)let emit = defineEmits([&quot;count&quot;])const props = defineProps((&#123;  a: String&#125;))function increment() &#123;  count.value++  emit(&quot;count&quot;, count.value)&#125;&lt;/script&gt;&lt;template&gt;  &lt;button @click=&quot;increment&quot;&gt;&#123;&#123; count &#125;&#125; &#123;&#123;props.a&#125;&#125;&lt;/button&gt;&lt;/template&gt;\n\ndefineModel() 3.4+ç‰ˆæœ¬\ndefineModel å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œæ˜¯å¯¹ v-model å†åŒ…è£…çš„è¯­æ³•ç³–\ndefineModel å¸®ä½ è·å–åˆ°äº† prop ä¸­çš„ modelValue ï¼Œä¸”å½“ å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨å¸®ä½ è°ƒç”¨ update:modelValue\n123456const myProps = defineProps([&quot;modelValue&quot;]);const myEmits = defineEmits([&quot;update:modelValue&quot;]);// è¯´ç™½äº†ï¼Œè¿™é‡Œçš„ modelValue ç­‰ä»·äº props.modelValue + emit(&#x27;update:modelValue&#x27;)// defineModel å¸®ä½  å°è£…äº† modelValue å’Œ update:modelValueconst modelValue = defineModel();\n\nçˆ¶ç»„ä»¶\n12345678910&lt;template&gt;  &lt;defineModelChild v-model=&quot;childValue&quot;&gt;&lt;/defineModelChild&gt;&lt;/template&gt;&lt;script setup&gt;import &#123; ref &#125; from &#x27;vue&#x27;;import defineModelChild from &#x27;./components/defineModelChild.vue&#x27;;const childValue = ref(0);&lt;/script&gt;\n\nv-model å­ç»„ä»¶\n1234567891011&lt;template&gt;&lt;template&gt;  &lt;div&gt;&#123;&#123; modelValue &#125;&#125;&lt;/div&gt;  &lt;button @click=&quot;myEmits(&#x27;update:modelValue&#x27;, modelValue + 1)&quot;&gt;æ•°æ® + 1&lt;/button&gt;&lt;/template&gt;&lt;script setup&gt;defineProps([&#x27;modelValue&#x27;]);const myEmits = defineEmits([&#x27;update:modelValue&#x27;]);&lt;/script&gt;\n\ndefineModel() å­ç»„ä»¶\n12345678&lt;template&gt;  &lt;div&gt;&#123;&#123; modelValue &#125;&#125;&lt;/div&gt;  &lt;button @click=&quot;modelValue++&quot;&gt;æ•°æ® + 1&lt;/button&gt;&lt;/template&gt;&lt;script setup&gt;const modelValue = defineModel();&lt;/script&gt;\n\ndefineExpose å­ä¼ çˆ¶\nï¼ˆç”¨åœ¨å­ç»„ä»¶ï¼Œæš´éœ²æƒ³ä¼ é€’çš„å€¼æˆ–æ–¹æ³•ï¼Œçˆ¶ç»„ä»¶é€šè¿‡ ref å±æ€§è·å–å­ç»„ä»¶æš´éœ²çš„ï¼‰\nä½¿ç”¨ script setup çš„ç»„ä»¶æ˜¯é»˜è®¤å…³é—­çš„â€”â€”å³é€šè¿‡æ¨¡æ¿å¼•ç”¨æˆ–è€… $parent é“¾è·å–åˆ°çš„ç»„ä»¶çš„å…¬å¼€å®ä¾‹ï¼Œä¸ä¼šæš´éœ²ä»»ä½•åœ¨ script setup ä¸­å£°æ˜çš„ç»‘å®šã€‚\né‚£ä¹ˆï¼Œé€šè¿‡ defineExpose ç¼–è¯‘å™¨å®æ¥æ˜¾å¼æŒ‡å®šåœ¨\nç„¶åï¼Œçˆ¶ç»„ä»¶é€šè¿‡ ref å±æ€§è®¿é—®å­ç»„ä»¶\nçˆ¶ç»„ä»¶ï¼š\n123456789101112131415161718&lt;Index ref=&quot;childeRef&quot;&gt;&lt;/Index&gt;&lt;script setup&gt;    import Index from &quot;./index.vue&quot;;    const childeRef = ref();    function test() &#123;        console.log(childeRef.value.msg) // Hello World    &#125;    onMounted(() =&gt; &#123;      let flag:boolean = true;      let value:number= 5;      childeRef.value.childFn(flag,value) // è°ƒç”¨å­ç»„ä»¶å‡½æ•°, è¾“å‡º 6    &#125;)&lt;/script&gt;\n\nå­ç»„ä»¶ï¼š\n1234567891011121314151617&lt;script setup&gt;    import &#123;ref&#125; from &quot;vue&quot;;    function childFn(typeï¼šboolean, dataï¼šnumber) &#123;        console.log(&#x27;æˆ‘æ˜¯å­ç»„ä»¶&#x27;);        if(data)&#123;           let value = data + 1;           return value;        &#125;    &#125;    const msg = &#x27;Hello World&#x27;;    defineExpose(&#123; //æš´éœ²æƒ³è¦ä¼ é€’çš„å€¼æˆ–æ–¹æ³•        msg,        childFn,    &#125;);&lt;/script&gt;\n\ndefineOptions 3.3+\n123456789&lt;script setup&gt;import &#123; defineOptions &#125; from &#x27;vue&#x27;defineOptions(&#123;name: &#x27;Foo&#x27;,//ç»„ä»¶é‡å‘½å inheritAttrs: false,//...æ›´å¤šè‡ªå®šä¹‰å±æ€§&#125;)&lt;/script&gt;\n\ncomputed è®¡ç®—å±æ€§\n1234567891011121314151617181920212223&lt;script setup &gt;import &#123; computed, reactive &#125; from &quot;vue&quot;;const author = reactive(&#123;  books: [    &#x27;Vue 2 - Advanced Guide&#x27;,    &#x27;Vue 3 - Basic Guide&#x27;,    &#x27;Vue 4 - The Mystery&#x27;  ]&#125;)const publishedBooksMessage = computed(() =&gt; &#123;  return author.books.length &gt; 0 ? &#x27; Yes&#x27; : &quot;No&quot;&#125;)&lt;/script&gt;&lt;template&gt;  &lt;div&gt;    &#123;&#123; publishedBooksMessage &#125;&#125;  &lt;/div&gt;&lt;/template&gt;&lt;style  scoped&gt;&lt;/style&gt;\n\ncomputed ä¼ å‚\n12345678910111213141516171819202122232425262728&lt;script setup &gt;import &#123; computed, reactive &#125; from &quot;vue&quot;;const author = reactive(&#123;  name: &#x27;John Doe&#x27;,  books: [    &#x27;Vue 2 - Advanced Guide&#x27;,    &#x27;Vue 3 - Basic Guide&#x27;,    &#x27;Vue 4 - The Mystery&#x27;  ]&#125;)const publishedBooksMessage = computed(() =&gt; &#123;  return function (value) &#123;    console.log(value)    return author.books.length &gt; 0 ? &#x27; Yes&#x27; : &quot;No&quot;  &#125;&#125;)&lt;/script&gt;&lt;template&gt;  &lt;div&gt;    &lt;p&gt;Has published books:&lt;/p&gt;    &#123;&#123; publishedBooksMessage(12) &#125;&#125;  &lt;/div&gt;&lt;/template&gt;&lt;style  scoped&gt;&lt;/style&gt;\n\nwatch ç›‘å¬\né»˜è®¤å¼€å¯æ·±åº¦ç›‘å¬\n123456789101112131415161718192021222324252627282930&lt;script setup &gt;import &#123; ref, watch &#125; from &quot;vue&quot;const count = ref(0)const btnClick = () =&gt; &#123;  count.value++;&#125;// âœ… æ–¹æ³•ä¸€ï¼Œä¼ é€’å“åº”å¯¹è±¡watch(count, (newValue, oldValue) =&gt; &#123;  console.log(newValue, oldValue)&#125;)// âŒ æ–¹æ³•äºŒï¼šä¼ é€’å“åº”å¯¹è±¡ä¸‹çš„å±æ€§watch(user.name, (value) =&gt; &#123;    console.log(value) // ç›‘å¬å¤±è´¥ï¼Œæ²¡è¾“å‡º&#125;)// âœ… æ–¹æ³•ä¸‰ï¼šä¼ é€’å‡½æ•°ï¼Œå‡½æ•°è¿”å›å“åº”å¯¹è±¡å±æ€§watch(() =&gt; user.name, (value) =&gt; &#123;    console.log(value); // ç›‘å¬æˆåŠŸï¼Œè¾“å‡º jake&#125;)&lt;/script&gt;&lt;template&gt;  &lt;div&gt;    &lt;button @click=&quot;btnClick&quot;&gt;ç‚¹å‡»&lt;/button&gt;    &#123;&#123; count &#125;&#125;  &lt;/div&gt;&lt;/template&gt;&lt;style  scoped&gt;&lt;/style&gt;\n\nwatchEffect çš„ä½¿ç”¨\nwatchEffect ä¹Ÿæ˜¯ä¸€ä¸ªå¸§å¬å™¨ï¼Œæ˜¯ä¸€ä¸ªå‰¯ä½œç”¨å‡½æ•°ã€‚ å®ƒä¼šç›‘å¬å¼•ç”¨æ•°æ®ç±»å‹çš„æ‰€æœ‰å±æ€§ï¼Œä¸éœ€è¦å…·ä½“åˆ°æŸä¸ªå±æ€§ï¼Œä¸€æ—¦è¿è¡Œå°±ä¼šç«‹å³ç›‘å¬ï¼Œç»„ä»¶å¸è½½çš„æ—¶å€™ä¼šåœæ­¢ç›‘å¬ã€‚\n123456789101112131415161718192021222324&lt;script setup &gt;import &#123; reactive, ref, watch, watchEffect &#125; from &quot;vue&quot;const count = reactive(&#123; name: &#x27;112&#x27;, data: [&quot;ä½ å¥½&quot;] &#125;)const btnClick = () =&gt; &#123;  count.data[0] = &#x27;è¢«æ”¹äº†&#x27;&#125;watchEffect(() =&gt; &#123;  console.log(count.data[0]);&#125;) watch([count,obj],() =&gt; &#123;      console.log(&#x27;ç›‘å¬çš„å¤šä¸ªæ•°æ®æ”¹å˜äº†&#x27;)    &#125;)&lt;/script&gt;&lt;template&gt;  &lt;div&gt;    &lt;button @click=&quot;btnClick&quot;&gt;ç‚¹å‡»&lt;/button&gt;    &#123;&#123;count.data[0]&#125;&#125;  &lt;/div&gt;&lt;/template&gt;&lt;style  scoped&gt;&lt;/style&gt;\n\nstopWatchEffect åœæ­¢ç›‘å¬\n1234567const stop = watchEffect(() =&gt; &#123;  console.log(&quot;name:&quot;, obj.name);&#125;);const stopWatchEffect = () =&gt; &#123;  console.log(&quot;åœæ­¢ç›‘å¬&quot;);  stop();&#125;;\n\nonInvalidate å‡½æ•° è§£å†³æ‰§è¡Œé¡ºåºä¹±çš„é—®é¢˜\n","slug":"vue3 Api","date":"2024-06-13T08:39:58.000Z","categories_index":"Vue3","tags_index":"Vue3","author_index":"æƒæ ˆ"}]