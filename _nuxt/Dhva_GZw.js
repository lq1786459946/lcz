import{_ as ce,h as q,e as z,r as y,b as I,j as a,l as t,s as m,t as l,u as e,z as x,q as d,L as j,p as _,v as k,c as P,x as O,F as $,n as me,a as h,y as K,i as ue,as as pe,aB as fe,aW as ye}from"./4Ktyr8G_.js";import{a as R}from"./-VStuZKb.js";import{R as ge}from"./BUGpYFCF.js";import{b as G,a as J,V as Q}from"./BVo5q2wa.js";import{V as X}from"./awntUYIY.js";import{V as S,a as n}from"./DlxhMtx2.js";import{V as Y}from"./B8vluWYP.js";import{V as U}from"./U2mkAfXu.js";import{F as he,g as _e,a as ke,b as be}from"./DyFxbKNx.js";import{V as Fe}from"./DWkeRmZu.js";import{V as Te}from"./er4xnGW9.js";import{V as ve}from"./BuQiNUq5.js";import{V as we}from"./BgxtWXOh.js";import"./CryL740R.js";/* empty css        */import"./CDo1OVWQ.js";import"./CAblgYOR.js";import"./BbY-I90a.js";import"./9bGsdqAp.js";import"./C3lmZdGn.js";import"./By1GlJfL.js";import"./D2UNG8S4.js";import"./BxUkLsYu.js";import"./DWGaNmQL.js";import"./M4sPlSOX.js";import"./ZuLc9MOj.js";import"./Vc9XBB0d.js";import"./C01xEgWl.js";import"./B01AR6UH.js";import"./BNhRW4Wg.js";import"./BrBayNQn.js";import"./CdJNxXyl.js";import"./BhH3YVHS.js";import"./r4KKFxWL.js";import"./BJWT1Lrs.js";import"./D-5uWIj4.js";import"./D9lrzzyk.js";const Ve={class:"d-flex mb-7"},Se={class:"font-weight-medium"},xe={class:"font-weight-medium"},ze=["color"],Ce={class:"mt-2"},Le={class:"d-flex mb-7"},De={__name:"feedback-info",emits:["close"],setup(ee,{expose:g,emit:T}){const b=q(),{t:i}=z(),{setLocaleMessage:v}=z({useScope:"global"}),w=T;let r=y({});const V=()=>{w("close")};return g({openDetail:async u=>{await me(),u.otherFjList&&u.otherFjList.length&&(u.otherFjListUrl=u.otherFjList[0].link),R(u,v),r.value=u}}),(u,A)=>(h(),I(Q,null,{default:a(()=>[t(J,null,{default:a(()=>[t(G,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[m("span",null,l(e(i)("myFeedback.ProblemFeedback")),1),t(X),t(x,{color:"primary",onClick:V},{default:a(()=>[t(j,{icon:"ri-arrow-go-back-line",class:"mr-2"}),d(" "+l(e(i)("myFeedback.Back")),1)]),_:1})]),_:1})]),_:1}),t(U,null,{default:a(()=>[m("div",Ve,[m("h4",null,l(e(i)("myFeedback.FeedbackInfo")),1)]),t(S,{class:"justify-lg-space-between"},{default:a(()=>[t(n,{cols:"6",md:"2"},{default:a(()=>[m("span",Se,l(e(i)("myFeedback.FeedbackTime"))+":",1)]),_:1}),t(n,{cols:"6",md:"10"},{default:a(()=>[d(l(e(r).createTime),1)]),_:1}),t(n,{cols:"6",md:"2"},{default:a(()=>[m("span",xe,l(e(i)("myFeedback.FeedbackStatus"))+":",1)]),_:1}),t(n,{cols:"6",md:"10"},{default:a(()=>[m("div",{color:e(r).color},l(e(i)(`responseStatus_${e(r).id}`)),9,ze)]),_:1}),t(n,{cols:"6",md:"2",class:"font-weight-medium"},{default:a(()=>[d(l(e(i)("myFeedback.FeedbackType"))+":",1)]),_:1}),t(n,{cols:"6",md:"10"},{default:a(()=>[d(l(e(i)(`feedbackType_${e(r).id}`)),1)]),_:1}),t(n,{cols:"6",md:"2",class:"font-weight-medium"},{default:a(()=>[d(l(e(i)("myFeedback.IssueType"))+": ",1)]),_:1}),t(n,{cols:"6",md:"10"},{default:a(()=>[d(l(e(i)(`issueType_${e(r).id}`)),1)]),_:1}),t(n,{cols:"6",md:"2",class:"font-weight-medium"},{default:a(()=>[d(l(e(i)("myFeedback.AnalysisType"))+": ",1)]),_:1}),t(n,{cols:"6",md:"10"},{default:a(()=>[_(m("span",null,l(e(r).analysisTypeNameZh),513),[[k,e(b).getLanguage=="zh"]]),_(m("span",null,l(e(r).analysisTypeNameEn),513),[[k,e(b).getLanguage=="en"]])]),_:1}),t(n,{cols:"6",md:"2",class:"font-weight-medium"},{default:a(()=>[d(l(e(i)("myFeedback.AnalysisTask"))+": ",1)]),_:1}),t(n,{cols:"6",md:"10"},{default:a(()=>[d(l(e(r).analysisTaskName),1)]),_:1}),t(n,{cols:"12",md:"2",class:"font-weight-medium"},{default:a(()=>[d(l(e(i)("myFeedback.IssueContent"))+":",1)]),_:1}),t(n,{cols:"12",md:"10"},{default:a(()=>[d(l(e(r).issueContent),1)]),_:1}),t(n,{cols:"12",md:"2",class:"font-weight-medium"},{default:a(()=>[d(l(e(i)("myFeedback.ImageFileId"))+": ",1)]),_:1}),t(n,{cols:"12",md:"10"},{default:a(()=>[_(t(S,null,{default:a(()=>[(h(!0),P($,null,O(e(r).imageFjList,o=>(h(),I(n,{cols:"6",md:"3",key:o.in},{default:a(()=>[t(K,{"aspect-ratio":1,"max-height":"280",src:o.link,alt:""},null,8,["src"])]),_:2},1024))),128))]),_:1},512),[[k,e(r).imageFjList]])]),_:1}),t(n,{cols:"12",md:"2",class:"font-weight-medium"},{default:a(()=>[d(l(e(i)("myFeedback.OtherFileId"))+": ",1)]),_:1}),t(n,{cols:"12",md:"10"},{default:a(()=>{var o;return[_(m("div",Ce,[t(e(ge),{ref:"videoPlayer",src:e(r).otherFjListUrl,height:u.$vuetify.display.mdAndUp?440:250,controls:"","plays-inline":"",class:"w-100 rounded w-800"},null,8,["src","height"])],512),[[k,(o=e(r))==null?void 0:o.otherFjListUrl]])]}),_:1})]),_:1}),t(Y,{class:"mb-5 mt-5"}),m("div",Le,[m("h4",null,l(e(i)("myFeedback.ReplyInfo")),1)]),t(S,null,{default:a(()=>[t(n,{cols:"12",md:"2",class:"font-weight-medium"},{default:a(()=>[d(l(e(i)("myFeedback.ReplyDescription"))+":",1)]),_:1}),t(n,{cols:"12",md:"10"},{default:a(()=>[d(l(e(r).responseContent),1)]),_:1}),t(n,{cols:"12",md:"2",class:"font-weight-medium"},{default:a(()=>[d(l(e(i)("myFeedback.ReplyImage"))+":",1)]),_:1}),t(n,{cols:"12",md:"10"},{default:a(()=>[t(S,null,{default:a(()=>[(h(!0),P($,null,O(e(r).responseFjList,o=>(h(),I(n,{cols:"6",md:"3",key:o.in},{default:a(()=>[t(K,{src:o.link,alt:""},null,8,["src"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}},Ee=ce(De,[["__scopeId","data-v-59df33d5"]]),Ie={class:"d-flex justify-center"},je={class:"d-flex flex-wrap justify-end gap-y-2 mt-2"},_t={__name:"myFeedback",async setup(ee){let g,T;const b=q(),{t:i}=z(),{setLocaleMessage:v}=z({useScope:"global"});let w=y({}),r=y(1),V=y(null),C=y(null);const u=y(!1),A=y("700px"),o=y({total:0,currentPage:1,pageSize:10,options:[10,20,25,50,100]});let te=[{title:"反馈时间",key:"createTime",zh:"反馈时间",en:"Submission Time",sortable:!1,minWidth:200,width:200,align:"center"},{title:"反馈类型",key:"feedbackType",zh:"反馈类型",en:"Feedback Type",sortable:!1,minWidth:120,width:120,align:"center"},{title:"反馈事项",key:"issueType",zh:"反馈事项",en:"Feedback Item",sortable:!1,width:240,align:"center"},{title:"问题描述",key:"issueContent",zh:"问题描述",en:"Issue Description",minWidth:300,sortable:!1},{title:"答复状态",key:"responseStatus",zh:"答复状态",en:"Response Status",sortable:!1,minWidth:120,width:120,align:"center"},{title:"操作",key:"actions",zh:"操作",en:"Action",sortable:!1,minWidth:120,width:120,align:"center"}],B=y([]),ae=[{id:1,color:"#FF8000",zh:"反馈中",en:"Feedback in progress"},{id:2,color:"#0BA70B",zh:"已答复",en:"Reply received"}];const se=ue(()=>te.map(c=>({...c,title:c[b.getLanguage]||c.key})));pe(()=>{window.addEventListener("resize",L),L()}),fe(()=>{window.removeEventListener("resize",L)});const le=async()=>(await ke({code:"feedback_type"})).data,Z=([g,T]=ye(()=>le()),g=await g,T(),g),oe=()=>{r.value=1,o.value.currentPage=1,M({page:o.value.currentPage,itemsPerPage:o.value.pageSize})};let ie=["#002AE3","#E35300","#56CA04","#FF4B51"];const M=({page:c,itemsPerPage:f})=>{u.value=!0;let s={memberId:b.getUserData.user_id};_e(c,f,s).then(N=>{let D=N.data;for(let p of D.records){let W=Z.find(F=>F.dictKey==p.feedbackType);p.feedbackTypeZh=W.dictValue,p.feedbackTypeEn=W.remark,p.feedbackTypeColor=ie[p.feedbackType]||"#E35300";let H=Z.find(F=>F.dictKey==p.issueType);p.issueTypeZh=H.dictValue,p.issueTypeEn=H.remark;let E=ae.find(F=>F.id==p.responseStatus);p.responseStatusZh=E.zh,p.responseStatusEn=E.en,p.color=E.color,R(p,v)}B.value=D.records,o.value.total=D.total,u.value=!1}).catch(()=>{u.value=!1})},L=()=>{A.value=`${window.innerHeight-340}px`},ne=c=>{be(c.id).then(f=>{let s=f.data;s.feedbackTypeZh=c.feedbackTypeZh,s.feedbackTypeEn=c.feedbackTypeEn,s.issueTypeZh=c.issueTypeZh,s.issueTypeEn=c.issueTypeEn,s.responseStatusZh=c.responseStatusZh,s.responseStatusEn=c.responseStatusEn,s.color=c.color,R(s,v),w.value=s,C.value.openDetail(s),r.value=2})},re=()=>{V.value.InitForm()},de=()=>{r.value=1};return(c,f)=>(h(),P($,null,[_(t(Q,null,{default:a(()=>[t(J,null,{default:a(()=>[t(G,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[m("span",null,l(e(i)("myFeedback.MyFeedback")),1),t(X),t(x,{color:"primary",onClick:re},{default:a(()=>[t(j,{icon:"ri-edit-2-line",class:"mr-2"}),d(" "+l(e(i)("myFeedback.Feedback")),1)]),_:1})]),_:1})]),_:1}),t(U,null,{default:a(()=>[t(Fe,{"fixed-header":"","items-per-page":e(o).pageSize,"onUpdate:itemsPerPage":f[2]||(f[2]=s=>e(o).pageSize=s),page:e(o).currentPage,"onUpdate:page":f[3]||(f[3]=s=>e(o).currentPage=s),"items-per-page-options":e(o).options,"items-length":e(o).total,headers:e(se),items:e(B),loading:e(u),"item-value":"id","onUpdate:options":M},{"item.feedbackType":a(({item:s})=>[t(x,{variant:"text",color:s.feedbackTypeColor},{default:a(()=>[d(l(e(i)(`feedbackType_${s.id}`)),1)]),_:2},1032,["color"])]),"item.issueType":a(({item:s})=>[d(l(e(i)(`issueType_${s.id}`)),1)]),"item.responseStatus":a(({item:s})=>[t(we,{color:s.color,class:"font-weight-medium",size:"small",variant:"tonal"},{default:a(()=>[d(l(e(i)(`responseStatus_${s.id}`)),1)]),_:2},1032,["color"])]),"item.actions":a(({item:s})=>[m("div",Ie,[t(x,{variant:"text",size:"big",color:"primary",onClick:N=>ne(s)},{default:a(()=>[t(j,{icon:"ri-eye-line"})]),_:2},1032,["onClick"])])]),bottom:a(()=>[t(Y),t(U,{class:"pt-2"},{default:a(()=>[m("div",je,[t(Te,{modelValue:e(o).pageSize,"onUpdate:modelValue":f[0]||(f[0]=s=>e(o).pageSize=s),items:e(o).options,label:"",style:{"max-inline-size":"6rem","min-inline-size":"4rem","margin-right":"1rem"}},null,8,["modelValue","items"]),t(ve,{modelValue:e(o).currentPage,"onUpdate:modelValue":f[1]||(f[1]=s=>e(o).currentPage=s),"total-visible":c.$vuetify.display.smAndDown?2:3,length:Math.ceil(e(o).total/e(o).pageSize)},null,8,["modelValue","total-visible","length"])])]),_:1})]),_:1},8,["items-per-page","page","items-per-page-options","items-length","headers","items","loading"])]),_:1})]),_:1},512),[[k,e(r)===1]]),_(t(Ee,{form:e(w),ref_key:"infoFeedbackRef",ref:C,onClose:de},null,8,["form"]),[[k,e(r)===2]]),t(he,{ref_key:"addFeedbackRef",ref:V,onRefreshChange:oe},null,512)],64))}};export{_t as default};
